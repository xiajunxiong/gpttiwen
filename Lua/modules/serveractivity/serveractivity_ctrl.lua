FILE_REQ("modules/serveractivity/serveractivity_config")
FILE_REQ("modules/serveractivity/serveractivity_data")
FILE_REQ("modules/serveractivity/serveractivity_call")
FILE_REQ("modules/serveractivity/openserver/seven_day_ctrl")
FILE_REQ("modules/serveractivity/openserver/act_word_gift_ctrl")
FILE_REQ("modules/serveractivity/rand_activity/happy_linkup_data")
FILE_REQ("modules/serveractivity/rand_activity/colorful_illustrate_data")
FILE_REQ("modules/serveractivity/joy_seeks_favors/joy_seeks_favors_ctrl")
FILE_REQ("modules/serveractivity/divination/divination_ctrl")
FILE_REQ("modules/serveractivity/athletics/act_athletics_ctrl")
FILE_REQ("modules/serveractivity/customized_treasure/customized_treasure_ctrl")
FILE_REQ("modules/serveractivity/cow_good_luck/cow_good_luck_ctrl")
FILE_REQ("modules/serveractivity/farewell_ask_neo/farewell_ask_neo_ctrl")
FILE_REQ("modules/serveractivity/lucky_maze/lucky_maze_data")
FILE_REQ("modules/serveractivity/rand_activity/splace_anec_data")
FILE_REQ("modules/serveractivity/summer_first/summer_first_shop_data")
FILE_REQ("modules/serveractivity/summer_first/summer_maze_data")
FILE_REQ("modules/serveractivity/rand_activity/mozuzainali_data")
FILE_REQ("modules/serveractivity/rand_activity/yunzeersanshi_data")
FILE_REQ("modules/serveractivity/paimaihang/paimaihang_config")
FILE_REQ("modules/serveractivity/rand_activity/souls_anecdote_ctrl")
FILE_REQ("modules/serveractivity/plan_activity/plan_activity_ctrl")
-- FILE_REQ("modules/serveractivity/zhaocaijinbao/zhaocaijinbaocopy_ctrl")
FILE_REQ("modules/serveractivity/zhaocaijinbao/zhaocaijinbao_ctrl")
FILE_REQ("modules/serveractivity/duanyangzixuanli/duanyangzixuanli_ctrl")
FILE_REQ("modules/serveractivity/duanyangfuli/duanyangfuli_ctrl")
FILE_REQ("modules/serveractivity/meiliqixi/meiliqixi_ctrl")
FILE_REQ("modules/serveractivity/flower_touch/flower_touch_ctrl")
FILE_REQ("modules/serveractivity/mountain_sea/act_flower_lamp_ctrl")
FILE_REQ("modules/serveractivity/jixinggaozhao/jixinggaozhao_ctrl")
FILE_REQ("modules/serveractivity/rand_activity/competition_rank_ctrl")
FILE_REQ("modules/serveractivity/may_day/vitality_help_others_ctrl")
FILE_REQ("modules/serveractivity/may_day/articulately_ctrl")
FILE_REQ("modules/serveractivity/dragon_boat/act_dragon_boat_ctrl")
FILE_REQ("modules/serveractivity/openserver/act_pet_str_ctrl")
FILE_REQ("modules/serveractivity/rand_activity/tian_yi_yao_shi/tian_yi_yao_shi_ctrl")
FILE_REQ("modules/serveractivity/give_hundred/give_hundred_ctrl")
FILE_REQ("modules/serveractivity/sheng_dan_mi_ling/sheng_dan_mi_ling_ctrl")
FILE_REQ("modules/serveractivity/rabbit_year/rabbit_year_shop/rabbit_year_shop_ctrl")

VIEW_REQ("modules/serveractivity/serveractivity_view")
VIEW_REQ("modules/serveractivity/openserver/act_open_roller_view")
VIEW_REQ("modules/serveractivity/openserver/act_limit_shop_view")
VIEW_REQ("modules/serveractivity/openserver/act_fashion_shop_view")
VIEW_REQ("modules/serveractivity/openserver/act_luck_roller_view")
VIEW_REQ("modules/serveractivity/openserver/act_pet_search_view")
VIEW_REQ("modules/serveractivity/openserver/act_pet_str_view")

VIEW_REQ("modules/serveractivity/rand_activity/colorful_illustrate_view")
VIEW_REQ("modules/serveractivity/rand_activity/happy_linkup_view")
VIEW_REQ("modules/serveractivity/rand_activity/sale_shop_view")
VIEW_REQ("modules/serveractivity/rand_activity/thriving_shop_view")
VIEW_REQ("modules/serveractivity/rand_activity/heritage_treasure_view")
VIEW_REQ("modules/serveractivity/rand_activity/drop_double_view")
VIEW_REQ("modules/serveractivity/rand_activity/tax_discount_view")
VIEW_REQ("modules/serveractivity/rand_activity/heaven_gift_view")
VIEW_REQ("modules/serveractivity/rand_activity/seal_promote_view")
VIEW_REQ("modules/serveractivity/rand_activity/partner_exchange_view")
VIEW_REQ("modules/serveractivity/rand_activity/act_pet_exchange_view")
VIEW_REQ("modules/serveractivity/rand_activity/lucky_discount_view")
VIEW_REQ("modules/serveractivity/rand_activity/illustrate_treasure_view")
VIEW_REQ("modules/serveractivity/rand_activity/element_cards_view")
VIEW_REQ("modules/serveractivity/rand_activity/sign_in_continuity_view")
VIEW_REQ("modules/serveractivity/rand_activity/exclusive_gift_view")
VIEW_REQ("modules/serveractivity/rand_activity/wealth_cornucopia_view")
VIEW_REQ("modules/serveractivity/rand_activity/exp_purchase_view")
VIEW_REQ("modules/serveractivity/rand_activity/gift_box_view")
VIEW_REQ("modules/serveractivity/rand_activity/chain_box_view")
VIEW_REQ("modules/serveractivity/rand_activity/give_secret_key_view")
VIEW_REQ("modules/serveractivity/rand_activity/extra_bonus_view")
VIEW_REQ("modules/serveractivity/rand_activity/linkage_gift_view")
VIEW_REQ("modules/serveractivity/rand_activity/one_yuan_buy_view")
VIEW_REQ("modules/serveractivity/rand_activity/login_reward_view")
VIEW_REQ("modules/serveractivity/rand_activity/lustrate_nian_view")
VIEW_REQ("modules/serveractivity/rand_activity/discount_carnival_view")
VIEW_REQ("modules/serveractivity/rand_activity/adventure_gift_view")
VIEW_REQ("modules/serveractivity/rand_activity/qm_discount_view")
VIEW_REQ("modules/serveractivity/rand_activity/gift_rotation_view")
VIEW_REQ("modules/serveractivity/rand_activity/sp_secret_treasure_view")
VIEW_REQ("modules/serveractivity/rand_activity/splace_anec_shop_view")
VIEW_REQ("modules/serveractivity/rand_activity/splace_anec_quest_view")
VIEW_REQ("modules/serveractivity/rand_activity/deal_discount_view")
VIEW_REQ("modules/serveractivity/rand_activity/pet_befall_view")
VIEW_REQ("modules/serveractivity/rand_activity/acc_recharge_view")
VIEW_REQ("modules/serveractivity/rand_activity/pet_loot_view")
VIEW_REQ("modules/serveractivity/rand_activity/combine_gift_view")
VIEW_REQ("modules/serveractivity/rand_activity/heaven_sent_view")
VIEW_REQ("modules/serveractivity/rand_activity/rand_heart_skill_view")
VIEW_REQ("modules/serveractivity/rand_activity/world_soul_view")
VIEW_REQ("modules/serveractivity/rand_activity/cool_card_view")
VIEW_REQ("modules/serveractivity/rand_activity/cool_breeze_view")
VIEW_REQ("modules/serveractivity/rand_activity/horcrux_tiancheng_view")
VIEW_REQ("modules/serveractivity/rand_activity/chaozhi_gift_view")
VIEW_REQ("modules/serveractivity/rand_activity/mozuzainali_view")
VIEW_REQ("modules/serveractivity/rand_activity/yunzeersanshi_view")
VIEW_REQ("modules/serveractivity/rand_activity/all_souls_full_view")
VIEW_REQ("modules/serveractivity/rand_activity/help_others_view")
VIEW_REQ("modules/serveractivity/rand_activity/cloud_swamp_view")
VIEW_REQ("modules/serveractivity/rand_activity/week_gift_view")

VIEW_REQ("modules/serveractivity/spring_festival/spring_festival_view")
VIEW_REQ("modules/serveractivity/spring_festival/spring_festival_store_view")
VIEW_REQ("modules/serveractivity/spring_festival/cow_origin_view")
VIEW_REQ("modules/serveractivity/spring_festival/little_year_gift_view")
VIEW_REQ("modules/serveractivity/rand_activity/sign_happy_view")

VIEW_REQ("modules/serveractivity/labour_day/spring_climb_view")
VIEW_REQ("modules/serveractivity/labour_day/labour_gift_view")
VIEW_REQ("modules/serveractivity/labour_day/labour_day_view")

VIEW_REQ("modules/serveractivity/summer_first/summer_first_view")
VIEW_REQ("modules/serveractivity/summer_first/flower_lamp_view")
VIEW_REQ("modules/serveractivity/summer_first/banquet_view")
VIEW_REQ("modules/serveractivity/summer_first/lucky_sign_view")
VIEW_REQ("modules/serveractivity/summer_first/summer_experience_view")
VIEW_REQ("modules/serveractivity/summer_first/summer_first_shop_view")
VIEW_REQ("modules/serveractivity/summer_first/summer_discount_shop_view")
VIEW_REQ("modules/serveractivity/summer_first/lotus_treasure_view")
VIEW_REQ("modules/serveractivity/summer_first/summer_maze_view")
VIEW_REQ("modules/serveractivity/summer_first/summer_maze_question_view")
VIEW_REQ("modules/serveractivity/summer_first/summer_maze_shop_view")

VIEW_REQ("modules/serveractivity/cow_going_luck/cow_going_luck_view")
VIEW_REQ("modules/serveractivity/lucky_maze/lucky_maze_view")

VIEW_REQ("modules/serveractivity/national_day/national_day_view")
VIEW_REQ("modules/serveractivity/national_day/national_precious_store_view")
VIEW_REQ("modules/serveractivity/national_day/national_mibao_store_view")

VIEW_REQ("modules/serveractivity/mountain_sea/mountain_sea_total_view")
VIEW_REQ("modules/serveractivity/mountain_sea/mountain_sea_question_view")
VIEW_REQ("modules/serveractivity/mountain_sea/mountain_sea_wind_moon_view")
VIEW_REQ("modules/serveractivity/mountain_sea/mountain_sea_minec_view")
VIEW_REQ("modules/serveractivity/mountain_sea/summer_experience_two_view")
VIEW_REQ("modules/serveractivity/mountain_sea/mountain_sea_task")
VIEW_REQ("modules/serveractivity/mountain_sea/mountain_sea_meet_view")
VIEW_REQ("modules/serveractivity/mountain_sea/mountain_sea_first_meet_view")
VIEW_REQ("modules/serveractivity/mountain_sea/mountain_sea_flower_lamp_view")
VIEW_REQ("modules/serveractivity/mountain_sea/mountain_sea_lotus_view")

VIEW_REQ("modules/serveractivity/paimaihang/paimaihang_view")
VIEW_REQ("modules/serveractivity/paimaihang/paimaihang_buy_view")
VIEW_REQ("modules/serveractivity/paimaihang/paimaihang_host_view")
VIEW_REQ("modules/serveractivity/paimaihang/paimaihang_record_view")

VIEW_REQ("modules/serveractivity/regress_reward/regress_reward_view")
VIEW_REQ("modules/serveractivity/activity_reward_tip/act_reward_tip_view")
VIEW_REQ("modules/serveractivity/activity_reward_tip/act_reward_tip_data")

VIEW_REQ("modules/serveractivity/ymzq/ymzq_view")
VIEW_REQ("modules/serveractivity/rabbit_year/rabbit_year_view")

FILE_REQ("modules/serveractivity/da_zhan_hong_tu/da_zhan_hong_tu_ctrl")

ServerActivityCtrl = ServerActivityCtrl or BaseClass(BaseCtrl)

function ServerActivityCtrl:__init()
    if ServerActivityCtrl.Instance ~= nil then
        Debuger.LogError("[ServerActivityCtrl] attempt to create singleton twice!")
        return
    end 
    ServerActivityCtrl.Instance = self
    self.data = ServerActivityData.New()
    self.colorful_data = ColorfulIllustrateData.New()
    self.splace_anec_data = SplaceAnecdoteData.New()
    self.lucky_maze_data = LuckyMazeData.New()
    self.summer_first_shop_data = SummerFirstShopData.New()
    self.summer_maze_data = SummerMazeData.New()
    self.happy_linkup_data = HappyLinkupData.New()
    self.act_reward_tip_data = ActRewardTipData.New()
    self.mozuzainali_data = MoZuZaiNaLiData.New()
    self.yunzeersanshi_data = YunZeErSanShiData.New()
    self.souls_anecdote_ctrl = SoulsAnecdoteCtrl.New()
    self.plan_ctrl = PlanActivityCtrl.New()
    self.competitionrankl_ctrl = CompetitionRanklCtrl.New()
    self.act_flowerlamp_ctrl = ActFlowerLampCtrl.New()
    self.jixinggaozhao_ctrl = ActJiXingGaoZhaoCtrl.New()
    -- self.duanyangfuli_ctrl = ActDuanYangFuLiCtrl.New()
    self.vitality_help_others_ctrl = VitalityHelpOthersCtrl.New()
    self.articulately_ctrl = ArticulatelyCtrl.New()
    self.act_dragon_boat_ctrl = ActDragonBoatCtrl.New()
    DaZhanHongTuCtrl.New()

    ActPetStrCtrl.New()
    TianYiYaoShiCtrl.New()
    LuckNumCtrl.New()
    ShengDanMiLingCtrl.New()
    RabbitYearShopCtrl.New()
    self:RegisterAllProtocols()
end

function ServerActivityCtrl:RegisterAllProtocols()
    --通用活动请求 随机
    self:RegisterProtocol(CSRandActivityOperaReq)
    self:RegisterProtocol(CSColorfulIllustrateSeq)
    self:RegisterProtocol(CSRandActivityMakeUpReq)
    self:RegisterProtocol(CSBuyCmdGift)
    --商店限时购买
    self:RegisterProtocol(SCRandActivityTimeLimitStoreInfo,"OnRandActivityTimeLimitStoreInfo")
    --开服转盘活动
    self:RegisterProtocol(SCRandActivityTurnTableInfo,"OnRandActivityTurnTableInfo")
    --开服转盘奖励
    self:RegisterProtocol(SCRandActivityTurnTableReward,"OnRandActivityTurnTableReward")
    --开服商店限时
    self:RegisterProtocol(SCRandDiscountStoreInfo,"OnRandDiscountStoreInfo")
    -- 28天累计登陆
    self:RegisterProtocol(CSLoginSystemReq)
    self:RegisterProtocol(SCLoginSystemInfo,"OnSCLoginSystemInfo")
    --七彩图鉴
    self:RegisterProtocol(SCColorfulIllustrateInfo,"OnColorfulIllustrateInfo")
    --驱除妖兽
    self:RegisterProtocol(SCRAExpelMonsterInfo,"OnRAExpelMonsterInfo")
    --欣欣向荣
    self:RegisterProtocol(SCRAHappyUpInfo,"OnRAHappyUpInfo")
    --特卖商店
    self:RegisterProtocol(SCRASaleShopInfo,"OnRASaleShopInfo")
    --福袋
    self:RegisterProtocol(SCFortuneBagInfo,"OnFortuneBagInfo")
    --传承瑰宝
    self:RegisterProtocol(SCRAHeritageTreasureInfo,"OnHeritageTreasureInfo")
    --天降好礼
    self:RegisterProtocol(SCRAHeavenGiftInfo,"OnHeavenGiftInfo")
    --伙伴兑换
    self:RegisterProtocol(SCRAActivityPartnerExchange,"OnActivityPartnerExchange")
    --宠物兑换
    self:RegisterProtocol(SCRAActivityPetExchange,"OnActivityPetExchange")
    --宠物兑换单条信息
    self:RegisterProtocol(SCRAActivityPetExchangeInfo,"OnSCRAActivityPetExchangeInfo")
    --折扣狂欢
    self:RegisterProtocol(SCRADiscountCarnivalInfo,"OnRADiscountCarnivalInfo")
    --幸运转盘活动
    self:RegisterProtocol(SCRALuckyTurntableInfo,"OnLuckyTurntableInfo")
    --幸运转盘奖励
    self:RegisterProtocol(SCRALuckyTurntableReward,"OnLuckyTurntableReward")
    --幸运转盘奖励
    self:RegisterProtocol(SCRALuckyDiscountInfo,"OnLuckyDiscountInfo")
    --幸运转盘奖励
    self:RegisterProtocol(SCRAIllustrateTreasureInfo,"OnIllustrateTreasureInfo")
    --元素翻牌
    self:RegisterProtocol(SCRAElementCardsInfo,"OnSCRAElementCardsInfo")
    --连登好礼
    self:RegisterProtocol(SCRASignInContinuityInfo,"OnSCRASignInContinuityInfo")
    --专属礼包
    self:RegisterProtocol(SCRAZhuanShuLiBaoInfo,"OnSCRAZhuanShuLiBaoInfo")
    self:RegisterProtocol(SCRAZhuanShuLiBaoDayInfo,"OnSCRAZhuanShuLiBaoDayInfo")
    --财神聚宝
    self:RegisterProtocol(SCRAWealthCornucopiaInfo,"OnSCRAWealthCornucopiaInfo")
    --限时宝盒
    self:RegisterProtocol(SCRAXianShiBaoHeInfo, "OnSCRAXianShiBaoHeInfo")
    --限时宝袋
    self:RegisterProtocol(SCRAXianShiBaoDaiInfo, "OnSCRAXianShiBaoDaiInfo")
    --经验飙升
    self:RegisterProtocol(SCRAJingYanBiaoShengInfo,"OnSCRAJingYanBiaoShengInfo")
    --赠30连抽
    self:RegisterProtocol(SCRAGivePetDrawInfo, "OnSCRAGivePetDrawInfo")
    --额外奖励
    self:RegisterProtocol(CSRandActivityBonusOperaReq)
    self:RegisterProtocol(SCRandActivityBonusInfo,"OnRandActivityBonusInfo")
    --联动送礼
    self:RegisterProtocol(SCRALinkageGiftInfo,"OnRALinkageGiftInfo")
    --奇遇礼包
    self:RegisterProtocol(SCRaAdventureGiftInfo,"OnRaAdventureGiftInfo")
    --全民团购
    self:RegisterProtocol(SCRAGroupDiscountInfo,"OnRAGroupDiscountInfo")
    --年货节
    self:RegisterProtocol(SCRASpringFestivalStoreInfo,"OnSCRASpringFestivalStoreInfo")
    --牛运兑换
    self:RegisterProtocol(SCRANCowConvertInfo,"OnSCRANCowConvertInfo")
    --牛运当头
    self:RegisterProtocol(SCRAMonpolyGiftInfo,"OnSCRAMonpolyGiftInfo")
    --牛运当头答题信息
    self:RegisterProtocol(SCRAMonpolyGiftQuestionInfo,"OnSCRAMonpolyGiftQuestionInfo")
    --小年送礼
    self:RegisterProtocol(SCRALittleYearGiftInfo,"OnRALittleYearGiftInfo")
    --牛行大运
    self:RegisterProtocol(SCRandActivityNXDYInof,"OnRandActivityNXDYInof")
    --活动积分获得通知
    self:RegisterProtocol(SCRAMoneyAddInfo,"OnSCRAMoneyAddInfo")
    --赠寻宝钥匙活动
    self:RegisterProtocol(SCRAGiveSecretKeyInfo,"OnSCRAGiveSecretKeyInfo")
    --累计充值
    self:RegisterProtocol(SCRACumulativeChargeInfo, "OnSCRACumulativeChargeInfo")
    -- 宠物夺宝
    self:RegisterProtocol(SCRAPetLootInfo, "OnSCRAPetLootInfo")
    self:RegisterProtocol(SCRATradeMarketReturnGoldInfo, "OnTradeMarketReturnGoldInfo")
    self:RegisterProtocol(SCRATradeMarketReturnHotItemInfo, "OnTradeMarketReturnHotItemInfo")
    -- 神兽降临
    self:RegisterProtocol(SCRAPetBefallInfo,"OnSCRAPetBefallInfo")
    self:RegisterProtocol(SCRAPetBefallResult,"OnSCRAPetBefallResult")
    -- 幸运迷宫
    self:RegisterProtocol(SCRALuckyMazeInfo,"OnSCRALuckyMazeInfo")
    --幸运迷宫拼图信息
    self:RegisterProtocol(SCRALuckyMazePuzzleInfo,"OnSCRALuckyMazePuzzleInfo")
    --幸运迷宫宝箱信息
    self:RegisterProtocol(SCRALuckyMazeBoxInfo,"OnSCRALuckyMazeBoxInfo")
    --好礼转动下发
    self:RegisterProtocol(SCRAGoodGiftTurnInfo,"OnSCRAGoodGiftTurnInfo")
    --好礼转动抽取到的礼盒下发
    self:RegisterProtocol(SCRAGoodGiftTurnRewardInfo,"OnSCRAGoodGiftTurnRewardInfo")
    self:RegisterProtocol(CSHearsayInfo,"OnCSHearsayInfo")
    --春日登峰
    self:RegisterProtocol(SCRAChunRiDengFengInfo,"OnSCRAChunRiDengFengInfo")    
    --天降好礼
    self:RegisterProtocol(SCRALaoDongHaoLiInfo,"OnSCRALaoDongHaoLiInfo")
    --特惠秘宝
    self:RegisterProtocol(SCRASecretTreasureInfo,"OnSCRASecretTreasureInfo")
    --组合贺礼
    self:RegisterProtocol(SCRAZuHeHeLiInfo, "OnSCRAZuHeHeLiInfo")
    --秘境奇闻
    self:RegisterProtocol(CSRAMiJingQiWenQuestionReq)
    self:RegisterProtocol(CSRAMiJingQiWenBuyItemReq)
    self:RegisterProtocol(CSCloseWindosReq)
    self:RegisterProtocol(SCRAMiJingQiWenQuestionInfo, "OnSCRAMiJingQiWenQuestionInfo")
    self:RegisterProtocol(SCRAMiJingQiWenShopInfo, "OnSCRAMiJingQiWenShopInfo")
    self:RegisterProtocol(SCRAMiJingQiWenShopBuyTimesInfo, "OnSCRAMiJingQiWenShopBuyTimesInfo")
    self:RegisterProtocol(SCCloseWindosRet, "OnSCCloseWindosRet")
    self:RegisterProtocol(SCCmdBuyItemCheckRet, "OnSCCmdBuyItemCheckRet")
    self:RegisterProtocol(CSCmdBuyItemCheckReq)
    --令牌天赐
    self:RegisterProtocol(SCRAHeavenSentInfo, "OnRAHeavenSentInfo")
    --心法无量
    self:RegisterProtocol(SCRAHeartSkillInfo, "OnRAHeartSkillInfo")
    --赋世魂器
    self:RegisterProtocol(SCRAWorldSoulInfo, "OnRAWorldSoulInfo")
    --回归豪礼
    self:RegisterProtocol(SCBackRewardInfo, "OnSCBackRewardInfo")   
    self:RegisterProtocol(CSBackRewardReq)
    --连连乐翻天
    self:RegisterProtocol(SCRAHappyLookInfo, "OnHappyLookInfo") 
    --时装商店
    self:RegisterProtocol(SCRAFashionShopInfo, "OnRAFashionShopInfo")
    --一元购
    self:RegisterProtocol(SCRAOneYuanGouInfo, "SCRAOneYuanGouInfo")
    --神兽降临直购信息
    self:RegisterProtocol(SCPetBefallBuyInfo, "OnSCPetBefallBuyInfo")
    --初夏试炼
    self:RegisterProtocol(SCRASummerLiLianAllInfo, "OnSCRASummerLiLianAllInfo")
    --多彩花灯
    self:RegisterProtocol(SCRAFlowerLampBaseInfo, "OnSCRAFlowerLampBaseInfo")
    self:RegisterProtocol(SCRAFlowerLampGameInfo, "OnSCRAFlowerLampGameInfo")
    self:RegisterProtocol(SCRAFlowerLampItemInfo, "OnSCRAFlowerLampItemInfo")
    --琼楼玉宴
    self:RegisterProtocol(SCBanquetInfo,"OnSCBanquetInfo")
    self:RegisterProtocol(SCBanquetRewardInfo,"OnSCBanquetRewardInfo")
    --夏日商城
    self:RegisterProtocol(SCRASummerStoreInfo, "OnSCRASummerStoreInfo")
    --夏日商城单个信息下发
    self:RegisterProtocol(SCRASummerStoreSingleInfo, "OnSCRASummerStoreSingleInfo")
    --好运花签信息下发
    self:RegisterProtocol(SCRALuckySignInfo, "OnRALuckySignInfo")
    --超级折扣商城
    self:RegisterProtocol(SCRASuperOffShopInfo, "OnSCRASuperOffShopInfo")
    --超级折扣商城单个信息下发
    self:RegisterProtocol(SCRASuperOffShopSingleInfo, "OnSCRASuperOffShopSingleInfo")
    --荷香觅宝
    self:RegisterProtocol(SCRALotusInfo, "OnSCRALotusInfo")
    --元气翻牌
    self:RegisterProtocol(SCRAYuanQiTurningInfo, "OnRAYuanQiTurningInfo")
    --凉风送爽
    self:RegisterProtocol(SCRACoolBreezeInfo, "OnRACoolBreezeInfo")
    self:RegisterProtocol(SCRACoolBreezeSingleInfo, "OnRACoolBreezeSingleInfo")
    -- 夏日迷宫
    self:RegisterProtocol(SCMazeSummerMapInfo, "OnSCMazeSummerMapInfo")
    self:RegisterProtocol(SCMazeSummerSingleMapInfo, "OnSCMazeSummerSingleMapInfo")
    self:RegisterProtocol(SCMazeSummerShopInfo, "OnSCMazeSummerShopInfo")
    self:RegisterProtocol(SCMazeSummerQuestionInfo, "OnSCMazeSummerQuestionInfo")
    self:RegisterProtocol(SCMazeSummerTaskInfo, "OnSCMazeSummerTaskInfo")
    self:RegisterProtocol(SCMazeSummerStatusInfo, "OnSCMazeSummerStatusInfo")
    self:RegisterProtocol(SCMazeSummerPlayFinishInfo, "OnSCMazeSummerPlayFinishInfo")
    self:RegisterProtocol(SCMazeSummerMyPosInfo, "OnSCMazeSummerMyPosInfo")
    --觅宝坊店
    self:RegisterProtocol(SCRAMiBaoFangDianInfo, "OnSCRAMiBaoFangDianInfo")
    self:RegisterProtocol(SCRAMiBaoFangDianSingleInfo, "OnSCRAMiBaoFangDianSingleInfo")
    ---珍品
    self:RegisterProtocol(SCRAZhenPinShangPuInfo,"OnSCRAZhenPinShangPuInfo")
    self:RegisterProtocol(SCRAZhenPinShangPuOpenDay,"OnSCRAZhenPinShangPuOpenDay")
    --拍卖行
    self:RegisterProtocol(SCRAPaiMaiHangNoticeInfo, "OnSCRAPaiMaiHangNoticeInfo")
    self:RegisterProtocol(SCRAPaiMaiHangSingleNoticeInfo, "OnSCRAPaiMaiHangSingleNoticeInfo")
    self:RegisterProtocol(SCRAPaiMaiHangUserInfo, "OnSCRAPaiMaiHangUserInfo")
    self:RegisterProtocol(SCRAPaiMaiHangUserSingleInfo, "OnSCRAPaiMaiHangUserSingleInfo")
    self:RegisterProtocol(SCRAPaiMaiHangUserRecordInfo, "OnSCRAPaiMaiHangUserRecordInfo")
    --登陆连好礼
    self:RegisterProtocol(SCRASignHappyInfo, "OnSCRASignHappyInfo")
    --万灵共盈
    self:RegisterProtocol(SCRAWanLingGongYingInfo, "OnSCRAWanLingGongYingInfo")
    --活动结果下发
    self:RegisterProtocol(SCRAResultNotice, "OnSCRAResultNotice")
    -- 山海问答
    self:RegisterProtocol(SCRAShanHaiQuestionInfo, "OnSCRAShanHaiQuestionInfo")
    self:RegisterProtocol(SCRAShanHaiQuestionStateInfo, "OnSCRAShanHaiQuestionStateInfo")
    -- 山海风月
    self:RegisterProtocol(SCRAShanHaiWindMoonRewardInfo, "OnSCRAShanHaiWindMoonRewardInfo")
    self:RegisterProtocol(SCRAShanHaiWindMoonStateInfo, "OnSCRAShanHaiWindMoonStateInfo")
    self:RegisterProtocol(SCRAShanHaiWindMoonLotteryInfo, "OnSCRAShanHaiWindMoonLotteryInfo")
    -- 山海聚宝
    self:RegisterProtocol(SCRAShanHaiJuBaoInfo, "OnSCRAShanHaiJuBaoInfo")
    self:RegisterProtocol(SCRAShanHaiJuBaoDrawRet, "OnSCRAShanHaiJuBaoDrawRet")
    -- 魂器天成
    self:RegisterProtocol(SCRAHorcruxTianChengRoleInfo, "OnRAHorcruxTianChengRoleInfo")
    self:RegisterProtocol(SCRAHorcruxTianChengPoolInfo, "OnRAHorcruxTianChengPoolInfo")
    self:RegisterProtocol(SCRAHorcruxTianChengDrawResult, "OnRAHorcruxTianChengDrawResult")
    -- 山海相逢
    self:RegisterProtocol(SCRAShanHaiMeetInfo, "OnSCRAShanHaiMeetInfo")
    -- 山海初遇
    self:RegisterProtocol(SCRAShanHaiMetBase, "OnSCRAShanHaiMetBase")
    self:RegisterProtocol(SCRAShanHaiMetTakeParam, "OnSCRAShanHaiMetTakeParam")
    self:RegisterProtocol(SCRAShanHaiMetTaskParamChange, "OnSCRAShanHaiMetTaskParamChange")
    -- 魔族在哪里
    self:RegisterProtocol(SCRAMoZuZaiNaLiInfo, "OnRAMoZuZaiNaLiInfo")
    -- 云泽二三事
    self:RegisterProtocol(SCRAYunZeErSanShiInfo, "OnRAYunZeErSanShiInfo")
    self:RegisterProtocol(SCRAYunZeErSanShiTurntableInfo, "OnRAYunZeErSanShiTurntableInfo")
    --再战云泽
    self:RegisterProtocol(SCRACloudSwampResult, "OnRACloudSwampResult")
    --初夏试炼
    self:RegisterProtocol(SCRAShanHaiZhengFengAllInfo, "OnSCRAShanHaiZhengFengAllInfo")
    --周末限好礼
    self:RegisterProtocol(SCWeedendGiftInfo, "OnWeedendGiftInfo")
    --超值献礼
    self:RegisterProtocol(SCRAChaoZhiGiftInfo, "OnRAChaoZhiGiftInfo")
    -- 月满中秋
    ActivityRandData.Instance:Register(Mod.MidAutumnFestival.Main, function()
        return self.data:GetYmzqShow()
    end)
end

function ServerActivityCtrl:OnInit()
    ActivityData.Instance:CareEvent(BindTool.Bind(self.OnActEvent, self))

    BagData.Instance:Care(BindTool.Bind(self.OnChangeItemNotice, self))

    EventSys:Bind(GlobalEventKeys.RoleNoticeComplete,BindTool.Bind(self.OnRoleCompleteNotice, self))
    
    EventSys:Bind(GlobalEventKeys.RoleLevelChange,BindTool.Bind(self.data.CheckOpenServerData, self.data))

    TimeCtrl.Instance.server_data:KeysCare({"server_open_day"}, BindTool.Bind(self.OnChangeDayNotice, self))

    --注册自定义监听方式
    ActivityRandData.Instance:Register(Mod.ServerActivity.Main,function()
        return ServerActivityData.Instance:CheckGroupOpen()
    end)
    ActivityRandData.Instance:Register(Mod.Splendid.Main,function()
        return ActivityRandData.Instance:CheckGroupOpen()
    end)
    ActivityRandData.Instance:Register(Mod.PlanActivity.Main,function()
        return PlanActivityData.Instance:CheckPlanGroupOpen()
    end)
    ActivityRandData.Instance:Register(Mod.MountainSea.Main,function()
        return PlanActivityData.Instance:CheckMountainSeaGroupOpen()
    end)
    ActivityRandData.Instance:Register(Mod.RandActivity.LoginReward,function()
        return (not self.data:GetLoginRewardDaysEnd())
    end,self.data.login_reward_data)
    ActivityRandData.Instance:Register(Mod.RandActivity.ActPetSearchView,function()
        return self.data:GetActPetSearchEnd()
    end)
    ActivityRandData.Instance:Register(Mod.RandActivity.IllustrateTreasure,function()
        return self.data:GetIllustrateTreasureEnd()
    end,self.data.llustrate_treasure_data)
    ActivityRandData.Instance:Register(Mod.RandActivity.LinkageGift,function()  
        return self.data:GetLinkageGiftEnd()
    end,self.data.linkage_gift_data)
    ActivityRandData.Instance:Register(Mod.RandActivity.AdventureGift,function()
        return self.data:GetAdventureGiftEnd()
    end,self.data.adventure_gift_data)
    ActivityRandData.Instance:Register(Mod.SpringFestival.Main,function()
        return self.data:GetSpringFestivalEnd()
    end)
    ActivityRandData.Instance:Register(Mod.RandActivity.GiveSecretKey,function()
        return self.data:GetGiveSeretKeyIsOpen()
    end,self.data.give_secret_key_data)
    -- 累计充值领取后关闭图标
    ActivityRandData.Instance:Register(Mod.RandActivity.AccRecharge, function()
        return self.data:GetAccRechargeIsOpen()
    end, self.data.acc_recharge_data)
    ActivityRandData.Instance:Register(Mod.LabourDay.Main,function()
        return self.data:GetLabourDayEnd()
    end)
    --元气庆典
    ActivityRandData.Instance:Register(Mod.MayDay.Main,function()
        return MayDayData.Instance:GetMayDayEnd()
    end)
    -- 一元购充值后关闭图标
    ActivityRandData.Instance:Register(Mod.RandActivity.OneYuanBuy, function()
        return self.data:GetOneYuanBuyIsOpen()
    end, self.data.one_yuan_buy_data)
    ActivityRandData.Instance:Register(Mod.RandActivity.HeavenSent,function()
        local is_open = self.data:GetHeavenSentEnd()
        if not is_open then
            ViewMgr:CloseView(HeavenSentView)
        end
        return is_open
    end,self.data.heaven_sent_data)
    ActivityRandData.Instance:Register(Mod.RandActivity.HeartSkill,function()
        local is_open = self.data:GetHeartSkillEnd()
        if not is_open then
            ViewMgr:CloseView(RandHeartSkillView)
        end
        return is_open
    end,self.data.heart_skill_data)
    ActivityRandData.Instance:Register(Mod.RandActivity.WorldSoul,function()
        local is_open = self.data:GetWorldSoulEnd()
        if not is_open then
            ViewMgr:CloseView(WorldSoulView)
        end
        return is_open
    end,self.data.world_soul_data)

    ActivityRandData.Instance:Register(Mod.GodLandTraces.Main,function()
        return FunOpen.Instance:GetFunIsOpened(Mod.GodLandTraces.Main) and 1 == GodLandTracesData.Instance.info_sm_open.is_open
    end, GodLandTracesData.Instance.info_sm_open)
    ActivityRandData.Instance:Register(Mod.SummerFirst.Main,function()
        return self.data:GetSummerFirstEnd()
    end)
    -- 国庆活动
    ActivityRandData.Instance:Register(Mod.NationalDay.Main,function()
        return self.data:GetNationalDayEnd()
    end)
    -- 回归豪礼
    ActivityRandData.Instance:Register(Mod.RandActivity.RegressReward,function()
        local is_open = self.data:GetRegressRewardEnd()
        if not is_open then
            ViewMgr:CloseView(RegressRewardView)
        end
        return is_open
    end,self.data.regress_reward_data)
    -- 超值献礼
    ActivityRandData.Instance:Register(Mod.RandActivity.ChaoZhiGift,function()
        local is_open = self.data:GetChaoZhiGiftEnd()
        -- if not is_open then
        --  ViewMgr:CloseView(ChaoZhiGiftView)
        -- end
        return is_open
    end, self.data.chaozhi_gift_info)
    -- 月满中秋
    ActivityRandData.Instance:Register(Mod.MidAutumnFestival.Main, function()
        return self.data:GetYmzqShow()
    end)
    -- 万圣活动
    ActivityRandData.Instance:Register(Mod.Act_Halloween.Main, function()
        return self.data:GetHalloweenShow()
    end)

    FinishData.Instance:SetCloseFunc(BATTLE_MODE.BATTLE_MODE_COW_ORIGIN, function(is_win)
        if ActivityData.IsOpen(ACTIVITY_TYPE.RAND_COW_ORIGIN) then
            ViewMgr:OpenView(CowOriginView)
        end
    end)
    ActivityRandData.Instance:CustomClickHandle(ACTIVITY_TYPE.RAND_LITTLE_YEAR_GIFT,function()
        if ServerActivityData.Instance:IsLittleYearGiftReward() then
            PublicPopupCtrl.Instance:Center(Language.LittleYearGift.Tip)
            return
        end
        ViewMgr:OpenViewByKey(Mod.SpringFestival.LittleYearGift)
    end)
    ActivityRandData.Instance:CustomClickHandle(ACTIVITY_TYPE.RAND_SUMMER_EXPERIENCE,function()
        if ActivityData.IsOpen(ACTIVITY_TYPE.RAND_SUMMER_EXPERIENCE) then
            ViewMgr:OpenViewByKey(Mod.SummerFirst.SummerExperience)
        end
    end)
    ActivityRandData.Instance:CustomClickHandle(ACTIVITY_TYPE.RAND_SUMMER_EXPERIENCE_TWO,function()
        if ActivityData.IsOpen(ACTIVITY_TYPE.RAND_SUMMER_EXPERIENCE_TWO) then
            ViewMgr:OpenViewByKey(Mod.MountainSea.SummerExperienceTwo)
        end
    end)
    ActivityRandData.Instance:CustomClickHandle(ACTIVITY_TYPE.RAND_MS_FLOWER_LAMP,function()
        if ActivityData.IsOpen(ACTIVITY_TYPE.RAND_MS_FLOWER_LAMP) then
            ViewMgr:OpenViewByKey(Mod.MountainSea.FlowerLampMS)
        end
    end)
    ActivityRandData.Instance:CustomClickHandle(ACTIVITY_TYPE.RAND_LOTUS_MS,function()
        if ActivityData.IsOpen(ACTIVITY_TYPE.RAND_LOTUS_MS) then
            ViewMgr:OpenViewByKey(Mod.MountainSea.LotusTwo)
        end
    end)
    FinishData.Instance:SetCloseFunc(BATTLE_MODE.BATTLE_MODE_CLOUD_SWAMP,function(is_win)
        if is_win == 1 then
            ViewMgr:OpenView(GiftOpenView,{
                gift_type = GIFT_OPEN_TYPE.CONGRATULATIONS,
                item_list = DataHelper.FormatItemList(self.data:GetCloudSwampFinishData()),
                close_func = function()
                    ViewMgr:OpenViewByKey(Mod.RandActivity.CloudSwamp)
                end,
            })
        else
            ViewMgr:OpenViewByKey(Mod.RandActivity.CloudSwamp)
        end
    end)
    --暑期注册或解析自己基本的图标和图标名字
    ActivityRandData.Instance:CustomBaseItemData(Mod.SummerFirst.Main,function(data)
        return {sprite = data.sprite .. self.data:GetSummerFirstStage()}
    end)
    --神秘试炼注册或解析自己基本的图标和图标名字
    ActivityRandData.Instance:CustomBaseItemData(Mod.RandActivity.SevenDay,function(data)
        local text_list = Split(data.text,"|")
        local sprite_list = Split(data.sprite,"|")
        local type = SevenDayData.Instance:GetDayType() + 1
        return {sprite = sprite_list[type],text = text_list[type]}
    end)    
    ActivityRandData.Instance:Register(Mod.RandActivity.CompetitionRank,function()
        return ActivityData.IsOpen(ACTIVITY_TYPE.KF_COMPETITION_RANK) and FunOpen.Instance:IsFunOpen(Mod.ServerActivity.CompetitionRank)
    end)
    self:OnRemind()
end

function ServerActivityCtrl:OnRemind()
    Remind.Instance:Register(Mod.RandActivity.LoginReward, self.data.login_reward_data, function()
        return self.data:GetLoginRewardNum()
    end)
    Remind.Instance:Register(Mod.Splendid.HeritageTreasure, self.data.heritage_treasure_data, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_HERITAGE_TREASURE) then
            return 0
        end
        return self.data:GetHeritageTreasureNum()
    end)
    Remind.Instance:Register(Mod.ServerActivity.LuckRoller, self.data.luck_roller_data, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.KF_LUCK_ROLLER) then
            return 0
        end
        return self.data:GetLuckRollerRedNum()
    end)
    Remind.Instance:Register(Mod.Splendid.PartnerExchange,self.data.partnet_exchang_save,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_PARTNER_EXCHANGE) then
            return 0
        end
        return self.data:GetPartnerExchangeRemind()
    end)
    Remind.Instance:Register(Mod.RandActivity.IllustrateTreasure,self.data.llustrate_treasure_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_ILLUSTRATE_TREASURE) then
            return 0
        end
        return self.data:GetIllustrateTreasureRemind()
    end)
    Remind.Instance:Register(Mod.ServerActivity.LimitShop,self.data.limit_shop_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.KF_LIMIT_SHOP) then
            return 0
        end
        return self.data:GetLimitShopRemindNum()
    end)
    --连登好礼
    Remind.Instance:Register(Mod.Splendid.SignInContinuity,self.data.sign_in_continuity_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_SIGN_IN_CONTINUITY) then
            return 0
        end
        return self.data:GetSignInContinuityRemindNum()
    end)
    --特卖商店
    Remind.Instance:Register(Mod.YunZe.SaleShop,self.data.sale_shop_count,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_SALE_SHOP) then
            return 0
        end
        return self.data:GetSaleShopRemindNum()
    end)
    --全民团购
    Remind.Instance:Register(Mod.Splendid.QmDiscount,self.data.qm_discount_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_QM_DISCOUNT) then
            return 0
        end
        return self.data:GetGroupDiscountNum()
    end)
    --折扣狂欢
    Remind.Instance:Register(Mod.Splendid.DiscountCarnival,self.data.discount_carnival_info,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_DISCOUNT_CARNIVAL) then
            return 0
        end
        return self.data:GetDCRemindNum()
    end)
    --幸运折扣
    Remind.Instance:Register(Mod.Splendid.LuckyDiscount,self.data.lucky_discount_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_LUCKY_DISCOUNT) then
            return 0
        end
        return self.data:GetLuckyDiscountRemaidNum()
    end)
    --元素翻牌
    Remind.Instance:Register(Mod.Splendid.ElementCards,self.data.element_cards_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_ELEMENT_CARDS) then
            return 0
        end
        return self.data:GetElementCardsNum()
    end)
    --七彩图鉴
    Remind.Instance:Register(Mod.Splendid.ColorfulIllustrate,ColorfulIllustrateData.Instance.red_piont_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_COLORFUL_ILLUSTRATE) then
            return 0
        end
        return ColorfulIllustrateData.Instance:GetRemindNum()
    end)
    Remind.Instance:Register(Mod.Splendid.HeavenGift,self.data.heaven_gift_data,function() 
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_HEAVEN_GIFT) then
            return 0
        end
        return self.data:GetHeavenGiftNum()
    end)
    local word_check_func = function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.KF_WORD_GIFT) then
            return 0
        end
        return ActWordGiftData.Instance:GetWordGiftRemind()
    end
    Remind.Instance:Register(Mod.RandActivity.ActPetSearchView, self.data.give_pet_draw_data, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_GIVE_PET_DRAW) then
            return 0
        end
        return self.data:GetActPetSearchNum()
    end)
    Remind.Instance:Register(Mod.RandActivity.LinkageGift,self.data.linkage_gift_data,function() 
        return self.data:GetLinkageGiftNum()
    end,"fetch_flag")
    Remind.Instance:Register(Mod.ServerActivity.WordGift, BagData.Instance.item_grid, word_check_func)
    Remind.Instance:Register(Mod.ServerActivity.WordGift, ActWordGiftData.Instance.word_redinfo, word_check_func)
    local exp_purchase_func = function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_EXP_PURCHASE) then
            return 0
        end
        return self.data:GetExpPurchaseRemind()
    end
    Remind.Instance:Register(Mod.Splendid.ExpPurchase, BagData.Instance.item_grid, exp_purchase_func)
    Remind.Instance:Register(Mod.Splendid.ExpPurchase, RoleData.Instance.base_data, exp_purchase_func, "level")
    Remind.Instance:Register(Mod.Splendid.ExpPurchase, self.data.exp_purchase_data, exp_purchase_func)
    Remind.Instance:Register(Mod.Splendid.WealthCornucopia, self.data.bonus_data, function()
        return self.data:GetBonusRedNum(ACTIVITY_TYPE.RAND_WEALTH_CORNUCOPIA)
    end)
    Remind.Instance:Register(Mod.Splendid.CustomizedTreasure, self.data.bonus_data, function()
        if ActivityData.IsOpen(ACTIVITY_TYPE.RAND_CUSTOMIZED_TREASURE) then
            return self.data:GetBonusRedNum(ACTIVITY_TYPE.RAND_CUSTOMIZED_TREASURE) + CustomizedTreasureData.Instance:GetRemindNum()
        end
        return 0
    end)
    Remind.Instance:Register(Mod.Splendid.GiftBox, self.data.bonus_data, function()
        if ActivityData.IsOpen(ACTIVITY_TYPE.RAND_GIFT_BOX) then
            return self.data:GetBonusRedNum(ACTIVITY_TYPE.RAND_GIFT_BOX) + self.data:GetGiftBoxRemindNum()
        end
        return 0
    end)
    Remind.Instance:Register(Mod.Splendid.ChainBox, self.data.bonus_data, function()
        if ActivityData.IsOpen(ACTIVITY_TYPE.RAND_CHAIN_BOX) then
            return self.data:GetBonusRedNum(ACTIVITY_TYPE.RAND_CHAIN_BOX) + self.data:GetChainBoxRemindNum()
        end
        return 0
    end)
    Remind.Instance:Register(Mod.RandActivity.SwordZither, self.data.bonus_data, function()
        return self.data:GetBonusRedNum(ACTIVITY_TYPE.RAND_SWORD_ZITHER,0) + self.data:GetBonusRedNum(ACTIVITY_TYPE.RAND_SWORD_ZITHER,1)
    end)
    
    Remind.Instance:Register(Mod.SpringFestival.CowGoodLuck,CowGoodLuckData.Instance.intimacy,function() 
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_COW_LUCKY_EXCHANGE) then
            return 0
        end
        return CowGoodLuckData.Instance:GetIntimacyRemind()
    end)
    -- 牛运当头红点
    Remind.Instance:Register(Mod.SpringFestival.CowOrigin,BagData.Instance.item_grid,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_COW_ORIGIN) then
            return 0
        end
        return self.data:CowOriginRemindNum()
    end)
    --牛行大运
    Remind.Instance:Register(Mod.SpringFestival.CowGoingLuck,self.data.cow_going_lock_data,function() 
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_COW_GOING_LUCK) then
            return 0
        end
        return self.data:GetCowGoingLuckRemind()
    end)
    --辞旧迎新
    Remind.Instance:Register(Mod.SpringFestival.FarewellAskNeo,FarewellAskNeoCtrl.Instance.farewell_info,function() 
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_FAREWELL_ASK_NEO) then
            return 0
        end
        return FarewellAskNeoCtrl.Instance:GetFarewellRemind()
    end)
    Remind.Instance:Register(Mod.SpringFestival.LittleYearGift,self.data.little_year_gift_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_LITTLE_YEAR_GIFT) then
            return 0
        end
        return self.data:GetLittleYearGiftNum()
    end)
    -- 赠寻宝钥匙
    local give_secret_key_remind_func = function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_GIVE_SECRET_KEY) then
            return 0
        end
        return self.data:GetGiveSeretKeyRemindNum()
    end
    Remind.Instance:Register(Mod.RandActivity.GiveSecretKey,self.data.give_secret_key_data,give_secret_key_remind_func)
    Remind.Instance:Register(Mod.RandActivity.GiveSecretKey,RoleData.Instance.base_data,give_secret_key_remind_func,"level")
    -- 累计充值红点
    Remind.Instance:Register(Mod.RandActivity.AccRecharge, self.data.acc_recharge_data, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_ACC_RECHARGE) then
            return 0
        end
        return self.data:GetAccRechargeRemind()
    end)
    -- 宠物夺宝红点
    Remind.Instance:Register(Mod.Splendid.PetLoot, self.data.pet_loot_data, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_PET_LOOT) then
            return 0
        end
        return self.data:GetPetLootRemind()
    end)
    Remind.Instance:Register(Mod.Splendid.DealDiscount, self.data.deal_discount_data, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_DEAL_DISCOUNT) then
            return 0
        end
        return self.data:GetDealDiscountNum()
    end)
    -- 神兽降临红点
    Remind.Instance:Register(Mod.Splendid.PetBefall,BagData.Instance.item_grid, function () 
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_PET_BEFALL) then
            return 0
        end
        return self.data:GetPetBefallRemind() 
    end)
    Remind.Instance:Register(Mod.Splendid.PetBefall,self.data.pet_befall_remind_data, function () 
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_PET_BEFALL) then
            return 0
        end
        return self.data:GetPetBefallRemind() 
    end)
    --好礼转动
    Remind.Instance:Register(Mod.Splendid.GiftRotation, self.data.gift_rotation_data, function()
        return self.data:GiftRotationRemind()
    end)
    -- 劳动好礼
    Remind.Instance:Register(Mod.LabourDay.LabourGift, self.data.labour_gift_data, function() 
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_LABOUR_GIFT) then
            return 0
        end
        return self.data:GetLabourGiftNum()
    end)
    -- 幸运迷宫
    Remind.Instance:Register(Mod.Splendid.LuckyMaze,LuckyMazeData.Instance.act_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_LUCKY_MAZE) then
            return 0
        end
        return LuckyMazeData.Instance:GetRemindNum()
    end)
    Remind.Instance:Register(Mod.LabourDay.CombineGift, self.data.combine_gift_data, function ()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_COMBINE_GIFT) then
            return 0
        end
        return self.data:GetCombineGiftRemind()
    end)
    -- 春日登峰
    local spring_climb_func = function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_SPRING_CLIMB) then
            return 0
        end
        return self.data:GetSpringClimbRemind()
    end
    Remind.Instance:Register(Mod.LabourDay.SpringClimb, BagData.Instance.item_grid, spring_climb_func)
    Remind.Instance:Register(Mod.LabourDay.SpringClimb, self.data.spring_climb_data, spring_climb_func, "remind_flag")
    -- 令牌天赐
    Remind.Instance:Register(Mod.RandActivity.HeavenSent,self.data.heaven_sent_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_HEAVEN_SENT) then
            return 0
        end
        return self.data:GetHeavenSentRedNum()
    end)
    --心法无量
    Remind.Instance:Register(Mod.RandActivity.HeartSkill,self.data.heart_skill_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_HEART_SKILL) then
            return 0
        end
        return self.data:GetHeartSkillRedNum()
    end)
    --赋世魂器
    Remind.Instance:Register(Mod.RandActivity.WorldSoul,self.data.world_soul_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_WORLD_SOUL) then
            return 0
        end
        return self.data:GetWorldSoulRedNum()
    end)    
    --拍卖行
    Remind.Instance:Register(Mod.RandActivity.PaiMaiHang,self.data.paimaihang_other_info,function()
        return self.data.paimaihang_other_info.remind_val
    end)
    -- 好运花签
    -- Remind.Instance:Register(Mod.SummerFirst.LuckySign,self.data.lucky_sign_data,function()
    --  if not self.data:IsSummerFirstRemind(ACTIVITY_TYPE.RAND_LUCKY_SIGN) then return 0 end
    --  return self.data:GetLuckySignNum()
    -- end)
    -- 多彩花灯
    -- Remind.Instance:Register(Mod.SummerFirst.FlowerLamp,self.data.flower_lamp_data,function()
    --  if not self.data:IsSummerFirstRemind(ACTIVITY_TYPE.RAND_FLOWER_LAMP) then return 0 end
    --  return self.data:FlowerLampRemind()
    -- end)
    -- 琼楼玉宴
    Remind.Instance:Register(Mod.SummerFirst.Banquet,self.data.banquet_data,function()
        if not self.data:IsSummerFirstRemind(ACTIVITY_TYPE.RAND_BANQUET) then return 0 end
        return self.data:GetBanquetRemind()
    end)
    -- 荷香觅宝
    -- Remind.Instance:Register(Mod.SummerFirst.Lotus,self.data.lotus_data,function()
    --  if not self.data:IsSummerFirstRemind(ACTIVITY_TYPE.RAND_LOTUS) then return 0 end
    --  return self.data:LotusRemindNum()
    -- end)
    -- 初夏历练
    -- Remind.Instance:Register(Mod.SummerFirst.SummerExperience, self.data.summer_experience_data, function()
    --  if not self.data:IsSummerFirstRemind(ACTIVITY_TYPE.RAND_SUMMER_EXPERIENCE) then return 0 end
    --  return self.data:GetSummerExperienceRemind()
    -- end)
    -- 初夏商城
    Remind.Instance:Register(Mod.SummerFirst.SummerFirstShop, SummerFirstShopData.Instance.red_remind, function()
        if not self.data:IsSummerFirstRemind(ACTIVITY_TYPE.RAND_SUMMER_FIRST_SHOP) then return 0 end
        return SummerFirstShopData.Instance:GetSummerFirstShopRemind(ACTIVITY_TYPE.RAND_SUMMER_FIRST_SHOP)
    end)
    -- 元气翻牌
    Remind.Instance:Register(Mod.SummerFirst.CoolCard, self.data.cool_card_data, function()
        if not self.data:IsSummerFirstRemind(ACTIVITY_TYPE.RAND_YUAN_QI_TURNING) then return 0 end
        return 0 == self.data.cool_card_data.open_index and 1 or 0
    end)
    -- 夏日迷宫
    local summer_maze_func = function()
        if not self.data:IsSummerFirstRemind(ACTIVITY_TYPE.RAND_SUMMER_MAZE) then return 0 end
        return SummerMazeData.Instance:TotalRemind()
    end

    Remind.Instance:Register(Mod.SummerFirst.SummerMaze, SummerMazeData.Instance.act_mission, summer_maze_func)
    Remind.Instance:Register(Mod.SummerFirst.SummerMaze, SummerMazeData.Instance.game_info, summer_maze_func)
    Remind.Instance:Register(Mod.SummerFirst.SummerMaze, BagData.Instance.item_grid, summer_maze_func)

    -- 已换皮的旧的红点逻辑需要注释掉，优化性能

    -- 露月争锋（初夏历练换皮）
    Remind.Instance:Register(Mod.NationalDay.SummerExperience, self.data.summer_experience_data, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_SUMMER_EXPERIENCE) then
            return 0
        end
        return self.data:GetSummerExperienceRemind()
    end)
    -- 好运花签（好运花签换皮）
    Remind.Instance:Register(Mod.NationalDay.LuckySign, self.data.lucky_sign_data, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_LUCKY_SIGN) then
            return 0
        end
        return self.data:GetLuckySignNum()
    end)
    -- 多彩河灯（多彩花灯换皮）
    Remind.Instance:Register(Mod.NationalDay.FlowerLamp, self.data.flower_lamp_data, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_FLOWER_LAMP) then
            return 0
        end
        return self.data:FlowerLampRemind()
    end)
    -- 桂香觅宝（荷香觅宝换皮）
    Remind.Instance:Register(Mod.NationalDay.Lotus, self.data.lotus_data, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_LOTUS) then
            return 0
        end
        return self.data:LotusRemindNum()
    end)
    -- 觅宝坊店
    Remind.Instance:Register(Mod.NationalDay.MiBao,self.data.national_mibao_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_NATIONAL_MIBAO_STORE) then
            return 0
        end
        return self.data:GetMiBaoRemindNum()
    end)
    -- 珍品行铺
    Remind.Instance:Register(Mod.RandActivity.Precious,self.data.national_precious_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_PRECIOUS_STORE) then
            return 0
        end
        return self.data:GetPerciousRemindNum()
    end)
    -- 回归豪礼
    Remind.Instance:Register(Mod.RandActivity.RegressReward,self.data.regress_reward_red_pos,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_REGRESS_REWARD) then
            return 0
        end
        return self.data:RegressRewardRedNum()
    end)
    -- 连连乐翻天
    Remind.Instance:Register(Mod.RandActivity.HappyLinkUp,self.data.happy_linkup_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_HAPPY_LINKUP) then
            return 0
        end
        return self.data:HappyLinkUpRedNum()
    end)
    --登录连好礼
    Remind.Instance:Register(Mod.Splendid.SignHappy,self.data.sign_happy_data,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_SIGN_HAPPY) then
            return 0
        end
        return self.data:GetSignHappyRedNum()
    end)
    --万灵共盈
    Remind.Instance:Register(Mod.PlanActivity.AllSoulsFull, self.data.all_souls_full_info,function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_WAN_LING_GONG_YING) then
            return 0
        end
        return self.data.all_souls_full_info.remind_val
    end, "remind_val")
    --欣欣向荣
    local thriving_func = function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_THRIVING_SHOP) then
            return 0
        end
        return self.data:GetThrivingRemind()
    end
    Remind.Instance:Register(Mod.PlanActivity.ThrivingShop, BagData.Instance.item_grid, thriving_func)
    Remind.Instance:Register(Mod.PlanActivity.ThrivingShop, self.data.thriving_shop_data,thriving_func)
    -- 山海问答
    Remind.Instance:Register(Mod.MountainSea.Question, self.data.mountain_sea_question_data, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_MOUNTAIN_SEA_QUESTION) then
            return 0
        end
        return self.data:MountainSeaQuestionRemind()
    end)
    -- 山海风月
    local mountain_sea_wind_moon_func = function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_MOUNTAIN_SEA_WIND_MOON) then
            return 0
        end
        return self.data:MountainSeaWindMoonRemind()
    end
    Remind.Instance:Register(Mod.MountainSea.WindMoon, self.data.mountain_sea_wind_moon_reward_data, mountain_sea_wind_moon_func)
    Remind.Instance:Register(Mod.MountainSea.WindMoon, self.data.mountain_sea_wind_moon_state_data, mountain_sea_wind_moon_func)
    -- 山海争锋
    Remind.Instance:Register(Mod.MountainSea.SummerExperienceTwo, self.data.summer_experience_two_data, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_SUMMER_EXPERIENCE_TWO) then
            return 0
        end
        return self.data:GetSummerExperienceTwoRemind()
    end)
    -- 山海相逢
    Remind.Instance:Register(Mod.MountainSea.Meet, self.data.mountain_sea_meet_data, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_MOUNTAIN_SEA_MEET) then
            return 0
        end
        return self.data:MountainSeaMeetRemind()
    end)
    -- 山海初遇
    Remind.Instance:Register(Mod.MountainSea.FirstMeet, self.data.mountain_sea_first_meet_data, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_MOUNTAIN_SEA_FIRST_MEET) then
            return 0
        end
        return self.data:MountainSeaFirstMeetRemind()
    end)
    -- 超值献礼
    Remind.Instance:Register(Mod.RandActivity.ChaoZhiGift, self.data.chaozhi_gift_info, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RANK_CHAOZHI_GIFT) then
            return 0
        end
        return self.data:ChaoZhiGiftRemind()
    end)

    -- 山海聚宝
    Remind.Instance:Register(Mod.MountainSea.MineCollect, BagData.Instance.item_grid, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_MOUNTAIN_SEA_MINEC) then
            return 0
        end
        return self.data:MountainSeaMineCollectRemind()
    end)
    Remind.Instance:Register(Mod.RandActivity.HorcruxTiancheng, self.data.horcrux_tiancheng_info.role, function()
        if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_HORCRUX_TIANCHENG) then
            return 0
        end
        return self.data:HorcruxTianchengRemind()
    end)

    ActivityRandData.Instance:Register(Mod.RabbitYear.Main,function()
        return self.data:IsOpenRabbitYear()
    end)

    ActivityRandData.Instance:RegisterActCountDown(Mod.RabbitYear.Main, function (TimeMeter)
        if TimeMeter ~= nil then
            local end_time = self.data:GetRabbitYearEndTime()
            TimeMeter:StampTime(end_time or 0,TimeType.Type_Special_9, "")
        end
    end)
end

function ServerActivityCtrl:OnActEvent()
    local act_type = ActivityData.Instance:GetActivityEventType()
    if act_type and act_type <= SERVER_ACTIVITY_MIN_NUM then
        return
    end
    if ActivityData.Instance:GetActivityEventStatus() == ActStatusType.Open then
        if act_type == ACTIVITY_TYPE.RAND_COMBINE_GIFT then
            self.data:OnCombineGiftOpen()
        end
    elseif ActivityData.Instance:GetActivityEventStatus() == ActStatusType.Close then 
        if act_type == ACTIVITY_TYPE.RAND_MOUNTAIN_SEA_MINEC then
            self.data:ReStartMountainSeaRecallNeo()
        end 
        ActivityRandData.SwitchView(act_type,false)
    end

    self.data:CheckOpenServerData()
    self:OnBurningMayDayInfo()
    self.data:CheckAllSoulsFullData()
end

function ServerActivityCtrl:OnUnloadGameLogic()
    ColorfulIllustrateData.Instance:ClearData()
    SevenDayData.Instance:ClearData()
    self.data:ClearFortuneBagData()
    self.data:SetLuckyTurntableSave()
    self:RemoveLittleYearGiftBtn()
    self:RemoveBurningMayDayBtn()
    self.data:ResetHeavenGiftRemind()
    self.data:ResetLabourGiftRemind()
    self.data:ResetOneYuanBuyRemind()
    self.data:ResetExclusiveGiftRemind()
    SummerMazeData.Instance:ResetData()
    self.data:ResetPaiMaiHangRemind()
    self.data:ResetLogonRewardData()
    self.data.cfg_cache_list = {}
    self.data.cfg_cache_nums = {}
    self.data:ResetMountainSeaQuestion()
    self.yunzeersanshi_data:OnUnloadGameLogic()
    self.data.IsCloudSwampIndex = nil
    self.data.cloud_swamp_select_index = nil
    self.vitality_help_others_ctrl:OnUnloadGameLogic()
end

--物品变化监听
function ServerActivityCtrl:OnChangeItemNotice()
    self.data.heritage_treasure_data.val = not self.data.heritage_treasure_data.val
    self.data.partnet_exchang_save.change = not self.data.partnet_exchang_save.change
end

function ServerActivityCtrl:OnRoleCompleteNotice()
    self.data:CheckOpenServerData()
    self.data:LustrateNianItemCheck()
    self:SendColorfulIllustrateSeq()
    self:SendBonusOperaReq()
    self:OnBurningMayDayInfo()
    if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_REGRESS_REWARD) then
        ServerActivityCtrl.Instance:SendBackRewardReq(ServeractivityConfig.BackRewardReqType.TYPE_INFO, 0) --请求下发获取数据
    end
end

function ServerActivityCtrl:OnChangeDayNotice()
    if ActivityData.IsOpen(ACTIVITY_TYPE.RAND_COMBINE_GIFT) then
        ServerActivityData.Instance:OnDayChangeCallCombineGift()
    end
    if ActivityData.IsOpen(ACTIVITY_TYPE.RAND_CLOUD_SWAMP) then
        self.data.IsCloudSwampIndex = nil
        self.data.cloud_swamp_select_index = nil
    end
    if ActivityData.IsOpen(ACTIVITY_TYPE.RAND_VITALITY_HELP_OTHERS) then
        self:SendActivityReq(ACTIVITY_TYPE.RAND_VITALITY_HELP_OTHERS)
    end
end

--随机活动通用请求
function ServerActivityCtrl:SendRandActivityOperaReq(param_t)
    local protocol = ProtocolPool.Instance:GetProtocol(CSRandActivityOperaReq)
    protocol.rand_activity_type = param_t.rand_activity_type
    protocol.opera_type = param_t.opera_type
    protocol.param_1 = param_t.param_1 or 0
    protocol.param_2 = param_t.param_2 or 0
    protocol.param_3 = param_t.param_3 or 0
    protocol.cfg_ver = self.data:GetCfgVer(param_t.rand_activity_type)
    SendProtocol(protocol)
end

--通用协议请求
function ServerActivityCtrl:SendActivityReq(rand_activity_type,opera_type,param_1,param_2,param_3)
    local param_t = {
        rand_activity_type = rand_activity_type or 0,
        opera_type = opera_type or 0,
        param_1 = param_1 or 0,
        param_2 = param_2 or 0,
        param_3 = param_3 or 0,
        cfg_ver = self.data:GetCfgVer(rand_activity_type),
    }
    self:SendRandActivityOperaReq(param_t)
end

--是否支持万能卡购买--buy_item_type :: 购买类型BUY_ITEM_TYPE
--先判断新版，在判断旧版
function ServerActivityCtrl:IsCanItemBuy(buy_item_type, fee)
	if not BUY_GIFT_ITEM_TYPE[buy_item_type] then
		return false,  Language.serveractivity.tip_errorWnk
	end

	-- 新版万能卡判断
	local cfg = Config.sundries_auto
    local gold_num = RechargeData.Instance:MoneyToGold(fee)
	for _,v in pairs(cfg.support_universal_card_activity) do
		if v.buy_type == BUY_GIFT_ITEM_TYPE[buy_item_type] then
			for _,v2 in pairs(cfg.universal_card_value) do
				if v2.value_num == gold_num then
					if Item.GetNum(v2.item_id) > 0 then
						if DEBUG_MODE then
							PublicPopupCtrl.Instance:Center(Language.serveractivity.tip_xwnk)
						end
						return true, v2.item_id
					end
				end
			end
			break
		end
	end

	-- 以下为旧版万能卡判断
	local item_id = 56319
	local timelimited_card_count = Item.GetNum(item_id) -- 获取限时万能卡的数量
    print("限时万能卡数量：" .. timelimited_card_count)
	fee = fee or 1
	if Item.GetNum(item_id) < fee then
		return false, Language.serveractivity.tip_wnkslbz
	end
	if DEBUG_MODE then
		  PublicPopupCtrl.Instance:Center(Language.serveractivity.tip_jwnk)
	end
	return true
end

--直购请求， >> 直购请使用这个接口 <<
--buy_item_type :: 购买类型BUY_ITEM_TYPE
function ServerActivityCtrl:SendBuyCmd(buy_item_type,fee,rand_activity_type,opera_type,param_1,param_2,param_3)
    fee = fee or 1
    if buy_item_type and self:IsCanItemBuy(buy_item_type, fee) then
        self:SendBuyCmdReq(buy_item_type, fee, param_1, param_2)
    else
        self:SendActivityReq(rand_activity_type,opera_type,param_1,param_2,param_3)
    end
end

-- 万能卡直购请求 buy_item_type :: 购买类型BUY_ITEM_TYPE
function ServerActivityCtrl:SendBuyCmdReq(buy_item_type, fee, p1, p2)
	local is_can, item_id = self:IsCanItemBuy(buy_item_type, fee)
	if is_can then
		local func = function()
			local protocol = ProtocolPool.Instance:GetProtocol(CSBuyCmdGift)
			protocol.buy_type = BUY_GIFT_ITEM_TYPE[buy_item_type]
			protocol.p1 = p1 or 0
			protocol.p2 = p2 or 0
			SendProtocol(protocol)
		end
		if item_id and type(item_id) == "number" then
			self:CmdNewCardBuyDialog(item_id, func)
		else
			self:CmdNewCardBuyDialog(item_id, func)
		end
	else
		if item_id and type(item_id) == "string" then
			LogError(item_id)
		end
	end
end

-- 新万能卡使用弹窗
function ServerActivityCtrl:CmdNewCardBuyDialog(item_id, func)
	PublicPopupCtrl.Instance:DialogTips{
		content = Format(Language.Recharge.UniversalCardBuy),
		confirm = {
			func = function ()
				func()
				PublicPopupCtrl.Instance:Center(Format(Language.Recharge.UniversalCardBuyTip))
				ViewMgr:CloseView(DialogTipsView)
			end
		},
		tnr = DTTodayNotRemind.UniversalCardBuy,
	}
end

function ServerActivityCtrl:SendBonusOperaReq(rand_activity_type,opera_type,param_1)
    local protocol = ProtocolPool.Instance:GetProtocol(CSRandActivityBonusOperaReq)
    protocol.rand_activity_type = rand_activity_type or 0
    protocol.opera_type = opera_type or 0
    protocol.param_1 = param_1 or 0
    SendProtocol(protocol)
end               

-- 运营活动获得物品奖励处理
function ServerActivityCtrl:HandleRewardItems(act_type, item_list)
    -- 夏日活动的
    if ACT_SUMMER_SHOW_ITEM_DIALOG[act_type] then
        local item_obj_list = DataHelper.FormatItemList(item_list)
        ViewMgr:OpenView(SummerRewardDialog,item_obj_list)
    elseif ACT_M_S_SHOW_ITEM_DIALOG[act_type]  then
        ActRewardTipData.Instance:OpenActRewardTipViewByData(ServeractivityConfig.ActRewerdTip.RewardType.Success, DataHelper.FormatItemList(item_list))
    elseif act_type == ACTIVITY_TYPE.RAND_TIGER_MORA then
        TigerMoraData.Instance:SaveNeedDelayItem(DataHelper.FormatItemList(item_list))
    end
end

-- 直购通用接口（直购类型，购买价格元宝数）
function ServerActivityCtrl:MoneyBuy(buy_type, money)
    local ret_info = self.data:GetCmdBuyItemCheckRet().ret_info
    if ret_info.unique_id_1 == 0 and ret_info.unique_id_2 == 0 or buy_type ~= ret_info.buy_type then
        return
    end
    if ChannelAgent ~= nil then
        money = RechargeData.Instance:GoldToMoney(money)
        --这里要处理
        ChannelAgent:RequestPay(money, buy_type, ret_info.unique_id_1, ret_info.unique_id_2)
    end
    if IS_EDITOR then
        local cmd_cat = money .. " " .. buy_type .. " " .. ret_info.unique_id_1 .. " " .. ret_info.unique_id_2
        GMCmdCtrl.Instance:SendGMCommand("buyitem", cmd_cat)
    end
end

-- 活动积分获得通知
function ServerActivityCtrl:OnSCRAMoneyAddInfo(protocol)
    if ActivityData.IsOpen(protocol.rand_activity) then
        PublicPopupCtrl.Instance:CenterV({
            item_id = ACT_VIRTUAL_ITEM[protocol.rand_activity],
            num = protocol.add_money,
        })
    else
        PublicPopupCtrl.Instance:Center(Language.Activity.NotOpenTip)
    end
end

--商店限时购买
function ServerActivityCtrl:OnRandActivityTimeLimitStoreInfo(protocol)
    ShopData.Instance:SetTimeLimitStoreInfo(protocol)
end

--开服转盘
function ServerActivityCtrl:OnRandActivityTurnTableInfo(protocol)
    self.data:SetTurnTableInfo(protocol)
end

--开服转盘奖励
function ServerActivityCtrl:OnRandActivityTurnTableReward(protocol)
    self.data:SetTurnTableReward(protocol)
end

--开服商店限时
function ServerActivityCtrl:OnRandDiscountStoreInfo(protocol)
    self.data:SetRandDiscountStoreInfo(protocol)
end

function ServerActivityCtrl:SendLoginSystemReq(day)
    local protocol = ProtocolPool.Instance:GetProtocol(CSLoginSystemReq)
    protocol.day = day or 1
    SendProtocol(protocol)
end 

function ServerActivityCtrl:OnSCLoginSystemInfo(protocol)
    self.data:SetLoginRewardInfo(protocol)
    end 

function ServerActivityCtrl:OnColorfulIllustrateInfo(protocol)
    ColorfulIllustrateData.Instance:SetColorfulIllustrateInfo(protocol)
end

function ServerActivityCtrl:OnColorfulIllustrateSingleInfo(protocol)
    ColorfulIllustrateData.Instance:SetColorfulIllustrateSingleInfo(protocol)
end

function ServerActivityCtrl:OnRAExpelMonsterInfo(protocol)
    self.data:SetTodayTimes(protocol)
end

function ServerActivityCtrl:OnRAHappyUpInfo(protocol)
    self.data:SetRAHappyUpInfo(protocol)
end

function ServerActivityCtrl:OnRASaleShopInfo(protocol)
    self.data:SetRASaleShopInfo(protocol)
end

function ServerActivityCtrl:SendColorfulIllustrateSeq(op_type,index,pigment_list,save_string)
    local protocol = ProtocolPool.Instance:GetProtocol(CSColorfulIllustrateSeq)
    protocol.op_type = op_type or 0
    protocol.index = index or 0
    protocol.pigment_list = pigment_list or ColorfulIllustrateData.Instance:GetListData()
    protocol.save_string = save_string or ""
    SendProtocol(protocol)
end

function ServerActivityCtrl:OnFortuneBagInfo(protocol)
    self.data:SetFortuneBagInfo(protocol)
end

function ServerActivityCtrl:OnActivityPartnerExchange(protocol)
    self.data:SetPartnerExchange(protocol)
end

function ServerActivityCtrl:OnActivityPetExchange(protocol)
    self.data:SetPetExchange(protocol)
end

function ServerActivityCtrl:OnSCRAActivityPetExchangeInfo(protocol)
    self.data:SetPetExchangeOnceInfo(protocol)
end

function ServerActivityCtrl:OnHeavenGiftInfo(protocol)
    self.data:SetHeavenGiftInfo(protocol)
end

function ServerActivityCtrl:OnRADiscountCarnivalInfo(protocol)
    self.data:SetDCInfo(protocol.buy_flag)
end

function ServerActivityCtrl:OnLuckyTurntableInfo(protocol)
    self.data:SetLuckyTurntableInfo(protocol)
end

function ServerActivityCtrl:OnLuckyTurntableReward(protocol)
    self.data:SetLuckyTurntableReward(protocol)
end

function ServerActivityCtrl:OnLuckyDiscountInfo(protocol)
    if self.data:GetLuckyDiscountNum() ~= protocol.discount then
        if ViewMgr:IsOpen(LuckyDiscountView) then
            ViewMgr:OpenView(LuckyDiscountGain,{discount = protocol.discount})
        else
            self.data.lucky_discount_data.is_try = protocol.discount ~= 10
        end
    end
    self.data:SetLuckyDiscountInfo(protocol)
end

function ServerActivityCtrl:OnIllustrateTreasureInfo(protocol)
    self.data:SetIllustrateTreasureInfo(protocol)
end

function ServerActivityCtrl:OnSCRAElementCardsInfo(protocol)
    self.data:SetElementCardsData(protocol)
end

function ServerActivityCtrl:OnSCRASignInContinuityInfo(protocol)
    self.data:SetSignInContinuityData(protocol)
end

--传承瑰宝
function ServerActivityCtrl:OnHeritageTreasureInfo(protocol)
    self.data:SetHeritageTreasureInfo(protocol)
    if self.heritage_treasure_list == nil then
        self.heritage_treasure_list = {}
    end
    for k,v in pairs(protocol.piece_list) do
        if v.npc_id ~= 0 then
            if self.heritage_treasure_list[k] == nil then
                self.heritage_treasure_list[k] = BehaviorData.Instance:CustomNpcTalkBtnsId(v.npc_id,
                BindTool.Bind(self.SetHeritageTreasureBtn, self,v))
            end
        else
            BehaviorData.Instance:RemoveCustomNpcTalkBtnsId(self.heritage_treasure_list[k])
            self.heritage_treasure_list[k] = nil
        end
    end
end

function ServerActivityCtrl:SetHeritageTreasureBtn(info,btn_list,obj_vo)
    if obj_vo and obj_vo.id == info.npc_id then
        table.insert(btn_list,NpcDialogBehBtnData.FuncCreate(Language.HeritageTreasure.Btn,function()
            if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_HERITAGE_TREASURE) then
                PublicPopupCtrl.Instance:Center(Language.Activity.NotOpenTip)
                return
            end
            ServerActivityCtrl.Instance:SendActivityReq(ACTIVITY_TYPE.RAND_HERITAGE_TREASURE,2,info.index-1)
            ViewMgr:OpenView(HeritageTreasureView)
        end,true))
    end
end

function ServerActivityCtrl:OnSCRAZhuanShuLiBaoInfo(protocol)
    self.data:SetExclusiveGiftInfo(protocol)
end
function ServerActivityCtrl:OnSCRAZhuanShuLiBaoDayInfo(protocol)
    self.data:SetExclusiveGiftDayInfo(protocol)
end

--财神聚宝
function ServerActivityCtrl:OnSCRAWealthCornucopiaInfo(protocol)
    self.data:SetWealthCornucopiaInfo(protocol)
    self.data:SetBonusNum(ACTIVITY_TYPE.RAND_WEALTH_CORNUCOPIA,protocol.flag_num,#self.data:GetWealthCornucopiaListByDayNum())
end

--限时宝盒
function ServerActivityCtrl:OnSCRAXianShiBaoHeInfo(protocol)
    self.data:SetGiftBoxInfo(protocol)
    self.data:SetBonusNum(ACTIVITY_TYPE.RAND_GIFT_BOX,protocol.flag_num,#self.data:GetGiftBoxShowList())
end

--限时宝袋
function ServerActivityCtrl:OnSCRAXianShiBaoDaiInfo(protocol)
    self.data:SetChainBoxInfo(protocol)
    self.data:SetBonusNum(ACTIVITY_TYPE.RAND_CHAIN_BOX,protocol.flag_num,#self.data:GetChainBoxShowList())
end

--经验飙升
function ServerActivityCtrl:OnSCRAJingYanBiaoShengInfo(protocol)
    self.data:SetExpPurchaseInfo(protocol)
end

function ServerActivityCtrl:SendMakeUpReq(act_type,make_type)
    local protocol = ProtocolPool.Instance:GetProtocol(CSRandActivityMakeUpReq)
    protocol.act_type = act_type or 0
    protocol.make_type = make_type or 0
    SendProtocol(protocol)
end

--赠30连抽
function ServerActivityCtrl:OnSCRAGivePetDrawInfo(protocol)
    self.data:SetGivePetDrawInfo(protocol)
end

--额外奖励
function ServerActivityCtrl:OnRandActivityBonusInfo(protocol)
    self.data:SetRandActivityBonusInfo(protocol)
end

--联动送礼
function ServerActivityCtrl:OnRALinkageGiftInfo(protocol)
    self.data:SetRALinkageGiftInfo(protocol)
end

--奇遇礼包
function ServerActivityCtrl:OnRaAdventureGiftInfo(protocol)
    self.data:SetRaAdventureGiftInfo(protocol)
end

function ServerActivityCtrl:OnRAGroupDiscountInfo(protocol)
    self.data:SetRAGroupDiscountInfo(protocol)
end

-- 牛运兑换
function ServerActivityCtrl:OnSCRANCowConvertInfo(protocol)
    self.data:SetCowConvertData(protocol)
end

-- 牛运当头
function ServerActivityCtrl:OnSCRAMonpolyGiftInfo(protocol)
    self.data:SetCowOriginMapData(protocol)
    self.data:SetCowOriginConvertData(protocol)
end

--牛运当头答题信息
function ServerActivityCtrl:OnSCRAMonpolyGiftQuestionInfo(protocol)
    self.data:SetCowOriginAnswerData(protocol)
end

function ServerActivityCtrl:OnRandActivityNXDYInof(protocol)
    self.data:SetRACowGoingLuckInfo(protocol)
end

--小年送礼
function ServerActivityCtrl:OnRALittleYearGiftInfo(protocol)
    if self.data:GetLittleYearGiftThreadId() ~= protocol.thread_id then
        self:RemoveLittleYearGiftBtn()
    end
    self.data:SetRALittleYearGiftInfo(protocol)
    if protocol.has_get_reward == 0 then
        if self.little_year_gift == nil then
            local config = self.data:GetLittleYearGiftThread(protocol.thread_id)
            self.little_year_gift = BehaviorData.Instance:CustomNpcTalkBtnsId(config.npc_id,
            BindTool.Bind(self.SetLittleYearGiftBtn, self,config))
        end
    else
        self:RemoveLittleYearGiftBtn()
    end
end

function ServerActivityCtrl:SetLittleYearGiftBtn(info,btn_list,obj_vo)
    if obj_vo and obj_vo.id == info.npc_id then
        local name = ActivityRandData.GetName(ACTIVITY_TYPE.RAND_LITTLE_YEAR_GIFT)
        local detail_info = NpcDialogData.CreateDetailInfo1({tips = {info.talk_text},
            rewards = self.data:GetLittleYearGiftRewardData(info.thread_id)
        })
        local button = NpcDialogBehBtnData.FuncCreate(name,function()
            if not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_LITTLE_YEAR_GIFT) then
                PublicPopupCtrl.Instance:Center(Language.Activity.NotOpenTip)
                return
            end
            self:SendActivityReq(ACTIVITY_TYPE.RAND_LITTLE_YEAR_GIFT,1,info.npc_id)
        end,true,detail_info)
        button:SetIconType(NpcIconType.Act)
        table.insert(btn_list,button)
    end
end

function ServerActivityCtrl:RemoveLittleYearGiftBtn()
    if self.little_year_gift then
        BehaviorData.Instance:RemoveCustomNpcTalkBtnsId(self.little_year_gift)
        self.little_year_gift = nil
    end
end

-- 年货节
function ServerActivityCtrl:OnSCRASpringFestivalStoreInfo(protocol)
    self.data:SetSpringFestivalStoreInfo(protocol)
end

-- 赠寻宝钥匙
function ServerActivityCtrl:OnSCRAGiveSecretKeyInfo(protocol)
    self.data:SetGiveSecretKeyData(protocol)
end

-- 累计充值
function ServerActivityCtrl:OnSCRACumulativeChargeInfo(protocol)
    self.data:SetAccRechargeData(protocol)
end

-- 宠物夺宝
function ServerActivityCtrl:OnSCRAPetLootInfo(protocol)
    self.data:SetPetLootInfo(protocol)
end

function ServerActivityCtrl:OnTradeMarketReturnGoldInfo(protocol)
    self.data:SetTradeMarketReturnGoldInfo(protocol)
end

function ServerActivityCtrl:OnTradeMarketReturnHotItemInfo(protocol)
    self.data:SetTradeMarketReturnHotItemInfo(protocol)
end

-- 神兽降临奖池信息
function ServerActivityCtrl:OnSCRAPetBefallInfo(protocol)
    self.data:SetPetBefallInfo(protocol)
end

-- 神兽降临转盘结果
function ServerActivityCtrl:OnSCRAPetBefallResult(protocol)
    self.data:SetPetBefallResult(protocol)
end

-- 神兽降临直购信息
function ServerActivityCtrl:OnSCPetBefallBuyInfo(protocol)
    self.data.pet_befall_store_data.act_buy_times = protocol.info.act_buy_times[1]
    self.data.pet_befall_store_data.day_buy_times = protocol.info.day_buy_times[1]
end

-- 好礼转动下发
function ServerActivityCtrl:OnSCRAGoodGiftTurnInfo(protocol)
    self.data:SetGiftRotationInfo(protocol)
end

-- 好礼转动抽取到的礼盒下发
function ServerActivityCtrl:OnSCRAGoodGiftTurnRewardInfo(protocol)
    self.data:SetGiftRotationGetInfo(protocol)
end

function ServerActivityCtrl:OnCSHearsayInfo(protocol)
    self.data:SetHearsayInfo(protocol)
end

-- 幸运迷宫
function ServerActivityCtrl:OnSCRALuckyMazeInfo(protocol)
    self.lucky_maze_data:SetActData(protocol)
end

-- 幸运迷宫拼图信息
function ServerActivityCtrl:OnSCRALuckyMazePuzzleInfo(protocol)
    self.lucky_maze_data:SetPuzzleData(protocol)
end

function ServerActivityCtrl:OnSCRALuckyMazeBoxInfo(protocol)
    LuckyMazeData.Instance:SetSceneRewardInfo({layer = 1,box_num_r = 1 - protocol.box_num,box_num_max = 1,max_layer = 1})
end

-- 春日登峰
function ServerActivityCtrl:OnSCRAChunRiDengFengInfo(protocol)
    self.data:SetSpringClimbInfo(protocol)
end

-- 特惠秘宝
function ServerActivityCtrl:OnSCRASecretTreasureInfo(protocol)
    self.data:SetSecretTreasureInfo(protocol)
end

-- 劳动好礼
function ServerActivityCtrl:OnSCRALaoDongHaoLiInfo(protocol)
    self.data:SetLabourGiftInfo(protocol)
end

--活动大使 原五一复用
function ServerActivityCtrl:OnBurningMayDayInfo()
    if not self.data:GetSummerFirstEnd() and not ActivityData.IsOpen(ACTIVITY_TYPE.RAND_SPlace_Anecdote) then
        self:RemoveBurningMayDayBtn()
        return
    end
    if self.burningmay_handle then
        return
    end
    self.burningmay_handle = {}
    SceneCtrl.Instance:AddNpc(Config.ambassador_activity_auto.other[1].npc_id)
    for i,v in ipairs(Config.ambassador_activity_auto.basis_configuration) do
        local npc_id = Config.ambassador_activity_auto.other[1].npc_id
        self.burningmay_handle[i] = BehaviorData.Instance:CustomNpcTalkBtnsId(npc_id,
        BindTool.Bind(self.SetBurningMayDayBtn,self,v))
    end
end

function ServerActivityCtrl:SetBurningMayDayBtn(info,btn_list,obj_vo)
    if obj_vo and obj_vo.id == Config.ambassador_activity_auto.other[1].npc_id then
        local name = ActivityRandData.GetName(info.act_type)
        local detail_info = NpcDialogData.CreateDetailInfo1({tips = Split(info.desc,"%\n"),
            rewards = DataHelper.FormatItemList(info.reward_item)
        })
        local button = NpcDialogBehBtnData.FuncCreate(name,function()
            if not ActivityData.IsOpen(info.act_type) then
                PublicPopupCtrl.Instance:Center(Language.Activity.NotOpenTip)
                return
            end
            if info.act_type == 2118 then
                ViewMgr:OpenView(BanquetPutItemsView)
                return
            end
            if ActivityRandData.Instance:OnClickHandle(info.act_type) then
                return
            else
                ActivityRandData.SwitchView(info.act_type,true)
            end
        end,true,detail_info)
        button:SetIconType(NpcIconType.Act)
        table.insert(btn_list,button)
    end
end

function ServerActivityCtrl:RemoveBurningMayDayBtn()
    SceneCtrl.Instance:DeleteNpc(Config.ambassador_activity_auto.other[1].npc_id)
    for k,v in pairs(self.burningmay_handle or {}) do
        BehaviorData.Instance:RemoveCustomNpcTalkBtnsId(v)
    end
    self.burningmay_handle = nil
end

function ServerActivityCtrl:OnSCRAZuHeHeLiInfo(protocol)
    self.data:SetCombineGiftInfo(protocol)
end

function ServerActivityCtrl:OnSCRAMiJingQiWenQuestionInfo(protocol)
    SplaceAnecdoteData.Instance:SplaceAnecQuestionInfo(protocol)
    ViewMgr:OpenView(SplaceAnecQuestView)
end

function ServerActivityCtrl:SendSplaceQuestionReq(param_t)
    local protocol = ProtocolPool.Instance:GetProtocol(CSRAMiJingQiWenQuestionReq)
    protocol.answer_id = param_t.answer_id or 0
    protocol.npc_obj_id = param_t.npc_obj_id or 0
    SendProtocol(protocol)
end

function ServerActivityCtrl:SendCloseWindosReq(param_t)
    local protocol = ProtocolPool.Instance:GetProtocol(CSCloseWindosReq)
    protocol.reason = param_t.reason or 0
    SendProtocol(protocol)
end

function ServerActivityCtrl:SendSplaceBuyItemReq(param_t)
    local protocol = ProtocolPool.Instance:GetProtocol(CSRAMiJingQiWenBuyItemReq)
    protocol.item_idx = param_t.item_idx or 0
    protocol.npc_obj_id = param_t.npc_obj_id or 0
    SendProtocol(protocol)
end

function ServerActivityCtrl:OnSCRAMiJingQiWenShopInfo(protocol)
    SplaceAnecdoteData.Instance:SplaceAnecShopInfo(protocol)
    ViewMgr:OpenView(SplaceAnecShopView)
end 

function ServerActivityCtrl:OnSCRAMiJingQiWenShopBuyTimesInfo(protocol)
    SplaceAnecdoteData.Instance:SplaceAnecShopBuyTimeInfo(protocol)
end 

function ServerActivityCtrl:OnSCCloseWindosRet(protocol)
    SplaceAnecdoteData.Instance:SetCloseWindos(protocol)
end

function ServerActivityCtrl:OnSCCmdBuyItemCheckRet(protocol)
    --LogError("OnSCCmdBuyItemCheckRet",protocol)
    self.data:SetCmdBuyItemCheckRet(protocol)
end

function ServerActivityCtrl:SendCmdBuyItemCheckReq(buy_type, fee, param1, param2, cfg_ver)
	local is_can, item_id = self:IsCanItemBuy(buy_type, fee)
	if is_can then
		local func = function()
			self:SendBuyCmdReq(buy_type, fee, param1, param2)
		end
		if item_id and type(item_id) == "number" then
			self:CmdNewCardBuyDialog(item_id, func)
		else
			func()
		end
		return
	end

    local protocol = ProtocolPool.Instance:GetProtocol(CSCmdBuyItemCheckReq)
    protocol.buy_type = buy_type or 0
    protocol.param1 = param1 or 0
    protocol.param2 = param2 or 0
    protocol.cfg_ver = cfg_ver or 0
    SendProtocol(protocol)
end

function ServerActivityCtrl:OnRAHeavenSentInfo(protocol)
    self.data:SetRAHeavenSentInfo(protocol)
end

function ServerActivityCtrl:OnRAHeartSkillInfo(protocol)
    self.data:SetRAHeartSkillInfo(protocol)
end

function ServerActivityCtrl:OnRAWorldSoulInfo(protocol)
    self.data:SetRAWorldSoulInfo(protocol)
end

function ServerActivityCtrl:OnRAFashionShopInfo(protocol)
    self.data:SetFashionShopInfo(protocol)
end

function ServerActivityCtrl:SCRAOneYuanGouInfo(protocol)
    self.data:SetOneYuanBuyInfo(protocol)
end

function ServerActivityCtrl:OnSCRASummerLiLianAllInfo(protocol)
    self.data:SetSummerExperienceInfo(protocol)
end

-- 多彩花灯
function ServerActivityCtrl:FlowerReq(oper_type,p1,p2,p3)
    local act = ACTIVITY_TYPE.RAND_FLOWER_LAMP
    self:SendActivityReq(act,oper_type,p1,p2,p3)
end

function ServerActivityCtrl:OnSCRAFlowerLampBaseInfo(protocol)
    self.data:SetFlowerLampBaseInfo(protocol)
end

function ServerActivityCtrl:OnSCRAFlowerLampGameInfo(protocol)
    self.data:SetFlowerLampGameInfo(protocol)
    if protocol.info.notice_type == FlowerLampData.NoticeType.GameOver then
        PublicPopupCtrl.Instance:Center(string.format(Language.FlowerLamp.GameOverTip,protocol.info.score))
    end
end

function ServerActivityCtrl:OnSCRAFlowerLampItemInfo(protocol)
    self.data:SetFlowerLampItemInfo(protocol)
    -- 当没有游戏状态时，强制结束游戏（重连情况下）
    if not self.data.flower_lamp_data.game_info.notice_type then
        if self.data.flower_lamp_end_flag then
            self:FlowerReq(FlowerLampData.ReqType.ForceClose)
            self.data.flower_lamp_data.item_info = {}
            self.data.flower_lamp_end_flag = nil
        end
        self.data.flower_lamp_end_flag = true
    end
end

-- 琼楼玉宴
function ServerActivityCtrl:BanquetReq(oper_type,p1,p2,p3)
    local act = ACTIVITY_TYPE.RAND_BANQUET
    self:SendActivityReq(act,oper_type,p1,p2,p3)
end

function ServerActivityCtrl:OnSCBanquetInfo(protocol)
    self.data:SetBanquetBaseInfo(protocol)
end

function ServerActivityCtrl:OnSCBanquetRewardInfo(protocol)
    self.data:SetBanquetRewardInfo(protocol)
end

-- 荷香觅宝
function ServerActivityCtrl:OnSCRALotusInfo(protocol)
    self.data:SetLotusInfo(protocol)
end

-- 好运花签信息下发
function ServerActivityCtrl:OnRALuckySignInfo(protocol)
    self.data:SetRALuckySignInfo(protocol)
end

function ServerActivityCtrl:OnSCRASummerStoreInfo(protocol)
    SummerFirstShopData.Instance:SetSummerFirstShopInfo(protocol)
end

function ServerActivityCtrl:OnSCRASummerStoreSingleInfo(protocol)
    SummerFirstShopData.Instance:SetSummerFirstShopSingleInfo(protocol)
end

function ServerActivityCtrl:OnSCRASuperOffShopInfo(protocol)
    SummerFirstShopData.Instance:SetSummerDiscountShopInfo(protocol)
end

function ServerActivityCtrl:OnSCRASuperOffShopSingleInfo(protocol)
    SummerFirstShopData.Instance:SetSummerDiscountShopSingleInfo(protocol)
end

-- 元气翻牌
function ServerActivityCtrl:OnRAYuanQiTurningInfo(protocol)
    self.data:SetRAYuanQiTurningInfo(protocol)
end

function ServerActivityCtrl:SendRAYuanQiTurningInfo()
    local param_t = {}
    param_t.rand_activity_type = ACTIVITY_TYPE.RAND_YUAN_QI_TURNING
    param_t.opera_type = 0
    ServerActivityCtrl.Instance:SendRandActivityOperaReq(param_t)
end

function ServerActivityCtrl:SendRAYuanQiTurningOpen(open_index)
    local param_t = {}
    param_t.rand_activity_type = ACTIVITY_TYPE.RAND_YUAN_QI_TURNING
    param_t.opera_type = 1
    param_t.param_1 = open_index
    ServerActivityCtrl.Instance:SendRandActivityOperaReq(param_t)
end

-- 凉风送爽
function ServerActivityCtrl:OnRACoolBreezeInfo(protocol)
    self.data:SetRACoolBreezeInfo(protocol)
end

function ServerActivityCtrl:OnRACoolBreezeSingleInfo(protocol)
    self.data:SetRACoolBreezeSingleInfo(protocol)
end

function ServerActivityCtrl:SendRACoolBreezeCommit(index, type)
    local param_t = {}
    param_t.rand_activity_type = ACTIVITY_TYPE.RAND_COOL_BREEZE
    param_t.opera_type = 1
    param_t.param_1 = index - 1
    param_t.param_2 = type
    ServerActivityCtrl.Instance:SendRandActivityOperaReq(param_t)
end

function ServerActivityCtrl:SendRACoolBreezeRefresh(index)
    local param_t = {}
    param_t.rand_activity_type = ACTIVITY_TYPE.RAND_COOL_BREEZE
    param_t.opera_type = 2
    param_t.param_1 = index - 1
    ServerActivityCtrl.Instance:SendRandActivityOperaReq(param_t)
end

-- 夏日迷宫
function ServerActivityCtrl:OnSCMazeSummerMapInfo(protocol)
    SummerMazeData.Instance:SetTotalMapInfo(protocol)
end

function ServerActivityCtrl:OnSCMazeSummerSingleMapInfo(protocol)
    SummerMazeData.Instance:SetSingleMapInfo(protocol)
end

function ServerActivityCtrl:OnSCMazeSummerShopInfo(protocol)
    SummerMazeData.Instance:SetShopInfo(protocol)
end

function ServerActivityCtrl:OnSCMazeSummerQuestionInfo(protocol)
    SummerMazeData.Instance:SetQuestionInfo(protocol)
end

function ServerActivityCtrl:OnSCMazeSummerTaskInfo(protocol)
    SummerMazeData.Instance:SetMissionInfo(protocol)
end

function ServerActivityCtrl:OnSCMazeSummerStatusInfo(protocol)
    SummerMazeData.Instance:SetStatusInfo(protocol)
end

function ServerActivityCtrl:OnSCMazeSummerPlayFinishInfo(protocol)
    SummerMazeData.Instance:SetFinishInfo(protocol)
end

function ServerActivityCtrl:OnSCMazeSummerMyPosInfo(protocol)
    SummerMazeData.Instance:SetPosInfo(protocol)
end

--觅宝
function ServerActivityCtrl:OnSCRAMiBaoFangDianInfo(protocol)
    self.data:SetSCRAMiBaoFangDianInfo(protocol)
end

function ServerActivityCtrl:OnSCRAMiBaoFangDianSingleInfo(protocol)
    self.data:SetSCRAMiBaoFangDianSingleInfo(protocol)
end

--珍品
function ServerActivityCtrl:OnSCRAZhenPinShangPuInfo(protocol)
    self.data:SetSCRAPreciousDianInfo(protocol)
end
--珍品
function ServerActivityCtrl:OnSCRAZhenPinShangPuOpenDay(protocol)
    self.data:SetOnSCRAZhenPinShangPuOpenDay(protocol)
end

--拍卖行
function ServerActivityCtrl:OnSCRAPaiMaiHangNoticeInfo(protocol)
    self.data:SetPaiMaiHangNoticeInfo(protocol)
end

function ServerActivityCtrl:OnSCRAPaiMaiHangSingleNoticeInfo(protocol)
    self.data:SetPaiMaiHangSingleNoticeInfo(protocol)
end

function ServerActivityCtrl:OnSCRAPaiMaiHangUserInfo(protocol)
    self.data:SetPaiMaiHangUserInfo(protocol)
end

function ServerActivityCtrl:OnSCRAPaiMaiHangUserSingleInfo(protocol)
    self.data:SetPaiMaiHangUserSingleInfo(protocol)
end

function ServerActivityCtrl:OnSCRAPaiMaiHangUserRecordInfo(protocol)
    self.data:SetPaiMaiHangUserRecordInfo(protocol)
end

function ServerActivityCtrl:SendPaiMaiHangReq(opera_type, param_1, param_2, param_3)
    self:SendActivityReq(ACTIVITY_TYPE.RAND_PAI_MAI_HANG, opera_type, param_1, param_2, param_3)
end

function ServerActivityCtrl:OnSCBackRewardInfo(protocol)
    self.data:SetBackRewardInfo(protocol)
end
function ServerActivityCtrl:SendBackRewardReq(type , param1)
    local protocol = ProtocolPool.Instance:GetProtocol(CSBackRewardReq)
    protocol.req_type = type --请求类型
    protocol.param1 = param1 --index
    SendProtocol(protocol)
end

function ServerActivityCtrl:OnHappyLookInfo(protocol)
    self.data:SetHappyLookInfo(protocol)
end 
function ServerActivityCtrl:OnSCRASignHappyInfo(protocol)
    self.data:SetSignHappyInfo(protocol)
end

--[[    万灵共盈
0 请求数据信息
1 领取奖励  param1 = task_index
2 直购效验]]
function ServerActivityCtrl:SendAllSoulsFullReq(opera_type, param_1, param_2, param_3)
    self:SendActivityReq(ACTIVITY_TYPE.RAND_WAN_LING_GONG_YING, opera_type, param_1, param_2, param_3)
end

function ServerActivityCtrl:OnSCRAWanLingGongYingInfo(protocol)
    self.data:SetAllSoulsFullInfo(protocol)
end

function ServerActivityCtrl:OnSCRAResultNotice(protocol)
    if protocol.activity_type == ACTIVITY_TYPE.CATCH_BUTTERFLY then
        CatchButterfliesCtrl.Instance:OnSCRAResultNotice(protocol)
    else
        self.act_reward_tip_data:SetResultNotice(protocol)
    end
end

-- 山海问答
function ServerActivityCtrl:OnSCRAShanHaiQuestionInfo(protocol)
    self.data:SetMountainSeaQuestionData(protocol)
end

function ServerActivityCtrl:OnSCRAShanHaiQuestionStateInfo(protocol)
    self.data:SetMountainSeaQuestionStateData(protocol)
end

-- 山海风月
function ServerActivityCtrl:OnSCRAShanHaiWindMoonRewardInfo(protocol)
    self.data:SetMountainSeaWindMoonRewardData(protocol)
end

function ServerActivityCtrl:OnSCRAShanHaiWindMoonStateInfo(protocol)
    self.data:SetMountainSeaWindMoonStateData(protocol)
end

function ServerActivityCtrl:OnSCRAShanHaiWindMoonLotteryInfo(protocol)
    self.data:SetMountainSeaWindMoonLotteryData(protocol)
end

-- 山海聚宝
function ServerActivityCtrl:OnSCRAShanHaiJuBaoInfo(protocol)
    self.data:SetMountainSeaMineCollectInfo(protocol)
end

function ServerActivityCtrl:OnSCRAShanHaiJuBaoDrawRet(protocol)
    self.data:SetMountainSeaMineCollectDrawRet(protocol)
end

-- 魂器天成
function ServerActivityCtrl:OnRAHorcruxTianChengRoleInfo(protocol)
    self.data:SetRAHorcruxTianChengRoleInfo(protocol)
end

function ServerActivityCtrl:OnRAHorcruxTianChengPoolInfo(protocol)
    self.data:SetRAHorcruxTianChengPoolInfo(protocol)
end

function ServerActivityCtrl:OnRAHorcruxTianChengDrawResult(protocol)
    self.data:SetRAHorcruxTianChengDrawResult(protocol)
end

-- 0 请求数据信息
-- 1 抽奖
-- 2 兑换 param1 = exchange_index
-- 3 购买 param1 = shop_index
-- 4 直购检查 param1 = shop_index

function ServerActivityCtrl:SendActivityHorcruxTianChengReq(opera_type, param_1)
    self:SendActivityReq(ACTIVITY_TYPE.RAND_HORCRUX_TIANCHENG, opera_type, param_1)
end

function ServerActivityCtrl:SendActivityHorcruxTianChengReqInfo()
    self:SendActivityHorcruxTianChengReq(0)
end

function ServerActivityCtrl:SendActivityHorcruxTianChengReqRolling()
    self:SendActivityHorcruxTianChengReq(1)
end

function ServerActivityCtrl:SendActivityHorcruxTianChengReqExchange(exchange_index)
    self:SendActivityHorcruxTianChengReq(2, exchange_index)
end

function ServerActivityCtrl:SendActivityHorcruxTianChengReqBuy(shop_index)
    self:SendActivityHorcruxTianChengReq(3, shop_index)
end

function ServerActivityCtrl:SendActivityHorcruxTianChengReqConsumeGet(seq)
    self:SendActivityHorcruxTianChengReq(5, seq)
end
function ServerActivityCtrl:SendActivityHorcruxTianChengReqMoneyCheck(data)
    ServerActivityCtrl.Instance:SendBuyCmd(BUY_ITEM_TYPE.TYPE_HORCRUX_TIANCHENG, data.buy_money / 10, ACTIVITY_TYPE.RAND_HORCRUX_TIANCHENG, 4, data.seq)
end


-- 超值献礼
function ServerActivityCtrl:OnRAChaoZhiGiftInfo(protocol)
    self.data:SetRAChaoZhiGiftInfo(protocol)
end

-- 0 直购
-- 1 领取 param1 = gift_index

function ServerActivityCtrl:SendActivityChaoZhiGiftReq(opera_type, param_1)
    if opera_type == 0 then
        self:SendBuyCmd(BUY_ITEM_TYPE.TYPE_CHAOZHI_GIFT, self.data:GetChaoZhiGiftPrice() / 10,ACTIVITY_TYPE.RANK_CHAOZHI_GIFT, opera_type, param_1)
    else
        self:SendActivityReq(ACTIVITY_TYPE.RANK_CHAOZHI_GIFT, opera_type, param_1)
    end
end

function ServerActivityCtrl:SendActivityChaoZhiGiftReqBuy()
    self:SendActivityChaoZhiGiftReq(0)
end

function ServerActivityCtrl:SendActivityChaoZhiGiftReqGet(gift_index)
    self:SendActivityChaoZhiGiftReq(1, gift_index)
end

--山海相逢
function ServerActivityCtrl:OnSCRAShanHaiMeetInfo(protocol)
    self.data:SetMountainSeaMeetTaskInfo(protocol)
end
function ServerActivityCtrl:SendShanHaiMeetResetPoker() --刷新翻牌
    if self.data:GetMountainSeaMeetIsAllOpen() then
        ServerActivityCtrl.Instance:SendActivityReq(ACTIVITY_TYPE.RAND_MOUNTAIN_SEA_MEET,4)
    end
end

--山海初遇
function ServerActivityCtrl:OnSCRAShanHaiMetBase(protocol)
    self.data:SetMountainSeaFirstMeetInfo(protocol)
end

function ServerActivityCtrl:OnSCRAShanHaiMetTakeParam(protocol)
    self.data:SetMountainSeaFirstMeetTask(protocol)
end

function ServerActivityCtrl:OnSCRAShanHaiMetTaskParamChange(protocol)
    self.data:SetMountainSeaFirstMeetInfoChange(protocol)
end

-- 魔族在哪里
function ServerActivityCtrl:OnRAMoZuZaiNaLiInfo(protocol)
    self.mozuzainali_data:SetRAMoZuZaiNaLiInfo(protocol)
end

-- 云泽二三事
function ServerActivityCtrl:OnRAYunZeErSanShiInfo(protocol)
    self.yunzeersanshi_data:SetRAYunZeErSanShiInfo(protocol)
end

function ServerActivityCtrl:OnRAYunZeErSanShiTurntableInfo(protocol)
    self.yunzeersanshi_data:SetRAYunZeErSanShiTurntableInfo(protocol)
end

-- 0 请求数据信息
-- 1 答题 param1 = task_id
-- 2 抽奖

function ServerActivityCtrl:SendActivityYunZeErSanShiReq(opera_type, param_1)
    self:SendActivityReq(ACTIVITY_TYPE.RAND_YUN_ZE_ER_SAN_SHI, opera_type, param_1)
end

function ServerActivityCtrl:SendActivityYunZeErSanShiReqInfo()
    self:SendActivityYunZeErSanShiReq(0)
end

function ServerActivityCtrl:SendActivityYunZeErSanShiReqAnswer()
    self:SendActivityYunZeErSanShiReq(1, self.yunzeersanshi_data:GetAnswerTaskId())
end

function ServerActivityCtrl:SendActivityYunZeErSanShiReqRolling()
    self:SendActivityYunZeErSanShiReq(2)
end

--再战云泽
function ServerActivityCtrl:OnRACloudSwampResult(protocol)
    self.data:SetRACloudSwampResult(protocol)
end

-- 山海争锋
function ServerActivityCtrl:OnSCRAShanHaiZhengFengAllInfo(protocol)
    self.data:SetSummerExperienceTwoInfo(protocol)
end

--周末限好礼
function ServerActivityCtrl:OnWeedendGiftInfo(protocol)
    self.data:SetWeedendGiftInfo(protocol)
end