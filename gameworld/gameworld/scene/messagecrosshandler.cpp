#include "scene/scenemanager.hpp"
#include "servercommon/internalprotocal/crossgameprotocal.h"
#include "global/cross/crossmanager.h"
#include "servercommon/serverconfig/crossconfig.hpp"
#include "world.h"
#include "global/cross/crossuserregister.hpp"
#include "servercommon/errornum.h"
#include "obj/character/role.h"
#include "other/rolemodulemanager.hpp"
#include "other/rolecross/rolecross.hpp"
#include "global/cross/crossusershadow.hpp"
#include "scene/delayloginmanager.hpp"
#include "internalcomm.h"
#include "global/team/teammanager.hpp"
#include "global/team/team.hpp"
#include "global/team/teammatch.hpp"
#include "global/trademarket/trademarketmanager.hpp"
#include "gamelog.h"
#include "other/route/mailroute.hpp"
#include "chat/chatmanager.h"
#include "global/guild/guildmanager.hpp"
#include "global/guild/guild.hpp"
#include "global/guild/guildmembermanager.hpp"
#include "global/worldstatus/worldstatus.hpp"
#include "global/activity/activitymanager.hpp"
#include "global/activity/activityimpl/activitychiefpeakbattle.hpp"
#include "global/activity/activityimpl/activitychiefelection.hpp"
#include "global/activity/activityimpl/activityguildhonorbattle.hpp"
#include "protocol/msgchiefelection.h"
#include "protocol/msgchiefpeakbattle.h"
#include "protocol/msghuanjiezhanchang.h"
#include "global/usercache/usercache.hpp"
#include "global/randactivity/randactivitymanager.hpp"
#include "friend/friendmanager.h"
#include "item/money.h"
#include "servercommon/struct/roleotherinitparam.hpp"
#include "gameworld/other/queryhandler/queryhandler.hpp"
#include "servercommon/string/gameworldstr.h"
#include "global/offlineregister/offlineregistermanager.hpp"
#include "scene/speciallogicimpl/mazeracermanager.hpp"
#include "servercommon/internalprotocal/lgprotocal.h"
#include "global/server_first_kill/serverfirstkill.hpp"
#include "servercommon/userprotocal/msgchatmsg.h"
#include "global/activity/activityimpl/activityhuanjiezhanchang.hpp"
#include "servercommon/noticenum.h"
#include "global/randactivity/randactivityadapter.hpp"
#include "global/randactivity/hiddenrandactivityshadow.hpp"
#include "global/activity/activityimpl/activitybraveground.hpp"
#include "protocol/msgbraveground.h"
#include "chat/crosschatgroupmanager.h"
#include "battle/battle_manager_local.hpp"
#include "global/platformbattle/platformbattle.h"
#include "other/rolemail/rolemail.hpp"
#include "global/mail/mailmanager.hpp"
#include "global/mail/usermail.hpp"
#include "protocol/randactivity/msgratrademarketreturngold.hpp"
#include "chat/muteplayerrecorder.hpp"
#include "config/sharedconfig/sharedconfig.h"
#include "other/event/eventhandler.hpp"
#include "other/trade_credit/trade_credit.hpp"
#include "global/guildhonorbattlemanager/guildhonorbattlemanager.hpp"
#include "protocol/msgguildhonorbattle.h"
#include "servercommon/internalcommmonitor.hpp"
#include "other/bigdipper/bigdippermanager.hpp"
#include "global/tiandidaohen/tiandidaohen.h"
#include "global/givegift/givegift.h"
#include "global/jieyi/jieyizumanager.h"
#include "global/qingyuan/qingyuanmanager.h"
#include "global/bigcross/bigcrossmanager.hpp"

void SceneManager::InitCrossHandler()
{
	memset(m_on_cross_handler, 0, sizeof(m_on_cross_handler));
	std::set<std::string> function_add_set;

	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_GAME_HELLO, SceneManager::OnCrossHello, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_HIDDEN_REGISTER_GAME_SERVER, SceneManager::OnCrossRegisterGameServer, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_REGISTER_GAME_SERVER_RET, SceneManager::OnCrossRegisterGameServerRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_HIDDEN_START_CROSS_REQ, SceneManager::OnCrossStartCrossReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_HIDDEN_SERVER_DISCONNECT, SceneManager::OnDisconnectOriginalServer, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_GAME_START_CROSS_ACK, SceneManager::OnCrossStartCrossAck, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_HIDDEN_KICK_USER, SceneManager::OnKickCrossUser, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_GAME_KICK_USER_ACK, SceneManager::OnKickCrossUserAck, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_GAME_SYNC_CROSS_USER, SceneManager::OnSyncCrossUser, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_GAME_USER_ENTERING_HIDDEN, SceneManager::OnUserEnteringHidden, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_HIDDEN_USER_ALLOWED_ENTER_HIDDEN, SceneManager::OnUserAllowedEnterHidden, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_GAME_TEAMMATE_JOIN_TEAM, SceneManager::OnCrossAllowedTeammateJoinTeam, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TEAM_MATCH_SUCC_JOIN_TEAM_REQ, SceneManager::OnUserCrossTeamMatchSuccJoinTeam, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_MESSAGE, SceneManager::OnHiddenRecvGameMessage, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_MESSAGE, SceneManager::OnGameRecvHiddenMessage, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_USER_START_CROSS_MATCH, SceneManager::OnUserStartCrossMatch, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_USER_STOP_CROSS_MATCH, SceneManager::OnUserStopCrossMatch, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_CROSS_TEAM_INFO, SceneManager::OnHiddenSyncCrossTeamInfoToGame, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_USER_SHELVE_INFO, SceneManager::OnOriginUserGetTradeMarketShelveInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_SEARCH_BY_ID, SceneManager::OnOriginUserSearchTradeMarketByItemID, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_SEARCH_BY_TYPE, SceneManager::OnOriginUserSearchTradeMarketByType, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_SEARCH_BY_BIG_TYPE, SceneManager::OnOriginUserSearchTradeMarketByBigType, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_SEARCH_BY_TYPE_WITH_LEVEL, SceneManager::OnOriginUserSearchTradeMarketByTypeWithLevel, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_SEARCH_MEDAL_BY_COLOR, SceneManager::OnOriginUserSearchTradeMarketMedalByColor, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_SEARCH_MEDAL_BY_SP_TYPE_AND_COLOR, SceneManager::OnOriginUserSearchTradeMarketMedalByEffectTypeAndColor, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_GET_TRANSACTION_RECORD, SceneManager::OnOriginUserGetTradeMarketTransactionRecord, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_GET_ROLE_TRADE_RECORD, SceneManager::OnOriginUserGetTradeMarketRoleTradeRecord, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_GET_ROLE_FOCUS_LIST, SceneManager::OnOriginUserGetTradeMarketRoleFocusList, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_GET_FOCUS_ITEM_INFO, SceneManager::OnOriginUserGetTradeMarketFocusItemInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_REMOVE_FOCUS_ITEM, SceneManager::OnOriginUserRemoveTradeMarketFocusItem, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_ADD_FOCUS_ITEM, SceneManager::OnOriginUserAddTradeMarketFocusItem, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_GET_MERCHANDISE_NUM, SceneManager::OnOriginUserGetTradeMarketMerchandiseNum, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_GET_SELLING_LIST, SceneManager::OnOriginUserGetSellingList, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_REQUEST_BUY, SceneManager::OnOriginUserTradeMarketRequestBuy, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TRADE_MARKET_REQUEST_BUY_RESP, SceneManager::OnOriginUserTradeMarketRequestBuyResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_REQUEST_BUY_CONFIRM, SceneManager::OnOriginUserTradeMarketRequestBuyConfirm, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TRADE_MARKET_REQUEST_BUY_CONFIRM_RESP, SceneManager::OnOriginUserTradeMarketRequestBuyConfirmResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TRADE_MARKET_REQUEST_BUY_CONFIRM_ERROR_RESP, SceneManager::OnOriginUserTradeMarketRequestBuyConfirmErrorResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_REQUEST_UPSHELVE, SceneManager::OnOriginUserTradeMarketRequestUpshelve, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TRADE_MARKET_REQUEST_UPSHELVE_RESP, SceneManager::OnOriginUserTradeMarketRequestUpshelveResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_OFFSHELVE_REQ, SceneManager::OnOriginUserTradeMarketOffshelveReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TRADE_MARKET_OFFSHELVE_RESP, SceneManager::OnOriginUserTradeMarketOffshelveResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_REDO_UPSHELVE_REQ, SceneManager::OnOriginUserTradeMarketRedoUpshelveReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TRADE_MARKET_REDO_UPSHELVE_RESP, SceneManager::OnOriginUserTradeMarketRedoUpshelveResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_CASH_OUT_REQ, SceneManager::OnOriginUserTradeMarketCashOutReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TRADE_MARKET_CASH_OUT_RESP, SceneManager::OnOriginUserTradeMarketCashOutResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_SEARCH_PET_FOR_QUICK_BUY, SceneManager::OnOriginUserSearchTradeMarketPetForQuickBuy, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_SEARCH_ADVERTISE_REQ, SceneManager::OnOriginUserSearchAdvertise, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_ADVERTISE_REQ, SceneManager::OnOriginUserTradeMarketAdvertiseReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TRADE_MARKET_ADVERTISE_RESP, SceneManager::OnOriginUserTradeMarketAdvertiseResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_ADVERTISE_CONFIRM_BOARDCAST, SceneManager::OnOriginUserTradeMarketAdvertiseConfirmBoardcast, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_USER_APPLY_JOIN_CROSS_TEAM, SceneManager::OnUserApplyJoinCrossTeam, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SEND_MAIL_TRANSFER, SceneManager::OnHiddenSendMailTransfer, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SEND_MAIL_TRANSFER_TO_ANOTHER_SERVER, SceneManager::OnGameSendMailTransferToAnotherServer, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_TO_GAME_ROLE_CHAT_TRANSFER, SceneManager::OnGameToGameRoleChatTransfer, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_RESPONSE_GUILD_LIST, SceneManager::OnGameSyncGuildListToHidden, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_REQUEST_GUILD_LIST, SceneManager::OnHiddenRequestGuildList, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SYNC_GUILD_MEMBER_CHANGE, SceneManager::OnGameSyncGuildMemberChangeToHidden, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_GUILD_MEMBER_CHANGE, SceneManager::OnHiddenSyncGuildMemberChangeToHidden, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SYNC_GUILD_CHANGE, SceneManager::OnGameSyncGuildChangeToHidden, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_ADD_TITLE_TO_GUILD_MEMBER, SceneManager::OnHiddenToGameAddTitleToGuildMember, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_REQ_SYNC_WORLD_STATUS, SceneManager::OnGameHiddenReqSyncWorldStatus, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SYNC_WORLD_STATUS, SceneManager::OnGameHiddenSyncWorldStatus, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_ACTIVITY_FORCE_TO_NEXT_STATE, SceneManager::OnHiddenGameActivityForceToNextState, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_REQ_SYNC_ACTIVITY_STATUS, SceneManager::OnGameHiddenReqSyncActivityStatus, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_ACTIVITY_STATUS, SceneManager::OnHiddenGameSyncActivityStatus, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_HUAN_JIE_ACTIVITY_STATUS, SceneManager::OnHiddenGameSyncHuanJieActivityStatus, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_CHIEF_ELECTION_REQ , SceneManager::OnGameHiddenChiefElectionReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_CHIEF_PEAK_BATTLE_REQ , SceneManager::OnGameHiddenChiefPeakBattleReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_HUAN_JIE_ZHAN_CHANG_REQ , SceneManager::OnGameHiddenHuanJieZhanChangReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_HUAN_JIE_ZHAN_CHANG_REQ_2 , SceneManager::OnGameHiddenHuanJieZhanChangReq2, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_BRAVE_GROUND_REQ , SceneManager::OnGameHiddenBraveGroundReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_USERCACHE_CHANGE_SYNC , SceneManager::OnGameHiddenUserCacheSync, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_USERCACHE_CHANGE_SYNC , SceneManager::OnHiddenGameUserCacheSync, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_CHANGE_GUILD_INFO , SceneManager::OnHiddenGameChangeGuildInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GUILD_HONOR_BATTLE_REQ_ROUTE , SceneManager::OnGameHiddenGuildHonorBattleReqRoute, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GUILD_HONOR_BATTLE_MATCH_RECORD_SYNC_INFO , SceneManager::OnHiddenGameGuildHonorBattleMatchRecordSyncInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_GAME_RA_INFO_RET , SceneManager::OnGameSyncActivityInfoFromCross, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_HIDDEN_RA_INFO_SYNC , SceneManager::OnHiddenSyncActivityInfoFromCross, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_CHAT_ITEM_INFO_REQ , SceneManager::OnHiddenGameChatItemInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_CHAT_ITEM_INFO_REQ , SceneManager::OnGameHiddenChatItemInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_CHAT_ITEM_INFO_SYN , SceneManager::OnGameHiddenChatItemInfoSyn, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_FORCE_GET_GOLD , SceneManager::OnGameHiddenForceGetGold, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_ADD_TITLE_TO_ROLE , SceneManager::OnHiddenToGameAddTitleToRole, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_ONLINE_STATUS_SYNC , SceneManager::OnGameHiddenOnlineStatusSync, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_OTHER_SERVER_ROLE_ONLINE_STATUS_SYNC , SceneManager::OnHiddenGameOtherServerRoleOnlineStatusSync, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_GAME_USER_MSG , SceneManager::OnCrossUserMsg, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_GAME_HIDDEN_NOT_CONNECTED , SceneManager::OnCrossGameHiddenNotConnected, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QUERY_REQ , SceneManager::OnGameHiddenQueryReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_CROSS_SEND_ALL_USER , SceneManager::OnCrossSendAllUser, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_NOTICE_LOG , SceneManager::OnHiddenGameNoticeLog, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_CHAT_GROUP , SceneManager::OnGameHiddenSendChatGroup, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_CHAT_GROUP , SceneManager::OnHiddenGameSendChatGroup, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_CHAT_REQ , SceneManager::OnGameHiddenChatGroupOpreta, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_CHAT_REQ , SceneManager::OnHiddenGameChatGroupOpreta, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TEMP_GROUP_BECOME_OFFICIAL_REQ , SceneManager::OnGameHiddenTempGroupBecomeOfficialReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TEMP_GROUP_BECOME_OFFICIAL_RESP , SceneManager::OnHiddenGameTempGroupBecomeOfficialResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_RA_TIANMING , SceneManager::OnGameHiddenRATianMing, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_RA_TIANMING , SceneManager::OnHiddenGameRATianMing, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_MAZER_ACER_REQ , SceneManager::OnGameHiddenMazerAcerReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_COMMON_INFO_NOTICE_HIDDEN , SceneManager::OnGameHiddenCommonInfoNoticeHidden, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_FIRST_KILL_INFO_REQ , SceneManager::OnHiddenGameFirstKillInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_FIRST_KILL_INFO_REQ , SceneManager::OnGameHiddenFirstKillInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_VIDEO_SIMPLE_INFO_REQ , SceneManager::OnHiddenGameVideoSimpleInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_VIDEO_SIMPLE_INFO_REQ , SceneManager::OnGameHiddenVideoSimpleInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_VIDEO_DETAIL_INFO_REQ , SceneManager::OnHiddenGameVideoDetailInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_VIDEO_DETAIL_INFO_RESP , SceneManager::OnGameHiddenVideoDetailInfoResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_VIDEO_DETAIL_INFO_REQ , SceneManager::OnGameHiddenVideoDetailInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_VIDEO_DETAIL_INFO_RESP , SceneManager::OnHiddenGameVideoDetailInfoResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GUILD_EVENTHANDLER_SEND , SceneManager::OnHiddenGameGuildEventhandlerSend, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SERVER_LOGIN_CHATGROUP_DATA_SYN , SceneManager::OnGameHiddenChatGroupSynHandlerSend, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SERVER_LOGIN_CHATGROUP_DATA_SYN , SceneManager::OnGameHiddenChatGroupSynHandlerSendRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_CHATGROUP_INFO_SYN , SceneManager::OnHiddenGameChatGroupSynHandlerSend, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_ONLY_FIGHT_SYN_INFO , SceneManager::OnHiddenGameOnlyFightSynInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_ONLY_FIGHT_SYN_INFO_REQ , SceneManager::OnGameHiddenOnlyFightSynInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_PLATFORM_BATTLE_REQ , SceneManager::OnGameHiddenReqPlatformBattleRoleInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_RET_PLATFORM_BATTLE_ROLE_INFO , SceneManager::OnHiddenGameRetPlatformBattleRoleInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_COURAGE_CHALLENGE_RANK_REQ , SceneManager::OnHiddenGameCourageChallengeRankReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_COURAGE_CHALLENGE_ROLE_CHANGE , SceneManager::OnHiddenGameCourageChallengRankRoleChange, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_LOG_QUICK , SceneManager::OnHiddenGameSyncLogQuick, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_LOG_TO_ORIGIN_SERVER , SceneManager::OnHiddenGameSyncLogToOriginServer, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GUILD_BOSS_CHAPTER_RANK_REQ , SceneManager::OnHiddenGameGuildBossChapterRankReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_PUBLIC_NOTICE_SYNC , SceneManager::OnGameHiddenSyncPublicNotice, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_ONLINE_INFO_SYNC , SceneManager::OnGameHiddenSyncOnlineInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_INVITE_JOIN_TEAM , SceneManager::OnHiddenGameInviteJoinTeam, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_INVITE_JOIN_TEAM_IN_ORIGIN , SceneManager::OnGameHiddenInviteJoinTeamInOrigin, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_REQ_JOIN_TEAM_INFO , SceneManager::OnGameHiddenReqJoinTeamInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_JOIN_TEAM_INFO_RET , SceneManager::OnHiddenGameJoinTeamInfoRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_INVITE_JOIN_TEAM_RET , SceneManager::OnGameHiddenInviteJoinTeamRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_INVITE_JOIN_TEAM_IN_ORIGIN_RET , SceneManager::OnHiddenGameInviteJoinTeamInOriginRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GUILD_GATHER_DREAM_PUBLISH_LIST_REQ , SceneManager::OnHiddenGameGuildGatherDreamPublishListReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GUILD_GATHER_DREAM_RECORD_LIST_REQ , SceneManager::OnHiddenGameGuildGatherDreamRecordListReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GUILD_GATHER_DREAM_PUBLISH_REQ , SceneManager::OnHiddenGameGuildGatherDreamPublishReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GUILD_GATHER_DREAM_PUBLISH_RET , SceneManager::OnGameHiddenGuildGatherDreamPublishRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GUILD_GATHER_DREAM_GIFT_REQ , SceneManager::OnHiddenGameGuildGatherDreamGiftReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GUILD_GATHER_DREAM_GIFT_RET , SceneManager::OnGameHiddenGuildGatherDreamGiftRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GUILD_GATHER_DREAM_GIFT_ADD_RECORD , SceneManager::OnHiddenGameGuildGatherDreamGiftAddRecord, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GUILD_GATHER_DREAM_FETCH_REQ , SceneManager::OnHiddenGameGuildGatherDreamFetchReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GUILD_GATHER_DREAM_FETCH_RET , SceneManager::OnGameHiddenGuildGatherDreamFetchRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GUILD_GATHER_DREAM_FETCH_CHANGE , SceneManager::OnHiddenGameGuildGatherDreamFetchChange, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SYSTEM_MAIL_SYNC , SceneManager::OnGameHiddenSystemMailSend, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYSTEM_MAIL_SYNC , SceneManager::OnHiddenGameSystemMailSend, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_HUAN_JIE_ROLE_INFO , SceneManager::OnHiddenGameSyncHuanJieRoleInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GUILD_GATHER_DREAM_ROLE_INFO_CHANGE , SceneManager::OnHiddenGameGuildGatherDreamRoleInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_HUAN_JIE_SYNC_TIAN_TI_RECORD , SceneManager::OnHiddenGameHuanJieSyncTianTiRecord, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SYNC_TIAN_TI_RECORD_ACK , SceneManager::OnHiddenGameHuanJieSyncTianTiRecordAck, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GUILD_CHAT , SceneManager::OnHiddenGameSyncGuildChat, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GUILD_CHAT , SceneManager::OnGameHiddenSyncGuildChat, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SENSITIVE_WORDS_RELOAD , SceneManager::OnGameHiddenNoticeSensitiveWordsReload, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_CMD_KICK_ROLE , SceneManager::OnGameHiddenCmdKickRole, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_CMD_MUTE_ROLE , SceneManager::OnGameHiddenCmdMuteRole, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_CMD_MUTE_ROLE , SceneManager::OnHiddenGameCmdMuteRole, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_CMD_NOTICE_NEW_MESSAGE , SceneManager::OnGameHiddenCmdNoticeNewMessage, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_CMD_NOTICE_NEW_MESSAGE , SceneManager::OnHiddenGameCmdNoticeNewMessage, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_CONSUME_CAROUSEL_ADD_RECORD , SceneManager::OnGameHiddenSyncConsumeCarouselNewRecord, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_CONSUME_CAROUSEL_ADD_RECORD , SceneManager::OnHiddenGameSyncConsumeCarouselNewRecord, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_RESET_PUBLIC_NOTICE , SceneManager::OnGameHiddenCmdResetPublicNotice, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_PLAT_INCROSS_ROLE_NUM , SceneManager::OnHiddenGameSyncPlatInCrossRoleNum, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_ROLE_INFO_CHANGE , SceneManager::OnHiddenGameRoleInfoChange, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_PET_INFO_CHANGE , SceneManager::OnHiddenGamePetInfoChange, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_ROLE_ACTIVE_CHANGE , SceneManager::OnCrossGameRoleActiveChange, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GUILD_ACTIVE_INFO_CHANGE , SceneManager::OnGameHiddenGuildActiveInfoChange, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_GAME_SYNC_GUILD_RANK_REWARD_RANK_INFO , SceneManager::OnCrossGameSyncGuildRankRewardRankInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GM_CROSS_GAME_GUILD_ACTIVE_TEST , SceneManager::OnGmCrossGameGuildActiveTest, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_ROLE_ACTIVE_GIFT_INFO , SceneManager::OnHiddenGameRoleActiveGiftInfo, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_WORLD_BOSS_INFO , SceneManager::OnHiddenGameWorldBossInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_WORLD_BOSS2_INFO , SceneManager::OnHiddenGameWorldBoss2Info, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_WORLD_BOSS3_INFO, SceneManager::OnHiddenGameWorldBoss3Info, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_WORLD_BOSS_SYNC_RANK_RESULT_MSG, SceneManager::OnHiddenGameWorldBossSyncRankResultMsg, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_WORLD_BOSS_2_SYNC_RANK_RESULT_MSG , SceneManager::OnHiddenGameWorldBoss2SyncRankResultMsg, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_WORLD_BOSS_3_SYNC_RANK_RESULT_MSG, SceneManager::OnHiddenGameWorldBoss3SyncRankResultMsg, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_WORLD_BOSS_SYNC_PARTICIPATE_UID_LIST , SceneManager::OnHiddenGameWorldBossSyncParticipateUidList, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_WORLD_BOSS_2_SYNC_PARTICIPATE_UID_LIST , SceneManager::OnHiddenGameWorldBoss2SyncParticipateUidList, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_WORLD_BOSS_3_SYNC_PARTICIPATE_UID_LIST, SceneManager::OnHiddenGameWorldBoss3SyncParticipateUidList, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_REQEST_QUANMIN_ACTIVITY_INFO, SceneManager::OnHiddenGameQuanMinActivityInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_RESPONSE_QUANMIN_ACTIVITY_INFO , SceneManager::OnGameHiddenQuanMinActivityInfoResp, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_WILD_BOSS_INFO_REQ , SceneManager::OnGameHiddenWildBossInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_BRAVE_GROUND_INFO , SceneManager::OnHiddenGameSyncBraveGroundInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_FIRST_KILL_REQ , SceneManager::OnGameHiddenFirstKillReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_ROLE_RETURN_ORIGIN_SERVER_REQ , SceneManager::OnHiddenGameRoleReturnOriginServerReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_ROLE_RETURN_ORIGIN_SERVER_ACK , SceneManager::OnGameHiddenRoleReturnOriginServerAck, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TEAMMATE_JOIN_ORIGIN_SERVER_TEAM , SceneManager::OnGameHiddenTeammateJoinOriginServerTeam, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TEST_NETWORK , SceneManager::OnGameHiddenTestNetwork, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_BRAVE_GROUND_SET_INFO , SceneManager::OnGameHiddenBraveGroundSetInfo, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SPECIAL_LOGIC_ACTIVITY_INFO_SYNC , SceneManager::OnHiddenGameSpecialLogicActivityInfoSync, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GET_RANK_LIST_REQ , SceneManager::OnHiddenGameGetRankListReq, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_HISTORY_TOP_PRICE_REQ , SceneManager::OnGameHiddenTradeMarketHistoryTopPriceReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SHEN_SHOU_JIANG_LIN_REQ , SceneManager::OnHiddenGameShenShouJiangLinReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SHEN_SHOU_JIANG_LIN_DRAW_RET , SceneManager::OnGameHiddenShenShouJiangLinDrawRet, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_HEART_BEAT , SceneManager::OnHiddenGameHeartBeat, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_ROLE_LOGIN_SEND_CROSS_CHAT_GROUP_SIMPLE_INFO , SceneManager::OnGameRoleLoginSendCrossChatGroupSimpleInfoReq, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_DELETE_MUTE_PLAYER_CHAT_RECORD , SceneManager::OnGameHiddenDeleteMutePlayerChatRecord, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_MARKET_SALE_ITEM_EVENTHANDLER , SceneManager::OnGameHiddenTradeMarketSaleItemEvenhandler, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDEEN_GAME_TRADE_MARKET_SALE_ITEM_EVENTHANDLER , SceneManager::OnHiddenGameTradeMarketSaleItemEvenhandler, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRADE_CREDIT_ADD_CREDIT_EVENTHANDLER , SceneManager::OnGameHiddenAddCredit, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_COLOSSEUM_REQ_ROUTER , SceneManager::OnHiddenGameRoleColosseumReqRouter, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_CHAT_GROUP_LEADERSHIP_HANDOVER , SceneManager::OnGameHiddenChatGroupHandoverLeadership, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SHAN_HAI_BOSS_INFO_REQ , SceneManager::OnGameHiddenShanHaiBossInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_ROLE_INFO_NOTICE_REQ_ROUTE , SceneManager::OnGameHiddenRoleInfoNoticeReqRoute, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_RELIC_LOOTING_REQ , SceneManager::OnGameHiddenRelicLootingReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_RELIC_LOOTING_REQ , SceneManager::OnHiddenGameRelicLootingReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SYNC_CLOUD_ARENA_USER_DATA_REQ , SceneManager::OnGameHiddenSyncCloudArenaUserDataReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_CLOUD_ARENA_USER_DATA_RESP , SceneManager::OnHiddenGameSyncCloudArenaUserDataResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_CLOUD_ARENA_REAL_TIME_INFO_REQ , SceneManager::OnGameHiddenCloudArenaRealTimeInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_ROLE_LOGIN_CLOUD_ARENA_USER_INFO_REQ , SceneManager::OnGameHiddenRoleLoginCloudArenaUserInfoReq, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_MARKET_BUY_ITEM_RECORD_SYN_REQ , SceneManager::OnGameHiddenMarketBuyItemRecordSynReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_MARKET_BUY_ITEM_RECORD_SYN_REQ , SceneManager::OnHiddenGameMarketBuyItemRecordSynReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_MARKET_ALL_TRANSACTION_RECORD_SYN_REQ , SceneManager::OnGameHiddenMarketAllTransactionRecordSynReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_MARKET_ALL_TRANSACTION_RECORD_SYN_REQ , SceneManager::OnHiddenGameMarketAllTransactionRecordSynReq, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_VIDEO_CHANGE_REQ , SceneManager::OnGameHiddenVideoChangeReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_VIDEO_CHANGE_RET , SceneManager::OnHiddenGameVideoChangeReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_GAME_CHIVALROUS_RANK_LIST_RESP , SceneManager::OnCrossGameChivalrousRankListResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_CLOUD_ARENA_SEASON_INFO , SceneManager::OnHiddenGameSyncCloudArenaSeasonInfo, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_PERSON_RANK_FRIEND_REQ , SceneManager::OnHiddenGamePersonRankFriendReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SYNC_HONG_BAO_INFO , SceneManager::OnGameHiddenSyncHongBaoInfo, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_HONG_BAO_REQ_GIVE , SceneManager::OnHiddenGameSyncHongBaoReqGive, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SYNC_HONG_BAO_REQ_GIVE_RET , SceneManager::OnGameHiddenSyncHongBaoReqGiveRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_HONG_BAO_REQ_GET , SceneManager::OnHiddenGameSyncHongBaoReqGet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SYNC_HONG_BAO_REQ_GET_RET , SceneManager::OnGameHiddenSyncHongBaoReqGetRet, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_HONG_BAO_REQ_ERROR , SceneManager::OnHiddenGameSyncHongBaoReqError, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_BIG_DIPPER_SYNC_RET , SceneManager::OnHiddenGameBigDipperSyncRet, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GIVE_GIFT_REQ , SceneManager::OnGameHiddenGiveGiftReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GIVE_GIFT_ADD_GIFT , SceneManager::OnGameHiddenGiveGiftAddGift, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GIVE_GIFT_INFO_RET , SceneManager::OnHiddenGameGiveGiftRetInfo, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_HUNDRED_GHOST_BOSS_INFO_REQ , SceneManager::OnGameHiddenHundredGhostBossInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_CONTINUE_CROSS_BATTLE , SceneManager::OnHiddenGameContinueRoleBattleOnCross, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_CROSS_DATA , SceneManager::OnHiddenGameSyncCrossData, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_COW_REPORT_GOOD_NEWS_CHECK_CAN_BUY, SceneManager::OnHiddenGameCowReportGoodNewsCanBuy, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_COW_REPORT_GOOD_NEWS_CHECK_CAN_BUY_ACK, SceneManager::OnGameHiddenCowReportGoodNewsCanBuyAck, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_COW_REPORT_GOOD_NEWS_BUY_ITEM, SceneManager::OnHiddenGameCowReportGoodNewsBuy, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_COW_REPORT_GOOD_NEWS_BUY_ITEM_ACK, SceneManager::OnGameHiddenCowReportGoodNewsBuyAck, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_SYNC_COW_REPORT_GOOD_NEWS_BUY_ITEM_OFFLINE_EVENT, SceneManager::OnSyncCowReportGoodNewsBuyOfflineEvent, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_COW_REPORT_GOOD_NEWS_GET_INFO, SceneManager::OnHiddenGameCowReportGoodNewsGetInfo, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TIGER_BRINGS_BLESSING_CHECK_CAN_BUY, SceneManager::OnHiddenGameTigerBringsBlessingCanBuy, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TIGER_BRINGS_BLESSING_CHECK_CAN_BUY_ACK, SceneManager::OnGameHiddenTigerBringsBlessingCanBuyAck, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TIGER_BRINGS_BLESSING_BUY_ITEM, SceneManager::OnHiddenGameTigerBringsBlessingBuy, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TIGER_BRINGS_BLESSING_BUY_ITEM_ACK, SceneManager::OnGameHiddenTigerBringsBlessingBuyAck, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_SYNC_TIGER_BRINGS_BLESSING_BUY_ITEM_OFFLINE_EVENT, SceneManager::OnSyncTigerBringsBlessingBuyOfflineEvent, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TIGER_BRINGS_BLESSING_GET_INFO, SceneManager::OnHiddenGameTigerBringsBlessingGetInfo, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_CREAT_AUTO_ROBOT_INFO , SceneManager::OnGameHiddenCreatAutoRobotInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TIAN_DI_DAO_HEN_SYNC_INFO , SceneManager::OnHiddenGameTianDiDaoHenSyncInfo, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SYN_COLOSSENUM_RANK_INFO , SceneManager::OnGameHiddenColosseumRankInfoSyn, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_SYNC_FRIEND_INTIMACY_INFO , SceneManager::OnSyncFriendIntimacyInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_ADD_INTIMACY_REQ , SceneManager::OnGameHiddenAddIntimacyReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_INTIMACY_RELATION_REQ , SceneManager::OnGameHiddenIntimacyRelationReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_INTIMACY_SINGLE_CHAT_TIMES , SceneManager::OnGameHiddenIntimacySingleChatTimes, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GIVE_FLOWER_NOTICE , SceneManager::OnGameHiddenGiveFlowerNotice, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GIVE_FLOWER_NOTICE , SceneManager::OnHiddenGameGiveFlowerNotice, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GIVE_FLOWER_BACK_KISS , SceneManager::OnGameHiddenGiveFlowerBackKiss, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GIVE_FLOWER_BACK_KISS , SceneManager::OnHiddenGameGiveFlowerBackKiss, function_add_set);
	
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_ACTIVITY_END_INFO , SceneManager::OnHiddenGameActivityEndInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SERVER_COURSE_INFO_REQ , SceneManager::OnHiddenGameServerCourseInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SERVER_COURSE_CHANGE_REQ , SceneManager::OnHiddenGameServerCourseChangeReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_ROLE_WIN_CHIEF_ELECTION_SYN , SceneManager::OnHiddenGameRoleWinChiefElectionSyn, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_JIE_YI_ZU_CREATE , SceneManager::OnGameHiddenJieYiZuCreate, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_JIE_YI_ZU_INFO_SYNC , SceneManager::OnHiddenGameJieYiZuSync, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_JIE_YI_ZU_DISMISS , SceneManager::OnHiddenGameJieYiZuDismiss, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_JIE_YI_ZU_NAME , SceneManager::OnGameHiddenJieYiZuName, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_JIE_YI_ZU_MEMBER_NAME , SceneManager::OnGameHiddenJieYiZuMemberName, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_JIE_YI_ZU_TEXT , SceneManager::OnGameHiddenJieYiZuText, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_JIE_YI_ZU_LEAVE , SceneManager::OnGameHiddenJieYiZuLeave, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_JIE_YI_ZU_KICK , SceneManager::OnGameHiddenJieYiZuKick, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_JIE_YI_ZU_TAN_HE, SceneManager::OnGameHiddenJieYiZuTanHe, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_JIE_YI_ZU_TAN_HE_VOTE, SceneManager::OnGameHiddenJieYiZuTanHeVote, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_JIE_YI_ZU_INVITE_REPLY , SceneManager::OnGameHiddenJieYiZuInviteReply, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_JIE_YI_ZU_ROLE_XUAN_YAN, SceneManager::OnGameHiddenJieYiRoleXuanYan, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_JIE_YI_ZU_XUAN_YAN, SceneManager::OnGameHiddenJieYiZuXuanYan, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_JIE_YI_XUAN_YAN_LIST, SceneManager::OnGameHiddenJieYiXuanYanList, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_JIE_YI_SYNC_ROLE_DATA, SceneManager::OnHiddenGameJieYiZuSyncRoleData, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_JIE_YI_ROLE_CHANGE, SceneManager::OnHiddenGameJieYiZuRoleChange, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QING_YUAN_CREATE, SceneManager::OnGameHiddenQingYuanCreate, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_QING_YUAN_DISMISS, SceneManager::OnHiddenGameQingYuanDismiss, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QING_YUAN_LEAVE, SceneManager::OnGameHiddenQingYuanLeave, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QING_YUAN_SINGLE_LEAVE, SceneManager::OnGameHiddenQingYuanSingleLeave, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QING_YUAN_FORCE_LEAVE, SceneManager::OnGameHiddenQingYuanForceLeave, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QING_YUAN_CANCEL_LEAVE, SceneManager::OnGameHiddenQingYuanCancelLeave, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_QING_YUAN_INFO_SYNC, SceneManager::OnHiddenGameQingYuanSync, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QING_YUAN_GIFT_GiVE, SceneManager::OnGameHiddenQingYuanGiftGave, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QING_YUAN_GIFT_FETCH_REWARD, SceneManager::OnGameHiddenQingYuanGiftFetchReward, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_QING_YUAN_GIFT_FETCH_REWARD_RET, SceneManager::OnHiddenGameQingYuanGiftFetchRewardRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QING_YUAN_GIFT_FETCH_DAY_REWARD, SceneManager::OnGameHiddenQingYuanGiftFetchDayReward, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_QING_YUAN_GIFT_FETCH_DAY_REWARD_RET, SceneManager::OnHiddenGameQingYuanGiftFetchDayRewardRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QING_YUAN_SET_SKILL_FLAG, SceneManager::OnGameHiddenQingYuanSetSkillFlag, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_HIDDEN_ENDLESS_RANK_REWARD_RET, SceneManager::OnCrossHiddenCrossPersonRankEndlessRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_ROLE_BATTLE_DATA, SceneManager::OnHiddenGameSyncRoleBattleData, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GIVE_FLOWER_CHANGE, SceneManager::OnGameHiddenGiveFlowerChange, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GIVE_FLOWER_CHANGE, SceneManager::OnHiddenGameGiveFlowerChange, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_HORCRUX_TIAN_CHENG_REQ, SceneManager::OnHiddenGameHorcruxTianChengReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_HORCRUX_TIAN_CHENG_DRAW_RET, SceneManager::OnGameHiddenHorcruxTianChengDrawRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QUERY_ITEM_RECOMMEND_PRICE, SceneManager::OnGameHiddenQueryItemRecommendPrice, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_QUERY_TARGET_GLADIATOR_BEFORE_FIGHT_REQ, SceneManager::OnHiddenGameQueryTargetGladiatorBeforeFightReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QUERY_TARGET_GLADIATOR_BEFORE_FIGHT_RESP, SceneManager::OnGameHiddenQueryTargetGladiatorBeforeFightResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_COLOSSEUM_SYS_REPORT, SceneManager::OnHiddenGameColosseumSysReport, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_COLOSSEUM_SYNC_NEW_RANK_AFTER_SYS_REPORT, SceneManager::OnGameHiddenColosseumSyncNewRankAfterSysReport, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_JIXING_GAOZHAO_REQ, SceneManager::OnHiddenGameJiXingGaoZhaoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_JIXING_GAOZHAO_DRAW_RET, SceneManager::OnGameHiddenJiXingGaoZhaoDrawRet, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GET_FRIEND_INFO, SceneManager::OnSyncGameHiddenGetFriendInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_FRIEND_LIST_TO_ROLE, SceneManager::OnHiddenGameFriendListToRole, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_FRIEND_ASK_LIST_CHANGE, SceneManager::OnHiddenGameFrinedAskListChange, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_ADD_FRIEND_REQ, SceneManager::OnGameHiddenAddFriendReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_ROLE_REQ_RET, SceneManager::OnHiddenGameSyncRoleReqRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_ADD_FRIEND_REPLY_REQ, SceneManager::OnGameHiddenAddFriendReplyReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_REMOVE_FRIEND_REQ, SceneManager::OnGameHiddenRemoveFriendReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_ADD_BLACK_REQ, SceneManager::OnGameHiddenAddBlackReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_BLACK_LIST, SceneManager::OnHiddenGameBlackList, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_BLACK_LIST_CHANGE, SceneManager::OnHiddenGameBlackListChange, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_REMOVE_BLACK_REQ, SceneManager::OnGameHiddenRemoveBlackReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_FRIEND_GROUP_REQ, SceneManager::OnGameHiddenFriendGroupReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_ASK_LIST_TO_ROLE, SceneManager::OnHiddenGameAskListToRole, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_RECENTLY_REQ, SceneManager::OnGameHiddenRecentlyReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_RECENTLY_INFO, SceneManager::OnHiddenGameRecentlyInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_FRIEND_CHANGE_TO_ROLE, SceneManager::OnHiddenGameFriendChangeToRole, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_ROLE_LOGIN_LOGOUT_FRIENDS_NOTIFY, SceneManager::OnGameHiddenRoleLoginLogoutFriendsNotify, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_SYNC_FRIEND_INFO, SceneManager::OnSyncFriendInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_SYNC_ADD_FRINED_OFFLINE_EVENT, SceneManager::OnSyncAddFriendOfflienEvent, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_SYNC_BLACK_INFO, SceneManager::OnSyncBlackInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QUERY_IF_SYNC_GUILD_SUCCEED, SceneManager::OnGameQueryHiddenIfGuildSyncSucceed, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_GUILD_SUCC_NOTICE, SceneManager::OnHiddenNoticeGameSyncGuildSucc, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_GAME_DATA_SYNC_CHECK_ACK, SceneManager::OnCrossGameDataSycnCheckAck, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SYNC_SPECIAL_INFO_REQ, SceneManager::OnGameHiddenSyncSpecialInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_SPECIAL_INFO_RET, SceneManager::OnHiddenGameSyncSpecialInfoRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_HIDDEN_FALLEN_GOD_RANK_REWARD_RET, SceneManager::OnCrossHiddenCrossPersonRankFallenGodRet, function_add_set);


	CROSS_MESSAGE_HANDLER_REGISTER(MT_G_H_WEDDING_ROLE_REQ, SceneManager::OnGameHiddenWeddingRoleReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_H_G_WEDDING_INFO_SYNC, SceneManager::OnHiddenGameWeddingInfoSync, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QING_YUAN_COMMON_DATA, SceneManager::OnGameHiddenQingYuanCommonData, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QING_YUAN_LEICHONG_ADD_CHONGZHI, SceneManager::OnGameHiddenQingYuanLeiChongAddChongZhi, function_add_set);
	
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_WORLD_ARENA_OPER_TRANSFER, SceneManager::OnGameHiddenWorldArenaUserOperate, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_WORLD_ARENA_SIGNUP, SceneManager::OnGameHiddenWorldArenaSignup, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_WORLD_ARENA_GIVE_WIN_BOX_REWARD, SceneManager::OnHiddenGameWorldArenaGiveWinBoxReward, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_WORLD_ARENA_GIVE_SIGNUP_REWARD, SceneManager::OnHiddenGameWorldArenaGiveSignupReward, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_WORLD_ARENA_GIVE_DAILY_REWARD, SceneManager::OnHiddenGameWorldArenaGiveDailyReward, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_WORLD_ARENA_UPDATE_SIGNUP_INFO, SceneManager::OnGameHiddenWorldArenaUpdateSignupInfo, function_add_set);
	
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_GAME_WORLD_TEAM_ARENA_QUERY_RANK_RET, SceneManager::OnCrossGameWorldTeamArenaQueryRankRet, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_ROLE_INFO_CHANGE_WORLD_TEAM_ARENA_SYN, SceneManager::OnGameHiddenRoleInfoChangeWorldTeamArenaSyn, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_WORLD_TEAM_ARENA_SYN_ROLE_TITLE_INFO, SceneManager::OnHiddenGameWorldTeamArenaSynRoleTitleInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_WORLD_TEAM_ARENA_SYN_ACTIVITY_INFO, SceneManager::OnHiddenGameWorldTeamArenaSynActivityInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_WORLD_TEAM_ARENA_ACITIVITY_INFO_SYN_REQ, SceneManager::OnGameHiddenWorldTeamArenaActivityInfoSynReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_WORLD_TEAM_ARENA_FINALLY_RANK_REQ, SceneManager::OnGameHiddenWorldTeamArenaFinallyRankReq, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_ROLE_QI_FU_CHANGE, SceneManager::OnHiddenGameRoleQiFuChange, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_ROLE_QI_FU_CHANGE, SceneManager::OnGameHiddenRoleQiFuChange, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SYN_LEVEL_COMPLEMENT_INFO, SceneManager::OnGameHiddenSynLevelComplement, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QINGYUAN_DUIDUIPENG_UPDATA_RANK, SceneManager::OnGameHiddenQingYuanDuiDuiPengUpDataRankInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QINGYUAN_DUIDUIPENG_RANK_REQ, SceneManager::OnGameHiddenQingYuanDuiDuiPengRankReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_QINGYUAN_DUIDUIPENG_RANK_INFO, SceneManager::OnHiddenGameQingYuanDuiDuiPengRankInfo, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SYNC_HIDDEN_OPEN_SERVER_TIME, SceneManager::OnHiddenGameSyncHiddenOpenServerTime, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GUILD_SPEED_UP_INFO, SceneManager::GameHiddenGuildSpeedUpInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GUILD_SPEED_UP_INFO, SceneManager::HiddenGameGuildSpeedUpInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GUILD_SYN_BUILD_ALL_INFO, SceneManager::HiddenGameGuildSynBuildAllInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_SYNC_GUILD_BUILDING_NOTIFY_INFO, SceneManager::OnSyncGuildBuildingNotifyInfo, function_add_set);


	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GET_UTA_CHAMPION_RECORD, SceneManager::OnGameHiddenGetUTAChampionRecord, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_TRANSFER_MSG_TO_BIGCROSS, SceneManager::OnGameHiddenTransferMsgToBigCross, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GIVE_LOTTERY_TO_ROLE, SceneManager::OnHiddenGameGiveLotteryToRole, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_UTA_GIVE_ITEMS_TO_USER, SceneManager::OnHiddenGameUTAGiveUserItems, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_UTA_SYNC_BASE_INFO, SceneManager::OnHiddenGameUTASyncBaseInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_UTA_SYNC_SCHEDULES, SceneManager::OnHiddenGameUTASyncSchedules, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_USER_REQUEST_BIGCROSS_VIDEO, SceneManager::OnGameHiddenUserRequestBigcrossVideo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TRANSFER_BIGCROSS_MSG_TO_ORIGIN, SceneManager::OnHiddenGameTransferBigCrossMsgToOrigin, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_USER_LOGIN_IN_ORIGIN, SceneManager::OnGameHiddenUserLoginInOrigin, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QUERY_WORLD_TEAM_ARENA_OTHER_INFO, SceneManager::OnGameHiddenQueryWorldTeamArenaOtherInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_UTA_GIVE_SERVER_ITEMS, SceneManager::OnHiddenGameUTAGiveServerItems, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GOD_BEAST_ADVENT_BUY_SERVER_LIMIT_ITEM_REQ, SceneManager::OnGameHiddenGodBeastAdventBuyReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GOD_BEAST_ADVENT_BUY_SERVER_LIMIT_ITEM_INFO, SceneManager::OnHiddenGameGodBeastAdventBuyInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_GOD_BEAST_ADVENT_BUY_NUM_INFO, SceneManager::OnHiddenGameGodBeastAdventNumInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_GOD_BEAST_ADVENT_RECEIVE_TRADE_MARKET_REQ, SceneManager::OnGameHiddenGodBeastAdventReceiveTradeMarketReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_HIDDEN_UTA_QUERY_TEAM_MEMBER_RANK_RESP, SceneManager::OnCrossHiddenUTAQueryTeamMemberRankResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_HONGMENG_TIANJIE_REQ, SceneManager::OnGameHiddenHongMengTianJieReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SERVER_COMPETITION_RANK_REQ, SceneManager::OnHiddenGameServerCompetitionRankReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SERVER_COMPETITION_RANK_RESP, SceneManager::OnGameHiddenServerCompetitionRankResp, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SALTY_SWEET_BATTLE_CHANGE_REQ, SceneManager::OnGameHiddenSaltySweetChangeDataResp, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_SALTY_SWEET_BATTLE_VOTE_REQ, SceneManager::OnHiddenGameSaltySweetVoteReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_TEAM_ROLE_RECRUIT_SYNC, SceneManager::OnHiddenGameSyncTeamRoleRecruit, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SYNC_PET_TOP_RANK_LIST, SceneManager::OnGameHiddenSyncPetTopRankInfo, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SYNC_PARTNER_TOP_RANK_LIST, SceneManager::OnGameHiddenSyncPartnerTopRankInfo, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_HIDDEN_MEILI_RANK_REWARD_RET, SceneManager::OnCrossHiddenMeiLiRankResp, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_FRIEND_INITIMACY_ADD, SceneManager::OnHiddenGameAddIntimacyValue, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_FRIEND_INITIMACY_ADD, SceneManager::OnGameHiddenAddIntimacyValue, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_QUERY_ORIGIN_SERVER_RA_STATUS, SceneManager::OnHiddenGameQueryOriginServerRAStatus, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SEND_ORIGIN_SERVER_RA_STATUS, SceneManager::OnGameHiddenSendOriginServerRAStatus, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_CLEAN_QUERY_INFO, SceneManager::OnHiddenGameCleanQuery, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_CLEAN_QUERY_INFO, SceneManager::OnGameHiddenCleanQuery, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_CMD_TO_ROLE, SceneManager::OnGameHiddenCmdToRole, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_CMD_TO_ROLE, SceneManager::OnHiddenGameCmdToRole, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_QUERY_OFFLINE_BATTLE_DATA_FOR_ROBOT, SceneManager::OnGameHiddenQueryOfflineBattleDataForRobot, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_QUERY_OFFLINE_BATTLE_DATA_FOR_ROBOT, SceneManager::OnHiddenGameQueryOfflineBattleDataForRobot, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_NOTIFY_OFFLINE_BATTLE_DATA_FOR_ROBOT_RESULT, SceneManager::OnGameHiddenNotifyOfflineBattleDataForRobotResult, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_REAL_ROLE_ROBOT_LEAVE_TEAM_NOTICE, SceneManager::OnGameHiddenRealRoleRobotLeaveTeamNotice, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_SYNC_OFFLINE_BATTLE_DATA, SceneManager::OnGameHiddenSyncOfflineBattleData, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_QUERY_BATTLE_DATA_FOR_OFFLINE_BATTLE_DATA_SYSTEM, SceneManager::OnHiddenGameQueryBattleDataForOfflineBattleDataSystem, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_REQ_SYN_KUA_FU_YING_XIONG_LU_DATA, SceneManager::OnGameHiddenReqSynKuaFuYingXiongLuData, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_RET_SYN_KUA_FU_YING_XIONG_LU_DATA, SceneManager::OnHiddenGameRetSynKuaFuYingXiongLuData, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_CROSS_HIDDEN_RET_KUA_FU_YING_XIONG_LU_RANK_END, SceneManager::OnCrossHiddenRetKuaFuYingXiongLuRankEnd, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_ADD_SINGLE_CHAT_RECORD, SceneManager::OnHiddenGameAddSingleChatRecord, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_USER_QUERY_CHAT_RECORD, SceneManager::OnHiddenGameUserQueryChatRecord, function_add_set);

	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_HUAN_SHOU_ANN_INFO_REQ, SceneManager::OnGameHiddenHuanShouAnnInfoReq, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_GAME_HIDDEN_HUAN_SHOU_ANN_INFO_SYNC, SceneManager::OnGameHiddenHuanShouAnnInfoSync, function_add_set);
	CROSS_MESSAGE_HANDLER_REGISTER(MT_HIDDEN_GAME_HUAN_SHOU_ANN_INFO_SYNC, SceneManager::OnHiddenGameHuanShouAnnInfoSync, function_add_set);
}

void SceneManager::OnCrossHello(const char *data, int length)
{
	crossgameprotocal::CrossGameHello* hello = (crossgameprotocal::CrossGameHello*)data;
	CrossManager::Instance().OnCrossHello(hello->is_cross_connected_hidden > 0);
}

void SceneManager::OnCrossRegisterGameServer(const char* data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	crossgameprotocal::CrossHiddenRegisterGameServer* msg = (crossgameprotocal::CrossHiddenRegisterGameServer*)data;

	if (length < sizeof(crossgameprotocal::CrossHiddenRegisterGameServer) - sizeof(msg->server_id_list))
	{
		return; // 
	}

	msg->data_access_ip[sizeof(msg->data_access_ip) - 1] = 0;

	static crossgameprotocal::CrossHiddenRegisterGameServer chrgs;
	chrgs.plat_type = msg->plat_type;
	memcpy(chrgs.data_access_ip, msg->data_access_ip, sizeof(chrgs.data_access_ip));
	chrgs.data_access_port = msg->data_access_port;
	memcpy(chrgs.gateway_hostname, msg->gateway_hostname, sizeof(chrgs.gateway_hostname));
	chrgs.gateway_port = msg->gateway_port;
	chrgs.server_open_timestamp = msg->server_open_timestamp;
	chrgs.count = 0;

	int offset = sizeof(crossgameprotocal::CrossHiddenRegisterGameServer) - sizeof(msg->server_id_list);
	for (int i = 0; i < msg->count; ++i)
	{
		if (length < offset + static_cast<int>(sizeof(msg->server_id_list[i])))
		{
			break;
		}

		offset += sizeof(msg->server_id_list[i]);

		chrgs.server_id_list[chrgs.count++] = msg->server_id_list[i];
	}

	if (chrgs.count <= 0) return;

	int mother_server_id = chrgs.server_id_list[0];
	UniqueServerID usid(chrgs.plat_type, mother_server_id);
	//  plat_type
	int register_ret = crossgameprotocal::SUCC;
	if (sizeof(RoleOtherInitParam) != msg->role_other_init_param_length)
	{
		gamelog::g_log_world.printf(LL_CRITICAL, "SceneManager::OnCrossRegisterGameServer other init param length not equal, this:[length:%d] from:[origin_server_id:%d length:%lld]",
			(int)sizeof(RoleOtherInitParam), mother_server_id, msg->role_other_init_param_length);
		register_ret = crossgameprotocal::ROLE_OTHER_INIT_PARAM_ERROR;
	}
#ifndef _DEBUG 
	int this_plat_type = LocalConfig::Instance().GetPlatType();
	if (this_plat_type != chrgs.plat_type)
	{
		gamelog::g_log_world.printf(LL_CRITICAL, "SceneManager::OnCrossRegisterGameServer plat_type not equal, this:[plat_type:%d] from:[plat_type:%d, origin_server_id:%d]",
			this_plat_type, chrgs.plat_type, mother_server_id);
		register_ret = crossgameprotocal::PLAT_TYPE_ERROR;
		//assert(0);
	}
#endif

	crossgameprotocal::HiddenGameRegisterGameServerRet hgrgsr;
	hgrgsr.ret = static_cast<short>(register_ret);
	hgrgsr.cross_open_server_tamp = SHAREDCONFIG->GetOpenServerConfig().GetOpenServerZeroTime();
	hgrgsr.cross_old_server_open_tamp = msg->old_server_open_timestamp;
	hgrgsr.cross_lun_hui_wang_chuan_refresh_tamp = WorldStatus::Instance().GetLunHuiWangChuanRefreshTamp();
	hgrgsr.hidden_server_idx = CrossConfig::Instance().GetHiddenServerIDX();
	hgrgsr.gateway_num = 0;

	CrossManager::Instance().OnCrossOpenTamp(SHAREDCONFIG->GetOpenServerConfig().GetOpenServerZeroTime());
	CrossManager::Instance().OnSetHiidenServerIDX(CrossConfig::Instance().GetHiddenServerIDX());
	CrossManager::Instance().OnCrossOldestServerOpenTamp(msg->old_server_open_timestamp);

	const World::GateWayMap& gwm = World::GetInstWorld()->GetGatewayMap();
	World::GateWayMap::const_iterator it = gwm.begin();
	for (; it != gwm.end() && hgrgsr.gateway_num < ARRAY_ITEM_COUNT(hgrgsr.gateway_list); ++it)
	{
		STRNCPY(hgrgsr.gateway_list[hgrgsr.gateway_num].cross_gateway_hostname, it->second.hostname_for_user.c_str(), sizeof(hgrgsr.gateway_list[hgrgsr.gateway_num].cross_gateway_hostname));
		hgrgsr.gateway_list[hgrgsr.gateway_num].cross_gateway_port = it->second.port_for_user;
		hgrgsr.gateway_num += 1;
	}

	InternalComm::Instance().SendToGameThroughCross(msg->plat_type, msg->server_id_list[0], (char *)&hgrgsr, sizeof(hgrgsr));

	crossgameprotocal::HiddenGameBigDipperSynRet big_dipper_ret;
	const BigDipperMonsterParam* big_info = BigDipperManager::Instance().GetBigDipperMonsterParam();
	if (big_info != NULL)big_dipper_ret.info = *big_info;
	InternalComm::Instance().SendToGameThroughCross(msg->plat_type, msg->server_id_list[0], (char *)&big_dipper_ret, sizeof(big_dipper_ret));

	if (register_ret < 0)
	{
		gamelog::g_log_world.printf(LL_INFO, "OnCrossRegisterGameServer FAILED server_id[%d] ret[%d]", mother_server_id, register_ret);
		return;
	}

	World::GetInstWorld()->OnCrossRegisterGameServer(usid, chrgs.data_access_ip, chrgs.data_access_port, chrgs.plat_type, chrgs.count, chrgs.server_open_timestamp, chrgs.server_id_list, chrgs.gateway_hostname, chrgs.gateway_port);
	BigCrossManager::Instance().SyncGameServerInfoToBigCross( bigchgameprotocol::SYNC_GAME_SERVER_INFO_REQ_TYPE_REGISTER ,chrgs.count, chrgs.server_id_list);
}

void SceneManager::OnCrossRegisterGameServerRet(const char* data, int length)
{
	crossgameprotocal::HiddenGameRegisterGameServerRet *hgrgsr = (crossgameprotocal::HiddenGameRegisterGameServerRet *)data;
	CrossManager::Instance().SetCrossConnectRet(hgrgsr->ret);
	if (hgrgsr->ret < 0)
	{
#ifndef _DEBUG 
		//assert(0);
#endif
		return;
	}

	RandActivityManager* ramgr = RandActivityAdapter::Instance()->GetRAManager(LocalConfig::Instance().GetUniqueServerID());
	if (NULL != ramgr)
	{
		ramgr->SendActivityDataToCross();
	}
	CrossManager::Instance().OnCrossOpenTamp(hgrgsr->cross_open_server_tamp);
	CrossManager::Instance().OnCrossOldestServerOpenTamp(hgrgsr->cross_old_server_open_tamp);
	CrossManager::Instance().OnSetHiidenServerIDX(hgrgsr->hidden_server_idx);
	WorldStatus::Instance().SetLunHuiWangChuanRefreshTamp(hgrgsr->cross_lun_hui_wang_chuan_refresh_tamp);
	ChatManager::Instance().OnCrossRegisterGameServer();

	// gatewaylogin
	lgprotocal::GLRegisterCrossGateway glrcg;
	glrcg.gateway_num = 0;
	UNSTD_STATIC_CHECK(ARRAY_ITEM_COUNT(glrcg.gateway_list) == ARRAY_ITEM_COUNT(hgrgsr->gateway_list));
	for (int i = 0; i < hgrgsr->gateway_num && glrcg.gateway_num < ARRAY_ITEM_COUNT(glrcg.gateway_list); ++i)
	{
		F_STRNCPY(glrcg.gateway_list[glrcg.gateway_num].hostname, hgrgsr->gateway_list[i].cross_gateway_hostname, sizeof(glrcg.gateway_list[glrcg.gateway_num].hostname));
		glrcg.gateway_list[glrcg.gateway_num].port = hgrgsr->gateway_list[i].cross_gateway_port;
		glrcg.gateway_num += 1;
	}

	InternalComm::Instance().NetSend(InternalComm::Instance().m_login_server_netid, (const char *)&glrcg, sizeof(glrcg));
}

// 
bool RoleSIDFilter(Scene *scene, ObjID obj_id, void *usid)
{
	if (NULL == scene || NULL == usid)
	{
		return false;
	}

	static UniqueServerID st_usid;
	Obj *obj = scene->GetObj(obj_id);
	if (NULL != obj && obj->GetObjType() == Obj::OBJ_TYPE_ROLE)
	{
		Role *role = (Role *)obj;
		int server_id = role->GetRoleModuleManager()->GetRoleCross()->GetOriginServerId();
		int plat_type = role->GetRoleModuleManager()->GetRoleCross()->GetOriginPlatType();
		st_usid.server_id = server_id;
		st_usid.plat_type = plat_type;

		return st_usid == *(UniqueServerID *)usid;
	}

	return false;
}

void SceneManager::OnDisconnectOriginalServer(const char* data, int length)
{
	crossgameprotocal::CrossHiddenGSDisconnect *cggd = (crossgameprotocal::CrossHiddenGSDisconnect *)data;
	if (!CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	//  gameworlddataaccess, 
	UniqueServerID usid(cggd->origin_plat_type, cggd->origin_server_id);
	World::GetInstWorld()->GetSceneManager()->KickAllRole(-1, RoleSIDFilter, &usid);
	
	// Removedataaccessrmi session
	// (close sessiondataaccesssession 
	InternalComm::Instance().RemoveOriginalDB(usid);
	
	// 
	EventHandler::Instance().OnOriginDisconnectFromCrossServer(cggd->origin_plat_type, cggd->origin_server_id);
	
	gamelog::g_log_world.printf(LL_INFO, "SceneManager::OnDisconnectOriginalServer. disconnect_server: plat_type:%d, server_id:%d.", cggd->origin_plat_type, cggd->origin_server_id);
}

void SceneManager::OnCrossStartCrossReq(const char* data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	crossgameprotocal::CrossHiddenStartCrossReq* req = (crossgameprotocal::CrossHiddenStartCrossReq*)data;
	
	CrossUserRegister::Instance().OnStartCrossReq(req);
}

void SceneManager::OnCrossStartCrossAck(const char* data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	crossgameprotocal::CrossGameStartCrossAck* ack = (crossgameprotocal::CrossGameStartCrossAck*)data;
	ack->gateway_hostname[sizeof(ack->gateway_hostname) - 1] = 0;
	ack->role_name[sizeof(ack->role_name) - 1] = 0;

	Role* role = this->GetRole(IntToUid(ack->origin_uid));
	if (NULL == role) return;
	
	if (0 == ack->result)
	{
		role->GetRoleModuleManager()->GetRoleCross()->OnStartCrossAck(ack);
	}
	else
	{
		role->NoticeNum(errornum::EN_CROSS_FAILED);
	}
}

void SceneManager::OnUserEnteringHidden(const char* data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	crossgameprotocal::CrossGameUserEnteringHidden* msg = (crossgameprotocal::CrossGameUserEnteringHidden*)data;

	CrossUserShadow::Instance().OnUserEnteringHidden(msg);
}

void SceneManager::OnUserAllowedEnterHidden(const char* data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	crossgameprotocal::CrossHiddenUserAllowedEnterHidden* msg = (crossgameprotocal::CrossHiddenUserAllowedEnterHidden*)data;

	CrossUserRegister::CrossUserInfo* info = CrossUserRegister::Instance().GetCrossUserInfo(IntToUid(msg->allowed_uid));
	if (NULL != info)
	{
		info->can_enter_hidden = true;
		DelayLoginManager::GetInstance().OnCrossUserAllowedEnterHidden(IntToUid(msg->allowed_uid));
	}
}

void SceneManager::OnKickCrossUser(const char* data, int length)
{
	crossgameprotocal::CrossHiddenKickUser *cgku = (crossgameprotocal::CrossHiddenKickUser *)data;

	Role *user = this->GetRole(IntToUid(cgku->bekick_uid));
	if (NULL != user)
	{
		user->Save(true); //   

		// Role PS Save
		CrossUserRegister::Instance().OnUserKicked(user);

		// 
		EngineAdapter::Instance().NetDisconnect(user->GetNetId(), user->GetUserId(), user->GetName(), user->GetScene()->GetSceneID(), "OnKickCrossUser");
	}
	else
	{
		if (DelayLoginManager::GetInstance().IsUserDelayLoginInfoExist(IntToUid(cgku->bekick_uid)))
		{
			DelayLoginManager::GetInstance().RemoveUserDelayLoginRequest(IntToUid(cgku->bekick_uid));
		}

		// Role
		static crossgameprotocal::HiddenCrossKickUserAck ack;
		ack.origin_plat_type = cgku->origin_plat_type;
		ack.origin_server_id = cgku->origin_server_id;
		ack.origin_uid = cgku->origin_uid;
		ack.bekick_cross_uid = cgku->bekick_uid;

		InternalComm::Instance().SendToCross((const char*)&ack, length);
	}	
}

void SceneManager::OnKickCrossUserAck(const char* data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	crossgameprotocal::CrossGameKickUserAck* msg = (crossgameprotocal::CrossGameKickUserAck*)data;

	CrossUserShadow::Instance().OnKickCrossUserAck(msg);
}

void SceneManager::OnSyncCrossUser(const char *data, int length)
{
	crossgameprotocal::CrossGameSyncCrossUser *cgscu = (crossgameprotocal::CrossGameSyncCrossUser *)data;
	CrossUserShadow::Instance().OnSyncCrossUser(cgscu);
}

void SceneManager::OnCrossAllowedTeammateJoinTeam(const char* data, int length)
{
	crossgameprotocal::CrossGameTeammateJoinCrossTeam* msg = (crossgameprotocal::CrossGameTeammateJoinCrossTeam*)data;

	Team* team = TeamManager::Instance().GetTeamByTeamIndex(msg->cross_business_data.origin_team_index);
	if (NULL != team)
	{
		team->DismissTeamHelper();
	}

	for (int i = 0; i < 4 && i < ARRAY_ITEM_COUNT(msg->cross_business_data.teammate_list); ++i)
	{
		int teammate_uid = msg->cross_business_data.teammate_list[i];
		Role* teammate = World::GetInstWorld()->GetSceneManager()->GetRole(IntToUid(teammate_uid));
		if (NULL == teammate) continue;

		CrossData_Business business_data;
		business_data = msg->cross_business_data; //

		business_data.cross_business_type = CrossData_Business::BUSINESS_TYPE_JOIN_CROSS_TEAM;
		business_data.join_cross_team_id = msg->cross_team_index;

		if (teammate->GetRoleModuleManager()->GetRoleCross()->OnStartCrossReq(business_data))
		{
			TeamManager::Instance().ExitTeam(teammate);
		}
	}
}

void SceneManager::OnUserCrossTeamMatchSuccJoinTeam(const char* data, int length)
{
	crossgameprotocal::HiddenGameTeamMatchSuccJoinTeam* msg = (crossgameprotocal::HiddenGameTeamMatchSuccJoinTeam*)data;

	Role* role = World::GetInstWorld()->GetSceneManager()->GetRole(IntToUid(msg->role_id));
	if (NULL == role) return;

	Team* team = role->GetMyTeam();
	if (NULL != team) return;

	MatchUserInfo* mui = TeamMatch::Instance().GetMatchUserInfo(role->GetUniqueUserID());
	if (NULL == mui)
	{
		return; // 
	}

	if (!role->GetScene()->IsInStaticScene())
	{
		return; // 
	}

	const RoleBattleInfo* rbi = BattleManagerLocal::GetInstance().GetRoleBattleInfoConst(role->GetUID());
	if (NULL != rbi)
	{
		// 
		return;
	}

	CrossData_Business business_data;
	business_data.cross_business_type = CrossData_Business::BUSINESS_TYPE_JOIN_CROSS_TEAM;
	business_data.join_cross_team_id = msg->cross_team_index;
	business_data.auto_join_type_param1 = 0;

	if (role->GetRoleModuleManager()->GetRoleCross()->OnStartCrossReq(business_data))
	{
		TeamMatch::Instance().OnUserStopMatch(role->GetUniqueUserID());
	}
}
 
void SceneManager::OnHiddenRecvGameMessage(const char* data, int length)
{
	crossgameprotocal::GameHiddenMessage* msg = (crossgameprotocal::GameHiddenMessage*)data;

	int from_plat_type = msg->origin_plat_type;
	int from_server_id = msg->origin_server_id;

	switch (msg->type)
	{
		case crossgameprotocal::GAME_HIDDEN_MESSAGE_TYPE_DEFAULT:
		{
			if (msg->send_to_uuid > 0)
			{
				UserID user_id = CrossUserRegister::Instance().GetCrossUserID(msg->send_to_uuid);
				Role* role = World::GetInstWorld()->GetSceneManager()->GetRole(user_id);
				if (NULL != role)
				{
					EngineAdapter::Instance().NetSend(role->GetNetId(),
						data + sizeof(crossgameprotocal::GameHiddenMessage),
						length - sizeof(crossgameprotocal::GameHiddenMessage));
				}
			}
			else if (length >= sizeof(crossgameprotocal::GameHiddenMessage) + sizeof(crossgameprotocal::MessageHeader))
			{
				this->OnRecvMsgFromCross(data + sizeof(crossgameprotocal::GameHiddenMessage),
					length - sizeof(crossgameprotocal::GameHiddenMessage));

				crossgameprotocal::MessageHeader *header = (crossgameprotocal::MessageHeader*)(data + sizeof(crossgameprotocal::GameHiddenMessage));
				World::GetInstWorld()->GetCrossMonitor()->OnRecvMsg(header->msg_type);
			}
		}
		break;
		case crossgameprotocal::GAME_HIDDEN_MESSAGE_TYPE_SEND_ALL_GAME_USER:
		{
			const char * unpacking_head_data = data + sizeof(crossgameprotocal::GameHiddenMessage);
			int unpacking_head_data_length = length - sizeof(crossgameprotocal::GameHiddenMessage);
			World::GetInstWorld()->SendToAllGateway(unpacking_head_data, unpacking_head_data_length);
		}
		break;
		case crossgameprotocal::GAME_HIDDEN_MESSAGE_TYPE_SEND_GUILD_ALL_MEMBER:
		{
			const char * unpacking_head_data = data + sizeof(crossgameprotocal::GameHiddenMessage);
			int unpacking_head_data_length = length - sizeof(crossgameprotocal::GameHiddenMessage);

			Guild * guild = GuildManager::Instance().GetGuild(msg->guild_id);
			if (NULL != guild)
			{
				guild->GetMemberManager()->SendInfoToAllMember(unpacking_head_data, unpacking_head_data_length);
			}
		}
		break;
		case crossgameprotocal::GAME_HIDDEN_MESSAGE_TYPE_SEND_UNIQUE_SERVER_ALL_USER:
			{
				std::vector<int> online_user_list;
				UserCacheManager::Instance().GetUidListByStatusMap(&online_user_list, UserStatusNode::STATUS_TYPE_CROSS);
				for (int i = 0; i < (int)online_user_list.size(); i++)
				{
					Role *role = World::GetInstWorld()->GetSceneManager()->GetRole(online_user_list[i]);
					if (NULL == role) continue;

					RoleCross* rolecross = role->GetRoleModuleManager()->GetRoleCross();
					UniqueServerID target_id = UniqueServerID(msg->origin_plat_type, msg->origin_server_id);
					UniqueServerID usid = UniqueServerID(rolecross->GetOriginPlatType(), rolecross->GetOriginServerId());
					if (usid != target_id)
					{
						continue;
					}
					EngineAdapter::Instance().NetSend(role->GetNetId(),
						data + sizeof(crossgameprotocal::GameHiddenMessage),
						length - sizeof(crossgameprotocal::GameHiddenMessage));
				}
			}
		break;
		case crossgameprotocal::GAME_HIDDEN_MESSAGE_TYPE_SEND_TO_BIG_CROSS:
			{
				if (!BigCrossManager::Instance().IsBigCrossServerConnected())
				{
					bigchgameprotocol::HGameBigCUTAGuessReq * hb_req = (bigchgameprotocol::HGameBigCUTAGuessReq *)(data + sizeof(crossgameprotocal::GameHiddenMessage));
					int uid = UidToInt(hb_req->uuid.user_id);
					World::GetInstWorld()->NoticeNum(uid, errornum::EN_BIGCROSS_SERVER_LOST);
					return;
				}

				if (length >= sizeof(crossgameprotocal::GameHiddenMessage) + sizeof(bigchgameprotocol::MessageHeader))
				{
					InternalComm::Instance().SendToBigCrossServer(data + sizeof(crossgameprotocal::GameHiddenMessage), length - sizeof(crossgameprotocal::GameHiddenMessage));
				}
			}
			break;
	}
}

void SceneManager::OnGameRecvHiddenMessage(const char* data, int length)
{
	crossgameprotocal::HiddenGameMessage* msg = (crossgameprotocal::HiddenGameMessage*)data;

	switch (msg->type)
	{
		case crossgameprotocal::HIDDEN_GAME_MESSAGE_TYPE_DEFAULT:
			{
				int from_plat_type = msg->origin_plat_type;
				int from_server_id = msg->origin_server_id;
				int send_to_uid = msg->send_to_uid;

				if (send_to_uid > 0)
				{
					Role* role = World::GetInstWorld()->GetSceneManager()->GetRole(IntToUid(send_to_uid));
					if (NULL != role)
					{
						EngineAdapter::Instance().NetSend(role->GetNetId(),
										  data + sizeof(crossgameprotocal::HiddenGameMessage),
										  length - sizeof(crossgameprotocal::HiddenGameMessage));
					}

#ifdef _DEBUG
					Protocol::MessageHeader* message_header = (Protocol::MessageHeader*)(data + sizeof(crossgameprotocal::HiddenGameMessage));
					int message_length = length - sizeof(crossgameprotocal::HiddenGameMessage);
					gamelog::g_log_debug.printf(LL_INFO, "SceneManager::OnGameRecvHiddenMessage send to one user, msg_type[%d] msg_length[%d] uid[%d]",
						message_header->msg_type, message_length, send_to_uid);
#endif
				}
				else if (length >= sizeof(crossgameprotocal::HiddenGameMessage) + sizeof(crossgameprotocal::MessageHeader))
				{
					this->OnRecvMsgFromCross(data + sizeof(crossgameprotocal::HiddenGameMessage),
								 length - sizeof(crossgameprotocal::HiddenGameMessage));
				
					crossgameprotocal::MessageHeader *header = (crossgameprotocal::MessageHeader*)(data + sizeof(crossgameprotocal::HiddenGameMessage));
					World::GetInstWorld()->GetCrossMonitor()->OnRecvMsg(header->msg_type);
				}
			}
			break;
		case crossgameprotocal::HIDDEN_GAME_MESSAGE_TYPE_SEND_ALL_GAME_USER:
			{
				const char * unpacking_head_data = data + sizeof(crossgameprotocal::HiddenGameMessage);
				int unpacking_head_data_length = length - sizeof(crossgameprotocal::HiddenGameMessage);
				World::GetInstWorld()->SendToAllGateway(unpacking_head_data, unpacking_head_data_length);
			
#ifdef _DEBUG
				Protocol::MessageHeader* message_header = (Protocol::MessageHeader*)unpacking_head_data;
				gamelog::g_log_debug.printf(LL_INFO, "SceneManager::OnGameRecvHiddenMessage send to all user, msg_type[%d] msg_length[%d]",
					message_header->msg_type, unpacking_head_data_length);
#endif
			}
			break;
		case crossgameprotocal::HIDDEN_GAME_MESSAGE_TYPE_SEND_GUILD_ALL_MEMBER:
			{
				const char * unpacking_head_data = data + sizeof(crossgameprotocal::HiddenGameMessage);
				int unpacking_head_data_length = length - sizeof(crossgameprotocal::HiddenGameMessage);

				Guild * guild = GuildManager::Instance().GetGuild(msg->guild_id);
				if (guild != NULL)
				{
					guild->GetMemberManagerRef().SendInfoToAllMember(unpacking_head_data, unpacking_head_data_length);
				}

#ifdef _DEBUG
				Protocol::MessageHeader* message_header = (Protocol::MessageHeader*)unpacking_head_data;
				gamelog::g_log_debug.printf(LL_INFO, "SceneManager::OnGameRecvHiddenMessage send to guild member, msg_type[%d] msg_length[%d] guild_id[%d]",
					message_header->msg_type, unpacking_head_data_length, msg->guild_id);
#endif
			}
			break;
	}

}

void SceneManager::OnUserStartCrossMatch(const char* data, int length)
{
	crossgameprotocal::GameHiddenUserStartCrossMatch* msg = (crossgameprotocal::GameHiddenUserStartCrossMatch*)data;

	if (!CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	UniqueUserID uuid(msg->origin_plat_type, IntToUid(msg->origin_role_id));
	TeamMatch::Instance().OnUserStartCrossMatch(uuid, msg->role_level, msg->match_team_type, msg->role_guild_id, msg->is_auto_create);
}

void SceneManager::OnUserStopCrossMatch(const char* data, int length)
{
	crossgameprotocal::GameHiddenUserStopCrossMatch* msg = (crossgameprotocal::GameHiddenUserStopCrossMatch*)data;

	if (!CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	UniqueUserID uuid(msg->origin_plat_type, IntToUid(msg->origin_role_id));
	TeamMatch::Instance().OnUserStopMatch(uuid);
}

void SceneManager::OnHiddenSyncCrossTeamInfoToGame(const char* data, int length)
{
	crossgameprotocal::HiddenGameSyncCrossTeamInfo* msg = (crossgameprotocal::HiddenGameSyncCrossTeamInfo*)data;

	TeamManager::Instance().OnSyncCrossTeamInfo(msg);
}

void SceneManager::OnOriginUserGetTradeMarketShelveInfo(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketUserShelveInfo* msg = (crossgameprotocal::GameHiddenTradeMarketUserShelveInfo*)data;

	TradeMarketManager::Instance().OnOriginUserGetShelveDataReq(msg->plat_type, msg->server_id, msg->uuid);
}

void SceneManager::OnOriginUserSearchTradeMarketByItemID(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketSearchById* msg = (crossgameprotocal::GameHiddenTradeMarketSearchById*)data;

	TradeMarketManager::Instance().OnOriginUserSearchItemByIdReq(msg->plat_type, msg->server_id, msg->uuid, msg->item_id, msg->req_page, msg->is_announce > 0, msg->order_type);
}

void SceneManager::OnOriginUserSearchTradeMarketByType(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketSearchByType* msg = (crossgameprotocal::GameHiddenTradeMarketSearchByType*)data;

	TradeMarketManager::Instance().OnOriginUserSearchItemByTypeReq(msg->plat_type, msg->server_id, msg->uuid, msg->item_search_type, msg->req_page, msg->is_announce > 0, msg->order_type);
}

void SceneManager::OnOriginUserSearchTradeMarketByBigType(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketSearchByBigType* msg = (crossgameprotocal::GameHiddenTradeMarketSearchByBigType*)data;

	TradeMarketManager::Instance().OnOriginUserSearchItemByBigTypeReq(msg->plat_type, msg->server_id, msg->uuid, msg->item_big_search_type, msg->req_page, msg->is_announce > 0, msg->order_type);
}

void SceneManager::OnOriginUserSearchTradeMarketByTypeWithLevel(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketSearchByTypeWithLevel* msg = (crossgameprotocal::GameHiddenTradeMarketSearchByTypeWithLevel*)data;

	TradeMarketManager::Instance().OnOriginUserSearchItemByTypeWithLevelReq(msg->plat_type, msg->server_id, msg->uuid, msg->level_param, msg->item_search_type, msg->req_page, msg->is_announce > 0, msg->order_type);
}

void SceneManager::OnOriginUserSearchTradeMarketMedalByColor(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketSearchMedalByColor* msg = (crossgameprotocal::GameHiddenTradeMarketSearchMedalByColor*)data;

	TradeMarketManager::Instance().OnOriginUserSearchMedalByColorReq(msg->plat_type, msg->server_id, msg->uuid, msg->medal_color, msg->req_page, msg->is_announce > 0, msg->order_type, msg->prof_param);
}

void SceneManager::OnOriginUserSearchTradeMarketMedalByEffectTypeAndColor(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketSearchMedalByEffectTypeAndColor* msg = (crossgameprotocal::GameHiddenTradeMarketSearchMedalByEffectTypeAndColor*)data;

	TradeMarketManager::Instance().OnOriginUserSearchMedalByEffectTypeAndColor(msg->plat_type, msg->server_id, msg->uuid, msg->sp_type, msg->medal_color, msg->req_page, msg->is_announce > 0, msg->order_type);
}

void SceneManager::OnOriginUserGetTradeMarketTransactionRecord(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketGetTransactionRecord* msg = (crossgameprotocal::GameHiddenTradeMarketGetTransactionRecord*)data;

	TradeMarketManager::Instance().OnOriginUserGetTransactionRecordReq(msg->plat_type, msg->server_id, msg->uuid, msg->item_id);
}

void SceneManager::OnOriginUserGetTradeMarketRoleTradeRecord(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketGetRoleTradeRecord* msg = (crossgameprotocal::GameHiddenTradeMarketGetRoleTradeRecord*)data;

	TradeMarketManager::Instance().OnOriginUserGetRoleTradeRecordReq(msg->plat_type, msg->server_id, msg->uuid);
}

void SceneManager::OnOriginUserGetTradeMarketRoleFocusList(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketGetRoleFocusList* msg = (crossgameprotocal::GameHiddenTradeMarketGetRoleFocusList*)data;

	TradeMarketManager::Instance().OnOriginUserGetRoleFocusListReq(msg->plat_type, msg->server_id, msg->uuid);
}

void SceneManager::OnOriginUserGetTradeMarketFocusItemInfo(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketGetFocusItemInfo* msg = (crossgameprotocal::GameHiddenTradeMarketGetFocusItemInfo*)data;

	TradeMarketManager::Instance().OnOriginUserGetFocusItemInfoReq(msg->plat_type, msg->server_id, msg->uuid, msg->focus_index, msg->cur_page, msg->is_announce > 0);
}

void SceneManager::OnOriginUserRemoveTradeMarketFocusItem(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketRemoveFocusItem* msg = (crossgameprotocal::GameHiddenTradeMarketRemoveFocusItem*)data;

	TradeMarketManager::Instance().OnOriginUserRemoveFocusReq(msg->plat_type, msg->server_id, msg->uuid, msg->focus_index, msg->cur_page, msg->is_announce > 0);
}

void SceneManager::OnOriginUserAddTradeMarketFocusItem(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketAddFocusItem* msg = (crossgameprotocal::GameHiddenTradeMarketAddFocusItem*)data;

	TradeMarketManager::Instance().OnOriginUserAddFocusReq(msg->plat_type, msg->server_id, msg->uuid, msg->seller_uid, msg->sale_index, msg->upshelve_time);
}

void SceneManager::OnOriginUserGetTradeMarketMerchandiseNum(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketGetMerchandiseNum* msg = (crossgameprotocal::GameHiddenTradeMarketGetMerchandiseNum*)data;

	TradeMarketManager::Instance().OnOriginUserGetMerchandiseNum(msg->plat_type, msg->server_id, msg->uuid, msg->big_search_type, msg->is_announce > 0);
}

void SceneManager::OnOriginUserGetSellingList(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketGetSellingList* msg = (crossgameprotocal::GameHiddenTradeMarketGetSellingList*)data;

	TradeMarketManager::Instance().OnOriginUserGetSellingListReq(msg->plat_type, msg->server_id, msg->uuid, msg->item_id, msg->special_effect_type);
}

void SceneManager::OnOriginUserTradeMarketRequestBuy(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketRequestBuy* msg = (crossgameprotocal::GameHiddenTradeMarketRequestBuy*)data;

	TradeMarketManager::Instance().OnOriginUserRequestBuy(msg);
}

void SceneManager::OnOriginUserTradeMarketRequestBuyResp(const char* data, int length)
{
	crossgameprotocal::HiddenGameTradeMarketRequestBuyResp* msg = (crossgameprotocal::HiddenGameTradeMarketRequestBuyResp*)data;

	TradeMarketManager::Instance().OnOriginUserRequestBuyResp(msg);
}

void SceneManager::OnOriginUserTradeMarketRequestBuyConfirm(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketRequestBuyConfirm* msg = (crossgameprotocal::GameHiddenTradeMarketRequestBuyConfirm*)data;

	TradeMarketManager::Instance().OnOriginUserRequestBuyConfirm(msg);
}

void SceneManager::OnOriginUserTradeMarketRequestBuyConfirmResp(const char* data, int length)
{
	crossgameprotocal::HiddenGameTradeMarketRequestBuyConfirmResp* msg = (crossgameprotocal::HiddenGameTradeMarketRequestBuyConfirmResp*)data;

	TradeMarketManager::Instance().OnOriginUserRequestBuyConfirmResp(msg);
}

void SceneManager::OnOriginUserTradeMarketRequestBuyConfirmErrorResp(const char* data, int length)
{
	crossgameprotocal::HiddenGameTradeMarketRequestBuyConfirmErrorResp* msg = (crossgameprotocal::HiddenGameTradeMarketRequestBuyConfirmErrorResp*)data;

	TradeMarketManager::Instance().OnOriginUserRequestBuyConfirmErrorResp(msg);
}

void SceneManager::OnOriginUserTradeMarketRequestUpshelve(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketRequestUpshelve* msg = (crossgameprotocal::GameHiddenTradeMarketRequestUpshelve*)data;

	TradeMarketManager::Instance().OnOriginUserRequestUpshelve(msg);
}

void SceneManager::OnOriginUserTradeMarketRequestUpshelveResp(const char* data, int length)
{
	crossgameprotocal::HiddenGameTradeMarketRequestUpshelveResp* msg = (crossgameprotocal::HiddenGameTradeMarketRequestUpshelveResp*)data;

	TradeMarketManager::Instance().OnOriginUserRequestUpshelveResp(msg);
}

void SceneManager::OnOriginUserTradeMarketOffshelveReq(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketOffshelveReq* msg = (crossgameprotocal::GameHiddenTradeMarketOffshelveReq*)data;

	TradeMarketManager::Instance().OnOriginUserOffshelveReq(msg);
}

void SceneManager::OnOriginUserTradeMarketOffshelveResp(const char* data, int length)
{
	crossgameprotocal::HiddenGameTradeMarketOffshelveResp* msg = (crossgameprotocal::HiddenGameTradeMarketOffshelveResp*)data;

	TradeMarketManager::Instance().OnOriginUserOffshelveResp(msg);
}

void SceneManager::OnOriginUserTradeMarketRedoUpshelveReq(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketRedoUpshelveReq* msg = (crossgameprotocal::GameHiddenTradeMarketRedoUpshelveReq*)data;

	TradeMarketManager::Instance().OnOriginUserRedoUpshelveReq(msg);
}

void SceneManager::OnOriginUserTradeMarketRedoUpshelveResp(const char* data, int length)
{
	crossgameprotocal::HiddenGameTradeMarketRedoUpshelveResp* msg = (crossgameprotocal::HiddenGameTradeMarketRedoUpshelveResp*)data;

	TradeMarketManager::Instance().OnOriginUserRedoUpshelveResp(msg);
}

void SceneManager::OnOriginUserTradeMarketCashOutReq(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketCashOutReq* msg = (crossgameprotocal::GameHiddenTradeMarketCashOutReq*)data;

	TradeMarketManager::Instance().OnOriginUserCashOutReq(msg);
}

void SceneManager::OnOriginUserTradeMarketCashOutResp(const char* data, int length)
{
	crossgameprotocal::HiddenGameTradeMarketCashOutResp* msg = (crossgameprotocal::HiddenGameTradeMarketCashOutResp*)data;

	TradeMarketManager::Instance().OnOriginUserCashOutResp(msg);
}

void SceneManager::OnOriginUserSearchTradeMarketPetForQuickBuy(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketSearchPetForQuickBuy* msg = (crossgameprotocal::GameHiddenTradeMarketSearchPetForQuickBuy*)data;

	TradeMarketManager::Instance().OnOriginUserSearchPetForQuickBuyReq(msg->plat_type, msg->server_id, msg->role_id, msg->order_type, msg->item_id, msg->quality, msg->last_seller_uid, msg->last_price, msg->last_put_on_shelve_time, msg->last_str_level);
}

void SceneManager::OnOriginUserSearchAdvertise(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketSearchAdvertiseItemReq* msg = (crossgameprotocal::GameHiddenTradeMarketSearchAdvertiseItemReq*)data;

	TradeMarketManager::Instance().OnOriginUserSearchAdvertiseItemReq(msg);
}

void SceneManager::OnOriginUserTradeMarketAdvertiseReq(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketAdvertiseReq* msg = (crossgameprotocal::GameHiddenTradeMarketAdvertiseReq*)data;

	TradeMarketManager::Instance().OnOriginUserAdvertiseReq(msg);
}

void SceneManager::OnOriginUserTradeMarketAdvertiseResp(const char* data, int length)
{
	crossgameprotocal::HiddenGameTradeMarketAdvertiseResp* msg = (crossgameprotocal::HiddenGameTradeMarketAdvertiseResp*)data;

	TradeMarketManager::Instance().OnOriginUserAdvertiseResp(msg);
}

void SceneManager::OnOriginUserTradeMarketAdvertiseConfirmBoardcast(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketAdvertiseConfirmBoardcast* msg = (crossgameprotocal::GameHiddenTradeMarketAdvertiseConfirmBoardcast*)data;

	TradeMarketManager::Instance().OnOriginUserAdvertiseConfirmBoardcast(msg);
}

void SceneManager::OnUserApplyJoinCrossTeam(const char* data, int length)
{
	crossgameprotocal::GameHiddenUserApplyJoinCrossTeam* msg = (crossgameprotocal::GameHiddenUserApplyJoinCrossTeam*)data;

	TeamManager::Instance().ApplyJoinCrossTeam(msg);
}

void SceneManager::OnHiddenSendMailTransfer(const char* data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
	{
#ifdef _DEBUG
		assert(0);
#endif
		return;
	}

	crossgameprotocal::HiddenGameSendMailTransfer* msg = (crossgameprotocal::HiddenGameSendMailTransfer *)data;
	
	Role* receiver_role = World::GetInstWorld()->GetSceneManager()->GetRole(UidToInt(msg->recieve_uid));
	if (NULL != receiver_role)
	{
		receiver_role->GetRoleModuleManager()->GetRoleMail()->AddMail(msg->mail_param, true);
	}
	else
	{
		UserMailManager::Instance().SyncMailFromHidden(UidToInt(msg->recieve_uid), msg->mail_param);
	}
}

void SceneManager::OnGameToGameRoleChatTransfer(const char* data, int length)
{
	crossgameprotocal::G2GRoleChatTransfer *msg = (crossgameprotocal::G2GRoleChatTransfer *)data;
	ChatManager::Instance().OnSingleChat(msg);
}

void SceneManager::OnHiddenRequestGuildList(const char* data, int length)
{
	GuildManager::Instance().SyncAllGuildToCross();
}

void SceneManager::OnGameSyncGuildListToHidden(const char* data, int length)
{
	if (length <= sizeof(crossgameprotocal::GameHiddenResponseGuildList)) return; // 

	crossgameprotocal::GameHiddenResponseGuildList* msg = (crossgameprotocal::GameHiddenResponseGuildList*)data;

	const char* guild_data = data + sizeof(crossgameprotocal::GameHiddenResponseGuildList);
	int guild_data_length = length - sizeof(crossgameprotocal::GameHiddenResponseGuildList);
	
	TLVUnserializer unserializer;
	unserializer.Reset(guild_data, guild_data_length);

	static AllGuildParam param;
	bool ret = param.Unserialize(unserializer);
	gamelog::g_log_guild.printf(LL_INFO, "OnGameSyncGuildListToHidden ret:%d", (int)ret);

	if (!ret)
	{
#ifdef _DEBUG
		assert(0);
#endif
		return;
	}

	GuildManager::Instance().InitGuildBySync(msg->plat_type, msg->server_id, param, msg->is_first > 0, msg->is_last > 0);
}

void SceneManager::OnGameSyncGuildMemberChangeToHidden(const char* data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	crossgameprotocal::GameHiddenSyncGuildMemberChange* msg = (crossgameprotocal::GameHiddenSyncGuildMemberChange*)data;
	Guild* guild = GuildManager::Instance().GetGuild(msg->guild_id);
	if (NULL == guild) return;

	guild->GetMemberManager()->OnGameSyncMemberChange(msg->op_type, msg->param1, msg->member);
}

void SceneManager::OnHiddenSyncGuildMemberChangeToHidden(const char * data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	crossgameprotocal::HiddenGameSyncGuildMemberChange * msg = (crossgameprotocal::HiddenGameSyncGuildMemberChange *)data;
	Guild * guild = GuildManager::Instance().GetGuild(msg->guild_id);
	if (NULL == guild) return;

	guild->GetMemberManager()->OnHiddenSyncMemberChange(msg->op_type, msg->param1, msg->member);
}

void SceneManager::OnGameSyncGuildChangeToHidden(const char* data, int length)
{
	crossgameprotocal::GameHiddenSyncGuildChange real_msg;
	int offset = 0;
	if (!real_msg.Deserialize(data, length, &offset))
	{
		assert(0);
		return;
	}

	GuildManager::Instance().OnSyncGuildChangeFromGame(real_msg.guild_id, real_msg.plat_type, real_msg.op_type, real_msg.param);
}

void SceneManager::OnSyncGameHiddenGetFriendInfo(const char* data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::GameHiddenGetFriendInfo * info = (crossgameprotocal::GameHiddenGetFriendInfo*)data;

	FriendManager::Instance().OnGetFriendInfoFromGameWorld(info);
}

void SceneManager::OnHiddenGameFriendListToRole(const char* data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::HiddenGameFriendListToRole * _list = (crossgameprotocal::HiddenGameFriendListToRole*)data;

	FriendManager::Instance().OnSyncFriendListToRoleFromHidden(_list);
}

void SceneManager::OnHiddenGameFrinedAskListChange(const char* data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::HiddenGameFriendAskListChange * _change = (crossgameprotocal::HiddenGameFriendAskListChange*)data;
	FriendManager::Instance().OnSyncFrinedAskListChangeFromHidden(_change);
}

void SceneManager::OnGameHiddenAddFriendReq(const char* data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::GameHiddenAddFriendReq * _req = (crossgameprotocal::GameHiddenAddFriendReq*)data;
	FriendManager::Instance().OnAddFriendReqFromGameWorld(_req);
}

void SceneManager::OnHiddenGameSyncRoleReqRet(const char* data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::HiddenGameSyncRoleReqRet * ret = (crossgameprotocal::HiddenGameSyncRoleReqRet*)data;

	Role * role = World::GetInstWorld()->GetSceneManager()->GetRole(IntToUid(ret->role_id));
	if (NULL != role)
	{
		role->NoticeNum(ret->error_num);
	}
}

void SceneManager::OnGameHiddenAddFriendReplyReq(const char* data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::GameHiddenAddFriendReplyReq * ret = (crossgameprotocal::GameHiddenAddFriendReplyReq*)data;
	FriendManager::Instance().OnAddFriendReplyReqFromGameWorld(ret);
}

void SceneManager::OnGameHiddenRemoveFriendReq(const char* data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::GameHiddenRemoveFriendReq * req = (crossgameprotocal::GameHiddenRemoveFriendReq*)data;
	FriendManager::Instance().OnRemoveFriendReqFromGameWorld(req);
}

void SceneManager::OnGameHiddenAddBlackReq(const char* data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::GameHiddenAddBlackReq * req = (crossgameprotocal::GameHiddenAddBlackReq*)data;
	FriendManager::Instance().OnAddBlackReqFromGameWorld(req);
}

void SceneManager::OnHiddenGameBlackList(const char* data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::HiddenGameBlackList * req = (crossgameprotocal::HiddenGameBlackList*)data;
	FriendManager::Instance().OnGetBlackListFromHidden(req);
}

void SceneManager::OnHiddenGameBlackListChange(const char* data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::HiddenGameBlackListChange * req = (crossgameprotocal::HiddenGameBlackListChange*)data;
	FriendManager::Instance().OnGetBlackListChangeFromHidden(req);
}

void SceneManager::OnGameHiddenRemoveBlackReq(const char* data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::GameHiddenRemoveBlackReq * req = (crossgameprotocal::GameHiddenRemoveBlackReq*)data;
	FriendManager::Instance().OnRemoveBlackReqFromGameWorld(req);
}

void SceneManager::OnGameHiddenFriendGroupReq(const char* data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::GameHiddenFriendGroupReq * req = (crossgameprotocal::GameHiddenFriendGroupReq*)data;
	FriendManager::Instance().OnFriendGroupReqFromGameWorld(req);
}

void SceneManager::OnHiddenGameAskListToRole(const char* data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::HiddenGameAskListToRole * list = (crossgameprotocal::HiddenGameAskListToRole*)data;
	FriendManager::Instance().OnAskListToRoleFromHidden(list);
}

void SceneManager::OnGameHiddenRecentlyReq(const char* data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::GameHiddenRecentlyReq * req = (crossgameprotocal::GameHiddenRecentlyReq*)data;
	FriendManager::Instance().OnRecentlyReqFromGameWorld(req);
}

void SceneManager::OnHiddenGameRecentlyInfo(const char* data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::HiddenGameRecentlyInfo * req = (crossgameprotocal::HiddenGameRecentlyInfo*)data;
	FriendManager::Instance().OnRecentlyInfoFromHidden(req);
}

void SceneManager::OnHiddenGameFriendChangeToRole(const char* data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::HiddenGameFriendChangeToRole * msg = (crossgameprotocal::HiddenGameFriendChangeToRole*)data;
	FriendManager::Instance().OnFriendChangeToRoleFromHidden(msg);
}

void SceneManager::OnGameHiddenRoleLoginLogoutFriendsNotify(const char* data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
		return;

	crossgameprotocal::GameHiddenRoleLoginLogoutFriendNotify * msg = (crossgameprotocal::GameHiddenRoleLoginLogoutFriendNotify*)data;
	FriendManager::Instance().OnRoleLoginLogoutFriendNotifyFromGameWorld(msg);
}

void SceneManager::OnSyncFriendInfo(const char* data, int length)
{
	crossgameprotocal::SyncFriendInfo * _friend_info = (crossgameprotocal::SyncFriendInfo*)data;

	FriendManager::Instance().OnSyncFriendInfo(_friend_info);
}

void SceneManager::OnSyncAddFriendOfflienEvent(const char* data, int length)
{
	crossgameprotocal::SyncAddFriendOfflineEvent * req = (crossgameprotocal::SyncAddFriendOfflineEvent*)data;
	FriendManager::Instance().OnSyncAddFriendOfflienEvent(req);
}

void SceneManager::OnSyncBlackInfo(const char* data, int length)
{
	crossgameprotocal::SyncBlackInfo * _black_info = (crossgameprotocal::SyncBlackInfo*)data;

	FriendManager::Instance().OnSyncBlackInfo(_black_info);
}

void SceneManager::OnHiddenToGameAddTitleToGuildMember(const char* data, int length)
{
	crossgameprotocal::HiddenGameGuildMemberAddTitle* msg = (crossgameprotocal::HiddenGameGuildMemberAddTitle*)data;
	
	Guild* guild = GuildManager::Instance().GetGuild(msg->guild_id);
	if (NULL != guild)
	{
		guild->GetMemberManager()->SendTitleToAllMember(msg->title_id, msg->reason);
	}
}

void SceneManager::OnGameHiddenReqSyncWorldStatus(const char * data, int length)
{
	crossgameprotocal::GameHiddenReqSyncWorldStatus * msg = (crossgameprotocal::GameHiddenReqSyncWorldStatus*)data;
	WorldStatus::Instance().SyncWorldStatusHiddenToGameworld(msg->server_id);


	//
	crossgameprotocal::CrossGameDataSyncCheckAck ack;
	ack.type = crossgameprotocal::DATA_SYNC_CHECK_TYPE_WORLD_STATUS;
	InternalComm::Instance().SendToGameThroughCross(LocalConfig::Instance().GetPlatType(), msg->server_id, (const char*)&ack, sizeof(ack));

}

void SceneManager::OnGameHiddenSyncWorldStatus(const char * data, int length)
{
	crossgameprotocal::HiddenGameSyncWorldStatus * msg = (crossgameprotocal::HiddenGameSyncWorldStatus*)data;
	WorldStatus::Instance().SetWorldStatus(msg);
}

void SceneManager::OnHiddenGameActivityForceToNextState(const char * data, int length)
{
	crossgameprotocal::HiddenGameActivityForceToNextState * msg = (crossgameprotocal::HiddenGameActivityForceToNextState*)data;
	ActivityManager::Instance().OnForceToNextState(msg->activity_type, (0 != msg->next_status_switch_timestamp) ? &msg->next_status_switch_timestamp : NULL);
}

void SceneManager::OnGameHiddenReqSyncActivityStatus(const char * data, int length)
{
	crossgameprotocal::GameHiddenReqSyncActivityStatus * msg = (crossgameprotocal::GameHiddenReqSyncActivityStatus*)data;
	ActivityManager::Instance().SyncAllActivityStatusHiddenToGameworld(msg->server_id);
}

void SceneManager::OnHiddenGameSyncActivityStatus(const char * data, int length)
{
	crossgameprotocal::HiddenGameSyncActivityStatus* msg = (crossgameprotocal::HiddenGameSyncActivityStatus*)data;

	Activity * activity = ActivityManager::Instance().ForceGetActivity(msg->activity_type);
	if (activity != NULL)
	{
		SyncActivityStatus sync_activity_status;
		sync_activity_status.activity_status = msg->activity_status;
		sync_activity_status.next_status_switch_time = msg->next_status_switch_time;

		activity->SetActivityState(sync_activity_status);
	}
}

void SceneManager::OnHiddenGameSyncHuanJieActivityStatus(const char * data, int length)
{
	crossgameprotocal::HiddenGameSyncHuanJieActivityStatus * msg = (crossgameprotocal::HiddenGameSyncHuanJieActivityStatus *)data;

	ActivityHuanJieZhanChang * activity = (ActivityHuanJieZhanChang *)ActivityManager::Instance().ForceGetActivity(ACTIVITY_TYPE_HUAN_JIE_ZHAN_CHANG);
	if (activity == NULL)
	{
		return;
	}

	activity->SetSeasonNum(msg->season_num);
}

void SceneManager::OnGameHiddenChiefElectionReq(const char * data, int length)
{
	crossgameprotocal::GameHiddenChiefElectionReq * req = (crossgameprotocal::GameHiddenChiefElectionReq*)data;

	if (ActivityManager::Instance().IsActivityClose(ACTIVITY_TYPE_CHIEF_ELECTION))
	{
		return;
	}

	ActivityChiefElection * activity = (ActivityChiefElection *)ActivityManager::Instance().ForceGetActivity(ACTIVITY_TYPE_CHIEF_ELECTION);
	if (activity == NULL)
	{
		return;
	}

	UniqueUserID uuid(req->origin_plat_type, IntToUid(req->origin_role_id));
	switch (req->req_type)
	{
		case Protocol::CHIEF_ELECTION_REQ_TYPE_MATCH_INFO:
			{
				activity->HiddenToGameSendMatchInfo(req->origin_role_id, req->base_prof);
			}
			break;
		case Protocol::CHIEF_ELECTION_REQ_GET_INFO:
			{
				activity->HiddenToGameSendMatchState(req->origin_role_id);
				activity->HiddenToGameSendNoticeToRole(req->origin_role_id, req->base_prof);
			}
			break;
	}
}

void SceneManager::OnGameHiddenChiefPeakBattleReq(const char * data, int length)
{
	crossgameprotocal::GameHiddenChiefPeakBattleReq * req = (crossgameprotocal::GameHiddenChiefPeakBattleReq *)data;

	if (ActivityManager::Instance().IsActivityClose(ACTIVITY_TYPE_CHIEF_PEAK_BATTLE))
	{
		return;
	}

	ActivityChiefPeakBattle * activity = (ActivityChiefPeakBattle *)ActivityManager::Instance().ForceGetActivity(ACTIVITY_TYPE_CHIEF_PEAK_BATTLE);
	if (activity == NULL)
	{
		return;
	}

	switch (req->req_type)
	{
		case Protocol::CHIEF_PEAK_BATTLE_REQ_TYPE_ROLE_INFO:
			{
				activity->HiddenToGameSendRoleInfo(req->origin_role_id);
			}
			break;
		case Protocol::CHIEF_PEAK_BATTLE_REQ_TYPE_MATCH_INFO:
			{
				activity->HiddenToGameSendMatchInfo(req->origin_role_id);
			}
			break;
		case Protocol::CHIEF_PEAK_BATTLE_REQ_GET_NOTICE:
			{
				activity->HiddenToGameSendNoticeToRole(req->origin_role_id);
			}
			break;
	}
}

void SceneManager::OnGameHiddenHuanJieZhanChangReq(const char * data, int length)
{
	crossgameprotocal::GameHiddenHuanJieZhanChangeReq * req = (crossgameprotocal::GameHiddenHuanJieZhanChangeReq *)data;

	ActivityHuanJieZhanChang * activity = (ActivityHuanJieZhanChang *)ActivityManager::Instance().ForceGetActivity(ACTIVITY_TYPE_HUAN_JIE_ZHAN_CHANG);
	if (activity == NULL)
	{
		return;
	}

	switch (req->req_type)
	{
		case Protocol::HUAN_JIE_ZHAN_CHANG_REQ_TYPE_RANK_INFO:
			{
				activity->HiddenToGameSendRankInfo(req->origin_role_id, req->p1);
			}
			break;
		case Protocol::HUAN_JIE_ZHAN_CHANG_REQ_INFO:
			{
				activity->HiddenToGameSendRoleInfo(req->origin_role_id);
			}
			break;
	}
}

void SceneManager::OnGameHiddenHuanJieZhanChangReq2(const char * data, int length)
{
	crossgameprotocal::GameHiddenHuanJieZhanChangeReq2 * req = (crossgameprotocal::GameHiddenHuanJieZhanChangeReq2 *)data;
	int offset = static_cast<int>(UNSTD_OFFSETOFF(crossgameprotocal::GameHiddenHuanJieZhanChangeReq2, role_id_list));
	if (length < offset)
	{
		return;
	}

	int role_id_num = (length - offset) / sizeof(req->role_id_list[0]);
	if (role_id_num > ARRAY_LENGTH(req->role_id_list) || role_id_num != req->count)
	{
		return;
	}


	ActivityHuanJieZhanChang * activity = (ActivityHuanJieZhanChang *)ActivityManager::Instance().ForceGetActivity(ACTIVITY_TYPE_HUAN_JIE_ZHAN_CHANG);
	if (activity == NULL)
	{
		return;
	}

	std::set<int> role_id_list(req->role_id_list, req->role_id_list + role_id_num);
	activity->HiddenToGameQueryRoleRankInfo(req->origin_role_id, role_id_list);
}

void SceneManager::OnGameHiddenBraveGroundReq(const char * data, int length)
{
	crossgameprotocal::GameHiddenHBraveGroundReq * req = (crossgameprotocal::GameHiddenHBraveGroundReq *)data;

	ActivityBraveGround * act = static_cast<ActivityBraveGround *>(ActivityManager::Instance().ForceGetActivity(ACTIVITY_TYPE_BRAVE_GROUND));
	if (NULL == act)
	{
		return;
	}

	switch (req->req_type)
	{
		case Protocol::BRAVE_GROUND_REQ_TYPE_RANK_INFO:
			{
				act->HiddenToGameSendRankInfo(req->origin_role_id);
			}
			break;
	}
}

void SceneManager::OnGameHiddenUserCacheSync(const char* data, int length)
{
	crossgameprotocal::GameHiddenUserCacheSync *protocol = (crossgameprotocal::GameHiddenUserCacheSync *)data;
	UserCacheManager::Instance().OnSyncGameCache(protocol);
}

void SceneManager::OnHiddenGameUserCacheSync(const char * data, int length)
{
	crossgameprotocal::HiddenGameUserCacheSync *protocol = (crossgameprotocal::HiddenGameUserCacheSync *)data;
	UserCacheManager::Instance().OnSynHiddenCache(protocol);
}

void SceneManager::OnHiddenGameChangeGuildInfo(const char * data, int length)
{
	crossgameprotocal::HiddenGameChangeGuildInfo * msg = (crossgameprotocal::HiddenGameChangeGuildInfo *)data;

	Guild * guild = GuildManager::Instance().GetGuild(msg->guild_id);

	if (guild == NULL)
	{
		return;
	}

	switch (msg->change_type)
	{
		case crossgameprotocal::HIDDEN_GAME_GUILD_CHANGE_TYPE_ADD_EXP:
			{
				guild->AddExp(msg->param);
			}
			break;
		case crossgameprotocal::HIDDEN_GAME_GUILD_CHANGE_TYPE_SET_GUILD_HONOR_TITLE:
			{
				
			}
			break;

		case crossgameprotocal::HIDDEN_GAME_GUILD_CHANGE_TYPE_WEEK_TASK_EVENT:
			{
				guild->OnGuildWeekTaskEvent(IntToUid(msg->param4), msg->param, msg->param2, msg->param3);
			}
			break;
		case crossgameprotocal::HIDDEN_GAME_GUILD_CHANGE_TYPE_SET_GUILD_FIGHT_TITLE:
			{
				guild->SetGuildFightTitle(msg->param);
			}
			break;
		case crossgameprotocal::HIDDEN_GAME_GUILD_CHANGE_TYPE_ADD_GONGXIAN:
			{
				guild->OnAddGongXian(msg->param, msg->param2, __FUNCTION__);
			}
			break;
		case crossgameprotocal::HIDDEN_GAME_GUILD_CHANGE_TYPE_ROLE_GUILD_TASK_FINISH:
			{
				guild->GuildTaskSetFinishTimes(msg->param, msg->param2);
			}
			break;
		case crossgameprotocal::HIDDEN_GAME_GUILD_CHANGE_TYPE_ROLE_GUILD_TASK_SOLICIT:
			{
				guild->GuildTaskSolicit(msg->param, msg->param2, msg->param3);
			}
			break;
		case crossgameprotocal::HIDDEN_GAME_GUILD_CHANGE_TYPE_ROLE_GUILD_TASK_CLEAR_SOLICIT:
			{
				guild->GuildTaskClearSolicit(msg->param, msg->param2 != 0);
			}
			break;
		case crossgameprotocal::HIDDEN_GAME_GUILD_CHANGE_TYPE_ROLE_GUILD_TASK_GIVE:
			{
				guild->GuildTaskGiveAddNum(msg->param, msg->param2);
			}
			break;
		case crossgameprotocal::HIDDEN_GAME_GUILD_CHANGE_TYPE_ROLE_GUILD_TASK_FETCH:
			{
				guild->GuildTaskFetchAddNum(msg->param, msg->param2, msg->param3);
			}
			break;
		case crossgameprotocal::HIDDEN_GAME_GUILD_CHANGE_TYPE_ROLE_GUILD_TASK_MAIL_NOTICE:
			{
				guild->GuildTaskMailNotice(msg->param, msg->param2, msg->param3);
			}
			break;
		default:
			break;
	}
}

void SceneManager::OnGameHiddenGuildHonorBattleReqRoute(const char * data, int length)
{
	crossgameprotocal::GameHiddenGuildHonorBattleReqRoute * req = (crossgameprotocal::GameHiddenGuildHonorBattleReqRoute *)data;

	if (!CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	switch (req->req_type)
	{
		case Protocol::GUILD_HONOR_REQ_TYPE_2_SCORE_INFO:
			{
				GuildHonorBattleManager::Instance().SendGuildScoreInfo(req->p1, NULL, req->role_id);
			}
			break;
		case Protocol::GUILD_HONOR_REQ_TYPE_2_SCORE_RANK:
			{
				GuildHonorBattleManager::Instance().SendGuildScoreRankInfo(NULL, req->role_id);
			}
			break;
		case Protocol::GUILD_HONOR_REQ_TYPE_2_GUESSING:
			{
				GuildHonorBattleManager::Instance().Guessing(req->p2, req->p1, false, req->role_guild_id, req->role_id);
			}
			break;

		case Protocol::GUILD_HONOR_REQ_TYPE_2_CANCEL_GUESSING:
			{
				GuildHonorBattleManager::Instance().CancelGuessing(req->p1, req->p2, false, req->role_id);
			}
			break;
		case Protocol::GUILD_HONOR_REQ_TYPE_2_GUESSING_CHAMPION:
			{
				GuildHonorBattleManager::Instance().Guessing(1, req->p1, true, req->role_guild_id, req->role_id);
			}
			break;

		case Protocol::GUILD_HONOR_REQ_TYPE_2_CANCEL_GUESSING_CHAMPION:
			{
				GuildHonorBattleManager::Instance().CancelGuessing(req->p1, req->p2, true, req->role_id);
			}
			break;
		case Protocol::GUILD_HONOR_REQ_TYPE_2_MATCH_RECORD_INFO:
			{
				GuildHonorBattleManager::Instance().SendMatchRecordInfo(NULL, req->role_id);
			}
			break;
		case Protocol::GUILD_HONOR_REQ_TYPE_2_GUESSING_INFO:
			{
				GuildHonorBattleManager::Instance().SendGuessInfo(req->role_id);
			}
			break;
	}
}

void SceneManager::OnHiddenGameGuildHonorBattleMatchRecordSyncInfo(const char * data, int length)
{
	crossgameprotocal::HiddenGameGuildHonorBattleMatchRecordSyncInfo * req = (crossgameprotocal::HiddenGameGuildHonorBattleMatchRecordSyncInfo *)data;
	if (CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	GuildHonorBattleManager::Instance().SetGuildHonorRecordFromHidden(req->match_record_data, req->is_notice);
}

void SceneManager::OnGameSyncActivityInfoFromCross(const char* data, int length)
{
	crossgameprotocal::CrossGameRandActivityInfoSyncRet *ret = (crossgameprotocal::CrossGameRandActivityInfoSyncRet *)data;
	RandActivityManager* ramgr = RandActivityAdapter::Instance()->GetRAManager(LocalConfig::Instance().GetUniqueServerID());
	if (NULL != ramgr)
	{
		ramgr->OnSyncActivityInfoFromCross(ret->count, ret->param_list);
	}
}

void SceneManager::OnHiddenSyncActivityInfoFromCross(const char* data, int length)
{
	crossgameprotocal::CrossHiddenRandActivityInfoSync* ret = (crossgameprotocal::CrossHiddenRandActivityInfoSync*)data;
	HiddenRandActivityShadow::Instance()->OnSyncActivityInfoFromCross(ret->plat_type, ret->server_id, ret->count, ret->param_list);

	if (ret->is_all_sync)
	{
		//
		crossgameprotocal::CrossGameDataSyncCheckAck ack;
		ack.type = crossgameprotocal::DATA_SYNC_CHECK_TYPE_RAND_ACTIVITY;
		InternalComm::Instance().SendToGameThroughCross(ret->plat_type, ret->server_id, (const char*)&ack, sizeof(ack));
	}
}

void SceneManager::OnHiddenGameChatItemInfoReq(const char * data, int length)
{
	crossgameprotocal::HiddenGameChatItemInfoReq * req = (crossgameprotocal::HiddenGameChatItemInfoReq *)data;
	ChatManager::Instance().SendChatItemInfo2(req->role_id, req->unique_item_seq, true);
}

void SceneManager::OnGameHiddenChatItemInfoReq(const char * data, int length)
{
	crossgameprotocal::GameHiddenChatItemInfoReq * req = (crossgameprotocal::GameHiddenChatItemInfoReq *)data;
	ChatManager::Instance().SendChatItemInfo2(req->role_id, req->unique_item_seq, false);
}

void SceneManager::OnGameHiddenChatItemInfoSyn(const char * data, int length)
{
	crossgameprotocal::GameHiddenChatItemSyn req;
	int offset = 0;
	if (!req.Deserialize(data, length, &offset))
	{
		return;
	}

	ChatItemInfo item_info;
	item_info.item.item_id = req.item_id;
	item_info.item.num = req.num;
	item_info.item.is_bind = (char)req.is_bind;
	item_info.item.invalid_time = req.invalid_time;
	if (req.has_param != 0)
	{
		item_info.item.has_param = req.has_param;
		((NetValueItemParam *)(item_info.item.param_data))->SetData(req.param_data);
	}

	if (req.has_attrs != 0)
	{
		for (int i = 0; i < ARRAY_LENGTH(req.attrs); ++i)
		{
			item_info.atts[i] = req.attrs[i];
		}
	}

	ChatManager::Instance().ChatItemInfoSyn(req.item_info_seq, &item_info);
}

void SceneManager::OnGameHiddenForceGetGold(const char * data, int length)
{
	crossgameprotocal::GameHiddenForceGetGold *get_gold = (crossgameprotocal::GameHiddenForceGetGold *)data;
	Role *role = this->GetRole(get_gold->role_id);
	if (NULL != role)
	{
		role->GetRoleModuleManager()->GetMoney()->ForceGetGold();
		role->GetRoleModuleManager()->GetRoleCmdNow();
	}

	gamelog::g_log_cmd.printf(LL_INFO, "SceneManager::OnGameHiddenForceGetGold from server: %d, role_id:%d", get_gold->server_id, get_gold->role_id);
}

void SceneManager::OnHiddenToGameAddTitleToRole(const char * data, int length)
{
	crossgameprotocal::HiddenGameRoleAddTitle* msg = (crossgameprotocal::HiddenGameRoleAddTitle*)data;
	WorldStatus::Instance().SendTitleToRole(msg->title_id, msg->uid, msg->reason);
}

void SceneManager::OnGameHiddenOnlineStatusSync(const char* data, int length)
{
	crossgameprotocal::GameHiddenOnlineStatusSync *msg = (crossgameprotocal::GameHiddenOnlineStatusSync *)data;
	UserCacheManager::Instance().OnSyncOnlineStatus(msg->role_id, msg->online_status);

	crossgameprotocal::HiddenGameOtherServerRoleOnlineStatusSync sync;
	sync.role_id = msg->role_id;
	sync.online_status = msg->online_status;
	InternalComm::Instance().SendToAllGameThroughCross(&sync, sizeof(sync));

}

void SceneManager::OnHiddenGameOtherServerRoleOnlineStatusSync(const char* data, int length)
{
	crossgameprotocal::HiddenGameOtherServerRoleOnlineStatusSync *msg = (crossgameprotocal::HiddenGameOtherServerRoleOnlineStatusSync *)data;

	if (!LocalConfig::Instance().IsAllowedServerId(IntToUid(msg->role_id).db_index))
	{
		// 
		UserCacheManager::Instance().OnSyncOnlineStatus(msg->role_id, msg->online_status);
	}
}

void SceneManager::OnCrossUserMsg(const char *msg, int length)
{
	if (length <= (int)sizeof(crossgameprotocal::CrossGameUserMsg)) return;

	crossgameprotocal::CrossGameUserMsg *cross_user_msg = (crossgameprotocal::CrossGameUserMsg *)msg;

	Role *receiver_user = this->GetRole(IntToUid(cross_user_msg->uid));
	if (NULL == receiver_user) return;

	EngineAdapter::Instance().NetSend(receiver_user->GetNetId(), msg + sizeof(crossgameprotocal::CrossGameUserMsg),
		length - sizeof(crossgameprotocal::CrossGameUserMsg));
}

void SceneManager::OnCrossGameHiddenNotConnected(const char * data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	crossgameprotocal::CrossGameHiddenNotConnected* ack = (crossgameprotocal::CrossGameHiddenNotConnected*)data;
	Role* role = this->GetRole(IntToUid(ack->uid));
	if (NULL == role) return;
	
	role->NoticeNum(errornum::EN_ACTIVITY_CROSS_SERVER_NOT_OPEN);
}

void SceneManager::OnGameHiddenQueryReq(const char * data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	crossgameprotocal::GameCrossSyncCrossQuery* ack = (crossgameprotocal::GameCrossSyncCrossQuery*)data;
	
	QueryHandler::Instance().OnQueryOther(ack->target_uid, UidToInt(ack->viewer_uid.user_id));
}

void SceneManager::OnCrossSendAllUser(const char * data, int length)
{
	if(length <= (int)sizeof(crossgameprotocal::GameCrossSendAllUser)) return;

	crossgameprotocal::GameCrossSendAllUser * msg = (crossgameprotocal::GameCrossSendAllUser *)data;

	if (msg->send_to_uuid > 0)
	{
		World::GetInstWorld()->SendToRole(msg->send_to_uuid, data + sizeof(crossgameprotocal::GameCrossSendAllUser), length - sizeof(crossgameprotocal::GameCrossSendAllUser));
	}

	if (msg->send_to_uuid == 0)
	{
		World::GetInstWorld()->SendToAllGateway(data + sizeof(crossgameprotocal::GameCrossSendAllUser), length - sizeof(crossgameprotocal::GameCrossSendAllUser));
	}
}

void SceneManager::OnHiddenGameNoticeLog(const char * data, int length)
{
	crossgameprotocal::HiddenGameNoticeLog *msg = (crossgameprotocal::HiddenGameNoticeLog *)data;
	WorldStatus::Instance().SendNoticeLog(msg->uid, msg->role_name, msg->plat_name, msg->activity_type, msg->param1, msg->reason_str);
}

void SceneManager::OnGameHiddenSendChatGroup(const char * data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}
	crossgameprotocal::GameHiddenSendChatGroup *msg = (crossgameprotocal::GameHiddenSendChatGroup *)data;

	CrossChatGroupManager::Instance().SendToGroup(msg->group_id,
		(char *)(data + sizeof(crossgameprotocal::GameHiddenSendChatGroup)),
		length - sizeof(crossgameprotocal::GameHiddenSendChatGroup));

	const ChatGroupInfo * info = CrossChatGroupManager::Instance().GetGroupInfo(msg->group_id);

	if (info != NULL && info->is_cross == 1)//
	{
		crossgameprotocal::HiddenGameSendChatGroup* chat_msg = (crossgameprotocal::HiddenGameSendChatGroup*)data;//
		chat_msg->header.msg_type = crossgameprotocal::MT_HIDDEN_GAME_CHAT_GROUP;
		InternalComm::Instance().SendToAllGameThroughCross((const char*)chat_msg, length);//
	}
}

void SceneManager::OnHiddenGameSendChatGroup(const char * data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}
	crossgameprotocal::HiddenGameSendChatGroup *msg = (crossgameprotocal::HiddenGameSendChatGroup *)data;
	if (msg->main_server_id != 0 && msg->main_server_id == LocalConfig::Instance().GetMergeServerId())return;//

	ChatManager::Instance().SendToGroup(msg->group_id,
		(char *)(data + sizeof(crossgameprotocal::HiddenGameSendChatGroup)),
		length - sizeof(crossgameprotocal::HiddenGameSendChatGroup));
}

void SceneManager::OnGameHiddenChatGroupOpreta(const char * data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}
	crossgameprotocal::GameCrossSyncChatOpreta *msg = (crossgameprotocal::GameCrossSyncChatOpreta *)data;

	switch (msg->opreta_type)
	{
	case crossgameprotocal::CHAT_OPRETA_TYPE_DISSMISS_GROUP:
	case crossgameprotocal::CHAT_OPRETA_TYPE_DISSMISS_GROUP_RET:
		{
			CrossChatGroupManager::Instance().OnRoleDismiss(msg->group_id, msg->uid, msg->group_master);//
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_TICKOUT_MEMBER://
		{
			CrossChatGroupManager::Instance().OnRoleBeKickOutGroup(msg->uid, msg->group_id);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_TICKOUT_MEMBER_RET:
		{
			if (msg->param1 == 0)//
			{
				CrossChatGroupManager::Instance().OnRoleBeKickOutGroupRet(msg->uid, msg->group_id);
			}
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_INVITE_MEMBER:
		{
			CrossChatGroupManager::Instance().OnRoleInviteGroupByLocal(msg);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_ENTER_GROUP:
		{
			CrossChatGroupManager::Instance().OnRoleEnterGroupInLocal(msg);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_ENTER_GROUP_RET:
		{
			CrossChatGroupManager::Instance().OnRoleEnterGroupReturn(msg);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_LOGIN_GROUP:
		{
			CrossChatGroupManager::Instance().OnUserLoginByGame(msg->group_id, msg->uid);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_LOGOUT_GROUP:
		{
			CrossChatGroupManager::Instance().OnUserLogoutByGame(msg->group_id, msg->uid);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_CHANGE_GROUP_NAME_OR_NOTICE://
		{
			CrossChatGroupManager::Instance().OnGroupNameOrNoticeChange(msg->group_id, msg->uid, msg->group_name, msg->group_notice);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_CHANGE_NAME://
		{
			CrossChatGroupManager::Instance().OnRoleChangeName(msg->group_id, msg->uid, msg->group_master);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_CHANGE_PROF://
		{
			CrossChatGroupManager::Instance().OnRoleChangeProf(msg->group_id, msg->uid, msg->param1, msg->param2);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_CHANGE_AVA:
		{
			CrossChatGroupManager::Instance().OnRoleChangeAva(msg->group_id, msg->uid, msg->param1);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_LEAVEN_GROUP:
		{
			int ret = 0;
			if (msg->param1 == 1)
			{
				ret = CrossChatGroupManager::Instance().OnRoleLeaveGroupInLocal(msg->group_id, msg->uid, msg->group_master);
			}
			else
			{
				ret = CrossChatGroupManager::Instance().OnRoleLeaveLocalGroup(msg->group_id, msg->uid, msg->group_master);
			}
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_LEAVEN_GROUP_RET:
		{
			CrossChatGroupManager::Instance().OnRoleLeaveLocalGroup(msg->group_id, msg->uid, msg->group_master);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_CREATE_GROUP://
		{
			long long create_group_id = -1;
			int create_ret = CrossChatGroupManager::Instance().OnRoleCreateCrossGroup(msg->uid, msg->param1, msg->param2, msg->param3, msg->group_name, msg->group_master, msg->param4,&create_group_id);
			
			{
				static crossgameprotocal::CrossGameSyncChatOpreta chat_msg;
				chat_msg.opreta_type = crossgameprotocal::CHAT_OPRETA_TYPE_CREATE_GROUP_RET;
				chat_msg.group_id = create_group_id;
				chat_msg.param1 = msg->param4;
				chat_msg.uid = msg->uid;
				chat_msg.param2 = create_ret;
				InternalComm::Instance().SendToGameThroughCross(LocalConfig::Instance().GetPlatType(), IntToUid(msg->uid).db_index, (const char*)&chat_msg, sizeof(chat_msg));
			}
		}
		break;

	default:
		break;
	}
}

void SceneManager::OnHiddenGameChatGroupOpreta(const char * data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}
	crossgameprotocal::CrossGameSyncChatOpreta *msg = (crossgameprotocal::CrossGameSyncChatOpreta *)data;

	switch (msg->opreta_type)
	{
	case crossgameprotocal::CHAT_OPRETA_TYPE_DISSMISS_GROUP:
		{
			ChatManager::Instance().OnGameSyncDismissGroup(msg->group_id, msg->uid);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_DISSMISS_GROUP_RET:
		{
			//ChatManager::Instance().OnGameSyncDismissGroup(msg->group_id, msg->uid);
			ChatManager::Instance().OnCrossGroupDismiss(msg->group_id, msg->uid);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_TICKOUT_MEMBER:
		{
			ChatManager::Instance().OnGameSyncKickMemberFromGroup(msg->group_id, msg->inviter_id, msg->uid);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_TICKOUT_MEMBER_RET:
		{
			if (msg->param1 == 0)//
			{
				ChatManager::Instance().OnGameSyncKickMemberFromGroupRet(msg->group_id, msg->inviter_id, msg->uid);
			}

		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_INVITE_MEMBER:
		{
			//
			Role* role = World::GetInstWorld()->GetSceneManager()->GetRole(msg->uid);
			if (NULL != role)
			{
				ChatGroupUniqueId tmp;
				tmp.unique_id = msg->group_id;
				Protocol::SCRoleInviteEnterGroup s_msg;
				s_msg.invite_server_id = tmp.server_id;
				F_STRNCPY(s_msg.invite_group_name, msg->group_name, sizeof(GameName));
				s_msg.invite_group_id = msg->group_id;
				s_msg.is_cross = msg->is_cross;
				s_msg.invite_uid = msg->inviter_id;
				F_STRNCPY(s_msg.inviter_name, msg->group_master, sizeof(GameName));
				EngineAdapter::Instance().NetSend(role->GetNetId(), (char *)&s_msg, sizeof(s_msg));
			}
			else
			{
				return;//
			}
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_ENTER_GROUP:
		{
			ChatManager::Instance().OnCrossEnterGroup(msg->group_id,msg->uid,msg->param1,msg->param2,msg->param3,msg->group_master,msg->inviter_id,msg->param4);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_ENTER_GROUP_RET:
		{
			ChatManager::Instance().OnRoleEnterGroupRet(msg);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_LOGIN_GROUP:
		{
			ChatManager::Instance().OnUserLoginByHide(msg->group_id, msg->uid);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_LOGOUT_GROUP:
		{
			ChatManager::Instance().OnUserLogoutByHide(msg->group_id, msg->uid);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_CHANGE_NAME://
		{
			//ChatManager::Instance().OnRoleChangeName(msg->group_id, msg->uid, msg->group_master);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_CHANGE_NAME_RET://
		{
			ChatManager::Instance().OnRoleChangeName(msg->group_id, msg->uid, msg->group_master);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_CHANGE_GROUP_NAME_OR_NOTICE://
		{
			ChatManager::Instance().OnGroupNameOrNoticeChange(msg->group_id, msg->uid, msg->group_name, msg->group_notice);
		}
		break;
	case crossgameprotocal::CHAT_OPERATE_TYPE_LEADER_CHANGE_SYNC_GAME:
		{
			ChatManager::Instance().OnGroupLeaderChangeSync(msg->group_id, msg->uid);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_CHANGE_PROF://
		{
			ChatManager::Instance().OnRoleChangeProf(msg->group_id, msg->uid, msg->param1,msg->param2);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_CHANGE_AVA:
		{
			ChatManager::Instance().OnRoleChangeAva(msg->group_id, msg->uid, msg->param1);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_LEAVEN_GROUP:
	case crossgameprotocal::CHAT_OPRETA_TYPE_LEAVEN_GROUP_RET:
		{
			ChatManager::Instance().OnRoleLeaveGroupInCross(msg->group_id, msg->uid, msg->group_master);
		}
		break;
	case crossgameprotocal::CHAT_OPRETA_TYPE_CREATE_GROUP_RET:
		{
			Role* role = World::GetInstWorld()->GetSceneManager()->GetRole(msg->uid);
			if (msg->param2 == 0)
			{
				ChatManager::Instance().OnRoleCreateCrossGroupRet(msg->group_id, msg->uid, msg->param1);
				if (NULL != role)
				{
					role->NoticeNum(noticenum::NT_CHAT_GROUP_CREATE_SUCC);
				}
			}
			else
			{
				if (NULL != role)
				{
					role->NoticeNum(errornum::EN_ROLE_CHAT_GROUP_CREATE_FAIL);
				}
			}
		}
		break;
	default:
		break;
	}
}

void SceneManager::OnGameHiddenTempGroupBecomeOfficialReq(const char *data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer()) return;

	crossgameprotocal::GameHiddenTempGroupBecomeOfficialReq* req = (crossgameprotocal::GameHiddenTempGroupBecomeOfficialReq*)data;
	
	ChatGroupUserInfo info_list[5]; 
	UNSTD_STATIC_CHECK(ARRAY_ITEM_COUNT(info_list) == ARRAY_ITEM_COUNT(req->member_list));

	for (int i = 0; i < req->member_num && i < ARRAY_ITEM_COUNT(req->member_list); ++i)
	{
		info_list[i].member_uid = req->member_list[i].uid;
		info_list[i].member_ava = req->member_list[i].avatar_type;
		info_list[i].member_level = req->member_list[i].level;
		info_list[i].member_prof = req->member_list[i].profession;
		F_STRNCPY(info_list[i].member_name, req->member_list[i].name, sizeof(GameName));
	}

	long long cross_group_id = 0LL;
	int ret = CrossChatGroupManager::Instance().OnTempGroupBecomeOfficial(ARRAY_ITEM_COUNT(info_list), req->member_num, info_list, req->group_name, &cross_group_id);

	crossgameprotocal::HiddenGameTempGroupBecomeOfficialResp resp;
	resp.result = ret;
	resp.group_id = cross_group_id;
	memset(resp.member_uid_list, 0, sizeof(resp.member_uid_list));
	for (int i = 0; i < req->member_num && i < ARRAY_ITEM_COUNT(req->member_list); ++i)
	{
		resp.member_uid_list[i] = req->member_list[i].uid;
	}
	F_STRNCPY(resp.creator_name, req->member_list[0].name, sizeof(GameName));
	F_STRNCPY(resp.group_name, req->group_name, sizeof(GameName));

	InternalComm::Instance().SendToGameThroughCross(req->plat_type, req->server_id, (const char*)&resp, sizeof(resp));
}

void SceneManager::OnHiddenGameTempGroupBecomeOfficialResp(const char* data, int length)
{
	if (CrossConfig::Instance().IsHiddenServer()) return;

	crossgameprotocal::HiddenGameTempGroupBecomeOfficialResp* resp = (crossgameprotocal::HiddenGameTempGroupBecomeOfficialResp*)data;

	Protocol::SCChatGroupMsgNotice msg;
	msg.group_id = resp->group_id;
	msg.msg_length = SNPRINTF(msg.msg_content, sizeof(msg.msg_content), gamestring::g_chat_group_msg_notice_become_official, resp->creator_name, resp->group_name);

	for (int i = 0; i < ARRAY_ITEM_COUNT(resp->member_uid_list); ++i)
	{
		if (0 == resp->member_uid_list[i]) continue;

		int role_id = resp->member_uid_list[i];
		UserCacheNode* node = UserCacheManager::Instance().GetUserNode(role_id);
		if (NULL == node) continue;

		Role* role = World::GetInstWorld()->GetSceneManager()->GetRole(IntToUid(role_id));
		if (NULL != role)
		{
			int empty_index = -1;
			if (role->GetRoleModuleManager()->FindEmptyCrossGroupIndex(&empty_index))
			{
				role->GetRoleModuleManager()->GetCommonData().cross_chat_group_list[empty_index] = resp->group_id;
				ChatManager::Instance().SendRoleOneGroupInfo(role, resp->group_id, Protocol::SCRoleOneGroupInfo::REASON_ADD);

				if (msg.msg_length > 0) // 
				{
					int send_length = sizeof(msg) - sizeof(msg.msg_content) + msg.msg_length;
					EngineAdapter::Instance().NetSend(role->GetNetId(), &msg, send_length);
				}
			}

			if (role->GetUID() == resp->member_uid_list[i])
			{
				role->NoticeNum(noticenum::NT_TEMP_GROUP_BECOME_OFFICIAL_SUCC);
			}

			Protocol::SCTempBecomeOfficialNotice notice;
			notice.group_id = resp->group_id;
			EngineAdapter::Instance().NetSend(role->GetNetId(), &notice, sizeof(notice));
		}
		else
		{
			OfflineRegisterManager::Instance().OnTempGroupBecomeOfficialSucc(role_id, resp->group_id);
		}
	}
}

void SceneManager::OnGameHiddenMazerAcerReq(const char * data, int length)
{
	crossgameprotocal::GameHiddenMazerAcerReq * req = (crossgameprotocal::GameHiddenMazerAcerReq *)data;

	switch (req->req_type)
	{
		case crossgameprotocal::GAME_HIDDEN_MAZE_RACER_REQ_TYPE_RANK:
			{
				if (req->origin_role_id != 0)
				{
					MazeRacerManager::Instance().SendAllRankInfoHiddenToGame(req->origin_role_id);
				}				
			}
			break;
	}

}

void SceneManager::OnGameHiddenCommonInfoNoticeHidden(const char * data, int length)
{
	if (!CrossConfig::Instance().IsHiddenServer())
	{
		return;
	}

	crossgameprotocal::GameHiddenCommonInfoNoticeHidden * req = (crossgameprotocal::GameHiddenCommonInfoNoticeHidden *)data;
	switch (req->type)
	{
		case crossgameprotocal::GAME_HIDDEN_COMMON_INFO_NOTICE_TYPE_ROLE_LOGIN:
			{	
				EventHandler::Instance().OnRecvNoticeForUserLoginOrigin(req->param1);

				//
				if (req->is_all_sync)
				{
					crossgameprotocal::CrossGameDataSyncCheckAck ack;
					ack.type = crossgameprotocal::DATA_SYNC_CHECK_TYPE_USER_CACHE;
					InternalComm::Instance().SendToGameThroughCross(LocalConfig::Instance().GetPlatType(), req->server_id, (const char*)&ack, sizeof(ack));
				}
			}
			break;
		case crossgameprotocal::GAME_HIDDEN_COMMON_INFO_NOTICE_TYPE_ROLE_LOGOUT:
			{
				JieYiZuManager::Instance().OnUserLogoutOriginGame(req->param1);
				QingYuanManager::Instance().OnUserLogoutOriginGame(req->param1);
			}
			break;
	}
}

void SceneManager::OnHiddenGameFirstKillInfoReq(const char * data, int length)
{
	crossgameprotocal::HiddenGameFirstKillInfoReq *msg = (crossgameprotocal::HiddenGameFirstKillInfoReq *)data;
	ServerFirstKill::Instance().SendFirstKillInfoToHidden(msg->uuid, msg->type, msg->level_group);
}

void SceneManager::OnGameHiddenFirstKillInfoReq(const char * data, int length)
{
	crossgameprotocal::GameHiddenFirstKillInfoReq *msg = (crossgameprotocal::GameHiddenFirstKillInfoReq *)data;
	ServerFirstKill::Instance().SendFirstKillInfoToGame(msg->uid, msg->type, msg->level_group);
}

void SceneManager::OnGameHiddenTradeMarketHistoryTopPriceReq(const char* data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketHistoryTopPriceReq* req = (crossgameprotocal::GameHiddenTradeMarketHistoryTopPriceReq*)data;

	Protocol::SCRATradeMarketReturnHotItemInfo resp;
	memset(resp.hot_item_list, 0, sizeof(resp.hot_item_list));
	int num = 0;
	TradeMarketManager::Instance().GetHistoryTopPriceItemList(ARRAY_LENGTH(resp.hot_item_list), &num, resp.hot_item_list);

	InternalComm::Instance().SendSerializeMsgToGameUserThroughCross(req->role_id, &resp);
}

void SceneManager::OnGameHiddenDeleteMutePlayerChatRecord(const char* data, int length)
{
	crossgameprotocal::GameHiddenDeleteMutePlayerChatRecord* req = (crossgameprotocal::GameHiddenDeleteMutePlayerChatRecord*)data;

	Protocol::SCMutePlayerDeleteChatRecord msg;
	msg.role_id = req->uid;
	World::GetInstWorld()->SendToAllGateway((const char*)&msg, sizeof(msg));

	unsigned int now = static_cast<unsigned int>(EngineAdapter::Instance().Time());
	MutePlayerRecorder::Instance().AddMutePlayer(req->uid, now + req->forbid_seconds);
}

void SceneManager::OnGameHiddenTradeMarketSaleItemEvenhandler(const char * data, int length)
{
	crossgameprotocal::GameHiddenTradeMarketSaleItemEventHandler *msg = (crossgameprotocal::GameHiddenTradeMarketSaleItemEventHandler *)data;

	Role * role = World::GetInstWorld()->GetSceneManager()->GetRole(msg->uid);
	if (NULL != role)
	{
		EventHandler::Instance().OnTradeMarketSaleItem(msg->uid, msg->sel_item_id, false);
	}
	else
	{
		crossgameprotocal::HiddenGameTradeMarketSaleItemEventHandler hgtmsieh;
		hgtmsieh.uid = msg->uid;
		hgtmsieh.sel_item_id = msg->sel_item_id;
		hgtmsieh.reserve_sh = 0;

		InternalComm::Instance().SendToGameThroughCross(LocalConfig::Instance().GetPlatType(), IntToUid(hgtmsieh.uid).db_index, (const char *)&hgtmsieh, sizeof(hgtmsieh));
	}
}

void SceneManager::OnHiddenGameTradeMarketSaleItemEvenhandler(const char * data, int length)
{
	crossgameprotocal::HiddenGameTradeMarketSaleItemEventHandler * msg = (crossgameprotocal::HiddenGameTradeMarketSaleItemEventHandler *)data;

	Role * role = World::GetInstWorld()->GetSceneManager()->GetRole(msg->uid);
	if (NULL == role)
	{
		OfflineRegisterManager::Instance().OnTrademarketFinish(msg->uid, 1, msg->sel_item_id);
	}
	else
	{
		EventHandler::Instance().OnTradeMarketSaleItem(msg->uid, msg->sel_item_id, false);
	}
}

void SceneManager::OnGameHiddenAddCredit(const char * data, int length)
{
	crossgameprotocal::GameHiddenAddCredit *info = (crossgameprotocal::GameHiddenAddCredit *)data;
	Role *role = this->GetRole(info->role_id);
	bool succ = false;
	if (NULL != role)
	{
		succ = role->GetRoleModuleManager()->GetTradeCredit()->AddCredit(info->credit_num, __FUNCTION__);
	}

	gamelog::g_log_cmd.printf(LL_INFO, "SceneManager::OnGameHiddenAddCredit from role_id:%d add_credit:%d", info->role_id, info->credit_num);
}